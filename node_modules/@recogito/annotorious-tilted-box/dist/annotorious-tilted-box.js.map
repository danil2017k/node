{"version":3,"file":"annotorious-tilted-box.js","mappings":"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","sources":["webpack://Annotorious.TiltedBox/webpack/universalModuleDefinition","webpack://Annotorious.TiltedBox/./node_modules/css-loader/dist/runtime/api.js","webpack://Annotorious.TiltedBox/./node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://Annotorious.TiltedBox/./node_modules/fast-deep-equal/index.js","webpack://Annotorious.TiltedBox/./node_modules/tiny-emitter/index.js","webpack://Annotorious.TiltedBox/./src/TiltedBoxTool.scss","webpack://Annotorious.TiltedBox/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://Annotorious.TiltedBox/webpack/bootstrap","webpack://Annotorious.TiltedBox/webpack/runtime/compat get default export","webpack://Annotorious.TiltedBox/webpack/runtime/define property getters","webpack://Annotorious.TiltedBox/webpack/runtime/hasOwnProperty shorthand","webpack://Annotorious.TiltedBox/./node_modules/uuid/dist/esm-browser/rng.js","webpack://Annotorious.TiltedBox/./node_modules/@recogito/annotorious/src/util/SVG.js","webpack://Annotorious.TiltedBox/./node_modules/uuid/dist/esm-browser/regex.js","webpack://Annotorious.TiltedBox/./node_modules/uuid/dist/esm-browser/validate.js","webpack://Annotorious.TiltedBox/./node_modules/uuid/dist/esm-browser/stringify.js","webpack://Annotorious.TiltedBox/./node_modules/uuid/dist/esm-browser/v4.js","webpack://Annotorious.TiltedBox/./node_modules/@recogito/recogito-client-core/src/WebAnnotation.js","webpack://Annotorious.TiltedBox/./node_modules/@recogito/recogito-client-core/src/Selection.js","webpack://Annotorious.TiltedBox/./node_modules/@recogito/annotorious/src/tools/Tool.js","webpack://Annotorious.TiltedBox/./node_modules/@recogito/annotorious/src/util/Touch.js","webpack://Annotorious.TiltedBox/./node_modules/@recogito/annotorious/src/tools/EditableShape.js","webpack://Annotorious.TiltedBox/./node_modules/@recogito/annotorious/src/selectors/EmbeddedSVG.js","webpack://Annotorious.TiltedBox/./src/Geom2D.js","webpack://Annotorious.TiltedBox/./src/TiltedBox.js","webpack://Annotorious.TiltedBox/./src/EditableTiltedBox.js","webpack://Annotorious.TiltedBox/./src/RubberbandTiltedBox.js","webpack://Annotorious.TiltedBox/./src/TiltedBoxTool.scss?7cce","webpack://Annotorious.TiltedBox/./src/TiltedBoxTool.js","webpack://Annotorious.TiltedBox/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Annotorious\"] = factory();\n\telse\n\t\troot[\"Annotorious\"] = root[\"Annotorious\"] || {}, root[\"Annotorious\"][\"TiltedBox\"] = factory();\n})(self, function() {\nreturn ","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]); if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","function E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\nmodule.exports.TinyEmitter = E;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"g.a9s-annotation.tilted-box .a9s-tilted-box-baseline *,g.a9s-selection.tilted-box .a9s-tilted-box-baseline *{vector-effect:non-scaling-stroke}g.a9s-annotation.tilted-box .a9s-tilted-box-baseline .a9s-inner,g.a9s-selection.tilted-box .a9s-tilted-box-baseline .a9s-inner{stroke-width:3px;stroke:#fff}g.a9s-annotation.tilted-box .a9s-tilted-box-baseline .a9s-outer,g.a9s-selection.tilted-box .a9s-tilted-box-baseline .a9s-outer{stroke-width:5px}g.a9s-annotation.tilted-box .a9s-minor-handle,g.a9s-selection.tilted-box .a9s-minor-handle{stroke:#fff000;fill:#000}g.a9s-annotation.tilted-box .a9s-minor-handle:hover,g.a9s-selection.tilted-box .a9s-minor-handle:hover{stroke:#000;fill:#fff000}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/TiltedBoxTool.scss\"],\"names\":[],\"mappings\":\"AAKI,6GACE,gCAAA,CAGF,+HACE,gBAAA,CACA,WAAA,CAGF,+HACE,gBAAA,CAKJ,2FACE,cAAA,CACA,SAAA,CAGF,uGACE,WAAA,CACA,YAAA\",\"sourcesContent\":[\"g.a9s-annotation.tilted-box,\\ng.a9s-selection.tilted-box  {\\n\\n  .a9s-tilted-box-baseline {\\n\\n    * {\\n      vector-effect:non-scaling-stroke;\\n    }\\n\\n    .a9s-inner {\\n      stroke-width:3px;\\n      stroke:#fff;\\n    }\\n\\n    .a9s-outer {\\n      stroke-width:5px;\\n    }\\n\\n  }\\n\\n  .a9s-minor-handle {\\n    stroke:#fff000;\\n    fill:#000;\\n  }\\n\\n  .a9s-minor-handle:hover {\\n    stroke:#000;\\n    fill:#fff000;\\n  }\\n\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n\nconst getClassNames = el => {\n  const attr = el.getAttribute('class');\n  return attr ? new Set(attr.split(' ')) : new Set();\n}\n\n// IE11 doesn't support adding/removing classes to SVG elements except \n// via .setAttribute\nexport const addClass = (el, className) => {\n  const classNames = getClassNames(el);\n  classNames.add(className);\n  el.setAttribute('class', Array.from(classNames).join(' '));\n}\n\nexport const removeClass = (el, className) => {\n  const classNames = getClassNames(el);\n  classNames.delete(className);\n\n  if (classNames.size === 0)\n    el.removeAttribute('class');\n  else\n    el.setAttribute('class', Array.from(classNames).join(' '));\n}\n\nexport const hasClass = (el, className) =>\n  getClassNames(el).has(className);","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","import { v4 as uuid } from 'uuid';\nimport equals from 'fast-deep-equal';\n\nexport default class WebAnnotation {\n\n  constructor(annotation, opts) {\n    this.underlying = annotation;\n    this.opts = opts;\n  }\n\n  /** For convenience - creates an empty web annotation **/\n  static create = args => {\n    const stub = {\n      '@context': 'http://www.w3.org/ns/anno.jsonld',\n      'type': 'Annotation',\n      'id': `#${uuid()}`,\n      'body': []\n    };\n\n    return new WebAnnotation({ ...stub, ...args });\n  }\n\n  /** Creates a copy of this annotation **/\n  clone = (opt_props, opt_opts) => {\n    return new WebAnnotation({ ...this.underlying, ...opt_props}, { ...this.opts, ...opt_opts });\n  }\n\n  /** An equality check based on the underlying object **/\n  isEqual(other) {\n    if (other?.type !== 'Annotation') {\n      return false;\n    } else if (this.underlying === other.underlying) {\n      return true;\n    } else if (!this.underlying.id || !other.underlying.id) {\n      return false;\n    } else {\n      return equals(this.underlying, other.underlying);\n    }\n  }\n\n  get readOnly() {\n    return this.opts?.readOnly;\n  }\n\n  /*************************************/ \n  /* Getters to forward properties of  */\n  /* the underlying annotation         */\n  /*************************************/\n\n  get id() {\n    return this.underlying.id; \n  }\n\n  get type() {\n    return this.underlying.type;\n  }\n\n  get motivation() {\n    return this.underlying.motivation;\n  }\n\n  get body() {\n    return this.underlying.body;\n  }\n\n  get target() {\n    return this.underlying.target;\n  }\n\n  /** Same as .body, but guaranteed to return an array **/\n  get bodies() {\n    return (Array.isArray(this.underlying.body)) ?\n      this.underlying.body : [ this.underlying.body ];\n  }\n\n  /** Only bodies are meant to be mutated by the application **/\n  set bodies(bodies) {\n    this.underlying.body = bodies;\n  }\n\n  /** Same as .target, but guaranteed to return an array **/\n  get targets() {\n    return (Array.isArray(this.underlying.target)) ?\n      this.underlying.target : [ this.underlying.target ];\n  }\n  \n  /*****************************************/ \n  /* Various access helpers and shorthands */\n  /*****************************************/\n\n  /** Selector of the given type **/\n  selector = type => {\n    const { target } = this.underlying;\n\n    if (target.selector) {\n      // Normalize to array\n      const selectors = Array.isArray(target.selector) ?\n        target.selector : [ target.selector ];\n\n      return selectors.find(s => s.type === type);\n    }\n  }\n\n  /** Shorthand for the 'exact' field of the TextQuoteSelector **/\n  get quote() {\n    return this.selector('TextQuoteSelector').exact;\n  }\n\n  /** Shorthand for the 'start' field of the TextPositionSelector **/\n  get start() {\n    return this.selector('TextPositionSelector').start;\n  }\n\n  /** Shorthand for the 'end' field of the TextPositionSelector **/\n  get end() {\n    return this.selector('TextPositionSelector').end;\n  }\n  \n}\n","import WebAnnotation from './WebAnnotation';\nimport { v4 as uuid } from 'uuid';\nimport equals from 'fast-deep-equal';\n\n/**\n * An \"annotation in draft mode\". Really the same\n * data structure, but as a separate class so we can\n * tell things apart properly.\n */\nexport default class Selection {\n\n  constructor(target, body) {\n    this.underlying = {\n      type: 'Selection',\n      body: body || [],\n      target\n    }\n  }\n\n  /** Creates a copy of this selection **/\n  clone = opt_props => {\n    // Deep-clone\n    const cloned = new Selection();\n    cloned.underlying = JSON.parse(JSON.stringify(this.underlying));  \n\n    if (opt_props)\n      cloned.underlying = { ...cloned.underlying, ...opt_props };\n\n    return cloned;\n  }\n\n  get type() {\n    return this.underlying.type;\n  }\n\n  get body() {\n    return this.underlying.body;\n  }\n\n  get target() {\n    return this.underlying.target;\n  }\n\n  get targets() {\n    return (Array.isArray(this.underlying.target)) ?\n      this.underlying.target : [ this.underlying.target ];\n  }\n\n  /** For consistency with WebAnnotation **/\n  isEqual(other) {\n    if (!other) {\n      return false;\n    } else {\n      return equals(this.underlying, other.underlying);\n    }\n  }\n  \n  get bodies() {\n    return (Array.isArray(this.underlying.body)) ?\n      this.underlying.body : [ this.underlying.body ];\n  }\n\n  selector = type => {\n    const { target } = this.underlying;\n\n    if (target.selector) {\n      // Normalize to array\n      const selectors = Array.isArray(target.selector) ?\n        target.selector : [ target.selector ];\n\n      return selectors.find(s => s.type === type);\n    }\n  }\n\n  /** Shorthand for the 'exact' field of the TextQuoteSelector **/\n  get quote() {\n    return this.selector('TextQuoteSelector').exact;\n  }\n\n  /*******************************************/ \n  /* Selection-specific properties & methods */\n  /*******************************************/\n\n  get isSelection() {\n    return true;\n  }\n\n  toAnnotation = () => {\n    const a = Object.assign({}, this.underlying, {\n      '@context': 'http://www.w3.org/ns/anno.jsonld',\n      'type': 'Annotation',\n      'id': `#${uuid()}`\n    });\n\n    return new WebAnnotation(a);\n  }\n\n}","import EventEmitter from 'tiny-emitter';\nimport { isTouchDevice } from '../util/Touch';\nimport { SVG_NAMESPACE } from '../util/SVG';\n\nconst IMPLEMENTATION_MISSING = \"An implementation is missing\";\n\nconst isTouch = isTouchDevice();\n\n/**\n * A commmon base class for Tools and EditableShapes\n */\nexport class ToolLike extends EventEmitter {\n\n  constructor(g, config, env) {\n    super();\n\n    this.svg = g.closest('svg');\n\n    this.g = g;\n    this.config = config;\n    this.env = env;\n\n    // Default image scale\n    this.scale = 1;\n\n    // Bit of a hack. If we are dealing with a 'real' image, we enable\n    // reponsive mode. OpenSeadragon handles scaling in a different way,\n    // so we don't need responsive mode.\n    const { image } = env;\n    if (image instanceof Element || image instanceof HTMLDocument)\n      this.enableResponsive();\n  }\n\n  /**\n   * Implementations MAY extend this (calling super),\n   * to destroy SVG elements, mask, etc.\n   */\n  destroy() {\n    if (this.resizeObserver)\n      this.resizeObserver.disconnect();\n\n    this.resizeObserver = null;\n  }\n\n  enableResponsive = () => {\n    if (window.ResizeObserver) {\n      this.resizeObserver = new ResizeObserver(() => {\n        const svgBounds = this.svg.getBoundingClientRect();\n        const { width, height } = this.svg.viewBox.baseVal;\n\n        this.scale = Math.max(\n          width / svgBounds.width,\n          height / svgBounds.height\n        );\n\n        if (this.onScaleChanged)\n          this.onScaleChanged(this.scale);\n      });\n\n      this.resizeObserver.observe(this.svg.parentNode);\n    }\n  }\n\n  getSVGPoint = evt => {\n    const pt = this.svg.createSVGPoint();\n\n    if (isTouch) {\n      const bbox = this.svg.getBoundingClientRect();\n\n      const x = evt.clientX - bbox.x;\n      const y = evt.clientY - bbox.y;\n\n      const { left, top } = this.svg.getBoundingClientRect();\n      pt.x = x + left;\n      pt.y = y + top;\n\n      return pt.matrixTransform(this.g.getScreenCTM().inverse());\n    } else {\n      pt.x = evt.offsetX;\n      pt.y = evt.offsetY;\n\n      return pt.matrixTransform(this.g.getCTM().inverse());\n    }\n  }\n\n  /*********************************/\n  /*  Helpers for drawing handles  */\n  /*********************************/\n\n  drawHandle = (x, y) => {\n    const containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    containerGroup.setAttribute('class', 'a9s-handle');\n\n    const group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    const drawCircle = r => {\n      const c = document.createElementNS(SVG_NAMESPACE, 'circle');\n      c.setAttribute('cx', x);\n      c.setAttribute('cy', y);\n      c.setAttribute('r', r);\n      return c;\n    }\n\n    const radius = this.config.handleRadius || 6;\n\n    const inner = drawCircle(radius);\n    inner.setAttribute('class', 'a9s-handle-inner')\n\n    const outer = drawCircle(radius + 1);\n    outer.setAttribute('class', 'a9s-handle-outer')\n\n    group.appendChild(outer);\n    group.appendChild(inner);\n\n    containerGroup.appendChild(group);\n    return containerGroup;\n  }\n\n  setHandleXY = (handle, x, y) => {\n    const inner = handle.querySelector('.a9s-handle-inner');\n    inner.setAttribute('cx', x);\n    inner.setAttribute('cy', y);\n\n    const outer = handle.querySelector('.a9s-handle-outer');\n    outer.setAttribute('cx', x);\n    outer.setAttribute('cy', y);\n  }\n\n  getHandleXY = handle => {\n    const outer = handle.querySelector('.a9s-handle-outer');\n    return {\n      x: parseFloat(outer.getAttribute('cx')),\n      y: parseFloat(outer.getAttribute('cy'))\n    }\n  }\n\n  scaleHandle = handle => {\n    const inner = handle.querySelector('.a9s-handle-inner');\n    const outer = handle.querySelector('.a9s-handle-outer');\n\n    const radius = this.scale * (this.config.handleRadius || 6);\n\n    inner.setAttribute('r', radius);\n    outer.setAttribute('r', radius);\n  }\n\n}\n\n/**\n * Base class that adds some convenience stuff for tool plugins.\n */\nexport default class Tool extends ToolLike {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    // We'll keep a flag set to false until\n    // the user has started moving, so we can\n    // fire the startSelection event\n    this.started = false;\n  }\n\n  attachListeners = ({ mouseMove, mouseUp, dblClick }) => {\n    // Handle SVG conversion on behalf of tool implementations\n    if (mouseMove) {\n      this.mouseMove = evt => {\n        const { x , y } = this.getSVGPoint(evt);\n\n        if (!this.started) {\n          this.emit('startSelection', { x, y });\n          this.started = true;\n        }\n\n        mouseMove(x, y, evt);\n      }\n\n      // Mouse move goes on SVG element\n      this.svg.addEventListener('mousemove', this.mouseMove);\n    }\n\n    if (mouseUp) {\n      this.mouseUp = evt => {\n        if (evt.button !== 0) return;  // left click\n        const { x , y } = this.getSVGPoint(evt);\n        mouseUp(x, y, evt);\n      }\n\n      // Mouse up goes on doc, so we capture events outside, too\n      document.addEventListener('mouseup', this.mouseUp);\n    }\n\n    if (dblClick) {\n      this.dblClick = evt => {\n        const { x , y } = this.getSVGPoint(evt);\n        dblClick(x, y, evt);\n      }\n\n      document.addEventListener('dblclick', this.dblClick);\n    }\n\n  }\n\n  detachListeners = () => {\n    if (this.mouseMove)\n      this.svg.removeEventListener('mousemove', this.mouseMove);\n\n    if (this.mouseUp)\n      document.removeEventListener('mouseup', this.mouseUp);\n\n    if (this.dblClick)\n      document.removeEventListener('dblclick', this.dblClick);\n  }\n\n  /**\n   * If startOnSingleClick is true, the tool starts on single click\n   * as well as drag. If false, starting strictly requires drag!\n   */\n  start = (evt, startOnSingleClick) => {\n    // Handle SVG conversion on behalf of tool implementations\n    const { x , y } = this.getSVGPoint(evt);\n    this.startDrawing(x, y, startOnSingleClick, evt);\n  }\n\n  /**\n   * Tool implementations MUST override these\n   */\n\n  get isDrawing() {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  startDrawing = evt => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  createEditableShape = annotation => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n}\n\n// In addition, Tool implementations need to implement the following static methods\n\n// Tool.identifier = '...'\n\nTool.supports = annotation => {\n  throw new Error(IMPLEMENTATION_MISSING);\n}\n\n// Just some convenience shortcuts to client-core, for quicker\n// importing in plugins. (In a way, the intention is to make the\n// Tool class serve as a kind of mini-SDK).\nexport { default as Selection } from '@recogito/recogito-client-core/src/Selection';\nexport { default as WebAnnotation } from '@recogito/recogito-client-core/src/WebAnnotation';\n","const SIM_EVENTS = {\n  touchstart: 'mousedown',\n  touchmove: 'mousemove',\n  touchend: 'mouseup'\n}\n\nexport const isTouchDevice = () =>\n  'ontouchstart' in window ||\n    navigator.maxTouchPoints > 0 ||\n      navigator.msMaxTouchPoints > 0;\n\nexport const enableTouchTranslation = el => {\n\n  let pressAndHoldTrigger = null;\n\n  const simulateEvent = (type, e) => new MouseEvent(type, {\n    screenX: e.screenX,\n    screenY: e.screenY,\n    clientX: e.clientX,\n    clientY: e.clientY,\n    pageX: e.pageX,\n    pageY: e.pageY,\n    bubbles: true\n  });\n\n  const touchHandler = evt => {\n    const touch = evt.changedTouches[0];\n    const simulatedEvent = simulateEvent(SIM_EVENTS[evt.type], touch);\n\n    touch.target.dispatchEvent(simulatedEvent);\n    evt.preventDefault();\n\n    if (evt.type === 'touchstart' || evt.type === 'touchmove') {\n      pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\n\n      pressAndHoldTrigger = setTimeout(() => {\n        const simulatedEvent = simulateEvent('dblclick', touch);\n        touch.target.dispatchEvent(simulatedEvent);\n      }, 800);\n    }\n\n    if (evt.type === 'touchend')\n      pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\n  }\n\n  el.addEventListener('touchstart', touchHandler, true);\n  el.addEventListener('touchmove', touchHandler, true);\n  el.addEventListener('touchend', touchHandler, true);\n  el.addEventListener('touchcancel', touchHandler, true);\n\n}","import { ToolLike } from './Tool';\n\nconst IMPLEMENTATION_MISSING = \"An implementation is missing\";\n\nexport default class EditableShape extends ToolLike {\n\n  constructor(annotation, g, config, env) {\n    super(g, config, env);\n\n    this.annotation = annotation;\n  }\n  \n  /**\n   * Implementations MUST override this method!\n   * \n   * Must return the 'g' element with the a9s-annotation class.\n   */\n  get element() {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  /**\n   * Implementations MUST override this method!\n   * \n   * The annotation argument MUST be used to update\n   * the current state of the shape. It MUST NOT\n   * be stored as 'this.annotation'! 'this.annotation'\n   * MUST remain the original annotation at the time\n   * this EditableShape was created, because we will\n   * need it again in case the user cancels editing.\n   * \n   * Thinking of it in React terms, 'this.annotation'\n   * has the same purpose as props.annotation, whereas\n   * this method affects state.\n   */\n  updateState = annotation => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n}\n","import { SVG_NAMESPACE } from '../util/SVG';\n\n/** Helper that forces an un-namespaced node to SVG **/\nconst insertSVGNamespace = originalDoc => {\n  // Serialize and parse for the namespace to take effect on every node\n  const serializer = new XMLSerializer();\n  const str = serializer.serializeToString(originalDoc.documentElement);\n\n  // Doesn't seem that there's a clean cross-browser way for this...\n  const namespaced = str.replace('<svg>', `<svg xmlns=\"${SVG_NAMESPACE}\">`);\n\n  const parser = new DOMParser();\n  const namespacedDoc = parser.parseFromString(namespaced, \"image/svg+xml\");\n  return namespacedDoc.documentElement;\n}\n\nconst sanitize = doc => {\n  // Cf. https://github.com/mattkrick/sanitize-svg#readme  \n  // for the basic approach\n  const cleanEl = el => {\n    Array.from(el.attributes).forEach(attr => {\n      if (attr.name.startsWith('on'))\n        el.removeAttribute(attr.name)\n    });\n  }\n\n  // Remove script tags\n  const scripts = doc.getElementsByTagName('script');\n  Array.from(scripts).reverse().forEach(el =>\n    el.parentNode.removeChild(el));\n\n  // Remove on... attributes\n  cleanEl(doc);\n  Array.from(doc.querySelectorAll('*')).forEach(cleanEl);\n\n  return doc;\n}\n\nexport const svgFragmentToShape = annotation => {\n  const selector = annotation.selector('SvgSelector');\n  if (selector) {\n    const parser = new DOMParser();\n\n    // Parse the XML document, assuming SVG\n    const { value } = selector;\n    const doc = parser.parseFromString(value, \"image/svg+xml\");\n\n    // SVG needs a namespace declaration - check if it's set or insert if not\n    const isPrefixDeclared = doc.lookupPrefix(SVG_NAMESPACE); // SVG declared via prefix\n    const isDefaultNamespaceSVG = doc.lookupNamespaceURI(null); // SVG declared as default namespace\n\n    if (isPrefixDeclared || isDefaultNamespaceSVG) {\n      return sanitize(doc).firstChild;\n    } else {\n      return sanitize(insertSVGNamespace(doc)).firstChild;\n    }\n  }\n}\n\nexport const drawEmbeddedSVG = annotation => {\n  const shape = svgFragmentToShape(annotation);\n\n  // Because we're nitpicky, we don't just draw the shape,\n  // but duplicate it, so we can have inner and an outer lines\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n  const inner = shape.cloneNode(true);\n  inner.setAttribute('class', 'a9s-inner');\n\n  const outer = shape.cloneNode(true);\n  outer.setAttribute('class', 'a9s-outer');\n\n  g.appendChild(outer);\n  g.appendChild(inner);\n\n  return g;\n}\n\nexport const toSVGTarget = (shape, image) => {\n  const inner = shape.querySelector('.a9s-inner').cloneNode(true);\n  inner.removeAttribute('class');\n  inner.removeAttribute('xmlns');\n\n  let serialized = inner.outerHTML || new XMLSerializer().serializeToString(inner);\n  serialized = serialized.replace(` xmlns=\"${SVG_NAMESPACE}\"`, '');\n\n  return {\n    source: image?.src,\n    selector: {\n      type: \"SvgSelector\",\n      value: `<svg>${serialized}</svg>`\n    }\n  }\n}\n\nexport const svgArea = annotation => {\n  const shape = svgFragmentToShape(annotation);\n  const nodeName = shape.nodeName.toLowerCase();\n\n  if (nodeName === 'polygon') \n    return polygonArea(shape);\n  else if (nodeName === 'circle')\n    return circleArea(shape);\n  else if (nodeName === 'ellipse')\n    return ellipseArea(shape);\n  else if (nodeName == 'path')\n    return pathArea(shape);\n  else\n    throw `Unsupported SVG shape type: ${nodeName}`;\n}\n\nconst polygonArea = polygon => {\n  const points = polygon.getAttribute('points')\n    .split(' ') // Split x/y tuples\n    .map(xy => xy.split(',').map(str => parseFloat(str.trim())));\n\n  let area = 0;\n  let j = points.length - 1;\n\n  for (let i=0; i < points.length; i++) {\n    area += (points[j][0] + points[i][0]) * (points[j][1] - points[i][1]);\n    j = i;\n  }\n\n  return Math.abs(0.5 * area);\n}\n\nconst circleArea = circle => {\n  const r = circle.getAttribute('r');\n  return r * r * Math.PI;\n}\n\nconst ellipseArea = ellipse => {\n  const rx = ellipse.getAttribute('rx');\n  const ry = ellipse.getAttribute('ry');\n  return rx * ry * Math.PI;\n}\n\nconst pathArea = path => {\n  const pointList = path.getAttribute('d').split('L');\n  let area = 0;\n\n  if(pointList.length > 1) {\n    var point = pointList[pointList.length - 1].trim().split(' ');\n    let lastX = parseFloat(point[0]);\n    let lastY = parseFloat(point[1]);\n\n    point = pointList[0].substring(1).trim().split(' ');\n    let x = parseFloat(point[0]);\n    let y = parseFloat(point[1]);\n    area += (lastX + x) * (lastY - y);\n    lastX = x;\n    lastY = y;\n\n    for (let i = 1; i < pointList.length; i++) {\n      point = pointList[i].trim().split(' ');\n      x = parseFloat(point[0]);\n      y = parseFloat(point[1]);\n      area += (lastX + x) * (lastY - y);\n      lastX = x;\n      lastY = y;\n    }\n  }\n\n  return Math.abs(0.5 * area);\n}","/** Computes the length of a vector **/\nexport const len = (xy1, xy2) => \n  xy2 ? \n    // Treat input as two vectors and compute length of result vector\n    Math.sqrt(Math.pow(xy2[0] - xy1[0], 2) + Math.pow(xy2[1] - xy1[1], 2)) :\n\n    // Treat input as a vector\n    Math.sqrt(Math.pow(xy1[0], 2) + Math.pow(xy1[1], 2));\n\n/** Returns the vector between two points **/\nexport const vec = (terminal, starting) => \n  [ terminal[0] - starting[0], terminal[1] - starting [1] ];\n\n/** Rounds the vector coordinates to the given decimal placs **/\nexport const round = (vec, decimalPlaces) => {\n  const factor = Math.pow(10, decimalPlaces || 0);\n  return [\n    Math.round(vec[0] * factor) / factor,\n    Math.round(vec[1] * factor) / factor\n  ];\n}\n/** Returns true if the vectors are equal **/\nexport const eq = (xy1, xy2) => \n  xy1[0] === xy2[0] && xy1[1] === xy2[1];\n\n/** Normalizes a vector to length = 1 **/\nexport const normalize = xy => {\n  var l = Math.max(len(xy), 0.00001); // Prevent div by zero\n  return [ xy[0] / l, xy[1] / l ];\n}\n\n/** Computes the angle between two vectors **/\nexport const angleBetween = (a, b) => {\n  const dotProduct = a[0] * b[0] + a[1] * b[1];\n  return Math.acos(dotProduct);\n}\n\nexport const angleOf = xy =>\n  Math.atan2(xy[1], xy[0]);\n\n/** Adds two vectors */\nexport const add = (a, b) =>\n  [ a[0] + b[0], a[1] + b[1]  ];\n\nexport const mult = (vec, factor) =>\n  [ factor * vec[0], factor * vec[1] ];\n","import { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\n\n/** Common to all SVG shapes: draw group with inner + outer **/\nconst createElement = elem => {\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n  const outer = document.createElementNS(SVG_NAMESPACE, elem);\n  outer.setAttribute('class', 'a9s-outer');\n\n  const inner =  document.createElementNS(SVG_NAMESPACE, elem);\n  inner.setAttribute('class', 'a9s-inner');\n\n  g.appendChild(outer);\n  g.appendChild(inner);\n\n  return g;\n}\n\nexport const createBaseline = (optA, optB) => {\n  const g = createElement('line');\n  g.setAttribute('class', 'a9s-tilted-box-baseline');\n\n  if (optA && optB) \n    setBaseline(g, optA, optB);\n\n  return g;\n}\n\nexport const createBox = optPoints => {\n  const g = createElement('polygon');\n  \n  if (optPoints)\n    setBoxPoints(g, optPoints);\n\n  return g;\n}\n\nexport const setBaseline = (g, from, to) => {\n\n  const setCoords = line => {\n    line.setAttribute('x1', from[0]);\n    line.setAttribute('y1', from[1]);\n    line.setAttribute('x2', to[0]);\n    line.setAttribute('y2', to[1]);  \n  }\n\n  const inner = g.querySelector('.a9s-inner');\n  setCoords(inner);\n\n  const outer = g.querySelector('.a9s-outer');\n  setCoords(outer);\n}\n\nexport const setBoxPoints = (g, points) => {\n  const attr = points.map(xy => xy.join(',')).join(' ');\n\n  const inner = g.querySelector('.a9s-inner');\n  inner.setAttribute('points', attr);\n\n  const outer = g.querySelector('.a9s-outer');\n  outer.setAttribute('points', attr);\n}\n\nexport const getBoxPoints = g =>\n  g.querySelector('.a9s-inner').getAttribute('points')\n    .split(' ')\n    .map(t => t.split(',').map(num => parseFloat(num)));\n\nexport const createMinorHandle = (xy, handleRadius) => {\n  // Make this 80% smaller than the configured handle radius\n  const radius = Math.round((handleRadius || 6) * 0.8);\n\n  const c = document.createElementNS(SVG_NAMESPACE, 'circle');\n  c.setAttribute('class', 'a9s-minor-handle');\n  c.setAttribute('cx', xy[0]);\n  c.setAttribute('cy', xy[1]);\n  c.setAttribute('r', radius);\n  return c;\n}","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { svgFragmentToShape, toSVGTarget } from '@recogito/annotorious/src/selectors';\n\nimport * as Geom2D from './Geom2D';\nimport {\n  createBaseline,\n  createBox,\n  createMinorHandle,\n  getBoxPoints,\n  setBaseline,\n  setBoxPoints\n} from './TiltedBox';\n\nconst getBBox = shape =>\n  shape.querySelector('.a9s-inner').getBBox();\n\nexport default class EditableTiltedBox extends EditableShape {\n\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    const points = svgFragmentToShape(annotation)\n      .getAttribute('points')\n      .split(' ')\n      .map(t => t.split(',').map(num => parseFloat(num)));\n\n    // Shorthand\n    const [ a, b, c, _ ] = points;\n\n    // 'g' for the compound shape (and mask -  in the future)\n    this.containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    // The 'element' (baseline, box, handles)\n    this._element = document.createElementNS(SVG_NAMESPACE, 'g');\n    this._element.setAttribute('class', 'a9s-annotation tilted-box editable selected');\n\n    this.box = createBox(points);\n    this.box.querySelector('.a9s-inner')\n      .addEventListener('mousedown', this.onGrab(this.box));\n\n    this.baseline = createBaseline(a, b); \n    \n    this.pivotHandle = this.drawHandle(a[0], a[1]);\n    this.baseEndHandle = createMinorHandle(b, config.handleRadius);\n    this.oppositeHandle = createMinorHandle(c, config.handleRadius);\n\n    [this.pivotHandle, this.baseEndHandle, this.oppositeHandle].map(elem => {\n      elem.addEventListener('mousedown', this.onGrab(elem));\n    });\n\n    this._element.appendChild(this.box);\n    this._element.appendChild(this.baseline);\n    this._element.appendChild(this.pivotHandle);\n    this._element.appendChild(this.baseEndHandle);\n    this._element.appendChild(this.oppositeHandle);\n\n    this.containerGroup.appendChild(this._element);\n\n    g.appendChild(this.containerGroup);\n\n    // The grabbed element (handle or entire group), if any\n    this.grabbedElem = null;\n\n    // Mouse grab point\n    this.grabbedAt = null;\n  }\n\n  setShape = points => {\n    setBoxPoints(this.box, points);\n    setBaseline(this.baseline, points[0], points[1]);\n\n    this.baseEndHandle.setAttribute('cx', points[1][0]);\n    this.baseEndHandle.setAttribute('cy', points[1][1]);\n\n    this.oppositeHandle.setAttribute('cx', points[2][0]);\n    this.oppositeHandle.setAttribute('cy', points[2][1]);\n\n    this.setHandleXY(this.pivotHandle, points[0][0], points[0][1]);\n  }\n\n  setBaseEnd = xy => {\n    const [ a, b, currentC, _ ] = getBoxPoints(this.box);\n\n    const isClockwise = () => {\n      const base = Geom2D.round(Geom2D.normalize(Geom2D.vec(b, a)), 5);\n      const height = Geom2D.round(Geom2D.normalize(Geom2D.vec(currentC, b)), 5);\n  \n      return Geom2D.eq([ -base[1], base[0] ], height);\n    }\n\n    // Current box height\n    const height = Geom2D.len(b, currentC);\n    \n    const updatedBase = Geom2D.vec(xy, a);\n    const updatedNorm = Geom2D.normalize([ -updatedBase[1], updatedBase[0] ]);\n    const updatedHeight = isClockwise() ? Geom2D.mult(updatedNorm, height) : Geom2D.mult(updatedNorm, -height);\n\n    const c = Geom2D.add(xy, updatedHeight)\n    const d = Geom2D.add(a, updatedHeight);\n\n    this.setShape([ a, xy, c, d ]);\n  }\n\n  setOppositeCorner = xy => {\n    const [ a, b, ..._ ] = getBoxPoints(this.box);\n\n    // Baseline normal (len = 1)\n    const baseline = Geom2D.vec(b, a);\n    const normal = Geom2D.normalize([ - baseline[1], baseline[0] ]);\n\n    // Vector baseline end -> mouse\n    const toMouse = Geom2D.vec(xy, b);\n\n    // Projection of toMouse onto normal\n    const f = [\n      normal[0] * Geom2D.len(toMouse) * Math.cos(Geom2D.angleBetween(normal, Geom2D.normalize(toMouse))),\n      normal[1] * Geom2D.len(toMouse) * Math.cos(Geom2D.angleBetween(normal, Geom2D.normalize(toMouse)))\n    ];\n\n    const c = Geom2D.add(b, f);\n    const d = Geom2D.add(a, f);\n\n    this.setShape([ a, b, c, d ]);\n  }\n\n  onScaleChanged = scale => {\n    // Pivot\n    const inner = this.pivotHandle.querySelector('.a9s-handle-inner');\n    const outer = this.pivotHandle.querySelector('.a9s-handle-outer');\n\n    const radius = scale * (this.config.handleRadius || 6);\n\n    inner.setAttribute('r', radius);\n    outer.setAttribute('r', radius);\n\n    // Minor handles\n    const minorRadius = Math.round(0.8 * radius);\n    this.baseEndHandle.setAttribute('r', minorRadius);\n    this.oppositeHandle.setAttribute('r', minorRadius);\n  }\n\n  onGrab = grabbedElem => evt => {\n    if (evt.button !== 0) return;  // left click\n    this.grabbedElem = grabbedElem;\n    this.grabbedAt = this.getSVGPoint(evt);\n  }\n\n  onMouseMove = evt => {\n    const constrain = (coord, delta, max) =>\n      coord + delta < 0 ? -coord : (coord + delta > max ? max - coord : delta);\n\n    if (this.grabbedElem) {\n      const pos = this.getSVGPoint(evt);\n\n      if (this.grabbedElem === this.box || this.grabbedElem === this.pivotHandle) {\n        const { x, y, width, height } = getBBox(this.box);\n\n        const { naturalWidth, naturalHeight } = this.env.image;\n\n        const dx = constrain(x, pos.x - this.grabbedAt.x, naturalWidth - width);\n        const dy = constrain(y, pos.y - this.grabbedAt.y, naturalHeight - height);\n\n        const updatedPoints = getBoxPoints(this.box).map(pt => [ pt[0] + dx, pt[1] + dy ]);\n\n        this.setShape(updatedPoints);        \n      } else if (this.grabbedElem === this.baseEndHandle) {\n        this.setBaseEnd([ pos.x, pos.y ]);\n      } else if (this.grabbedElem === this.oppositeHandle) {\n        this.setOppositeCorner([ pos.x, pos.y ]);\n      }\n\n      this.grabbedAt = pos;\n\n      this.emit('update', {\n        ...toSVGTarget(this.box, this.env.image),\n        renderedVia: {\n          name: 'annotorious-tilted-box'\n        }\n      });\n    }\n  }\n\n  onMouseUp = () => {\n    this.grabbedElem = null;\n    this.grabbedAt = null;\n  }\n\n  get element() {\n    return this._element;\n  }\n\n  updateState = annotation => {\n    const points = svgFragmentToShape(annotation)\n      .getAttribute('points')\n      .split(' ')\n      .map(t => t.split(',').map(num => parseFloat(num)));\n    \n    this.setShape(points);\n  }\n\n  destroy() {\n    this.containerGroup.parentNode.removeChild(this.containerGroup);\n    super.destroy();\n  }\n\n}","import { Selection, ToolLike } from '@recogito/annotorious/src/tools/Tool';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\n\nimport * as Geom2D from './Geom2D';\nimport { \n  createBaseline, \n  createBox,\n  setBaseline,\n  setBoxPoints\n} from './TiltedBox';\n\nconst polygonBounds = points => {\n  return { w: 100, h: 100 };\n}\n\nexport default class TiltedBox extends ToolLike {\n\n  constructor(points, g, config, env) {\n    super(g, config, env);\n\n    this.points = points;\n\n    const [ a, b, ..._ ] = points;\n\n    this.group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.element = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.element.setAttribute('class', 'a9s-selection tilted-box');\n    \n    this.baseline = createBaseline();\n    this.tiltedbox = createBox();\n\n    this.pivot = this.drawHandle(0, 0);\n\n    this.setPoints(points);\n\n    // We make the selection transparent to \n    // pointer events because it would interfere with the \n    // rendered annotations' mouseleave/enter events\n    this.element.style.pointerEvents = 'none';\n\n    this.element.appendChild(this.tiltedbox);\n    this.element.appendChild(this.baseline);\n    this.element.appendChild(this.pivot);\n\n    this.group.appendChild(this.element);\n\n    g.appendChild(this.group);\n  }\n  \n  scalePivot = scale => {\n    const inner = this.pivot.querySelector('.a9s-handle-inner');\n    const outer = this.pivot.querySelector('.a9s-handle-outer');\n\n    const radius = scale * (this.config.handleRadius || 6);\n\n    inner.setAttribute('r', radius);\n    outer.setAttribute('r', radius);\n  }\n\n  get isCollapsed() {\n    const { w, h } = polygonBounds(this.points);\n    return w * h < 9;\n  }\n\n  setPoints = points => {\n    this.points = points; \n\n    const [ a, b, ..._ ] = points;\n\n    setBaseline(this.baseline, a, b);\n    setBoxPoints(this.tiltedbox, points);\n\n    this.setHandleXY(this.pivot, a[0], a[1]);\n  } \n  \n  setBaseEnd = (x, y) => {\n    const a = this.points[0];\n    const b = [ x, y ];\n    this.setPoints([ a, b, b, a ]);\n  }\n\n  extrude = (pointerX, pointerY) => {\n    const [ a, b, ..._] = this.points;\n\n    // Baseline normal (len = 1)\n    const baseline = Geom2D.vec(b, a);\n    const normal = Geom2D.normalize([ - baseline[1], baseline[0] ]);\n\n    // Vector baseline end -> mouse\n    const toMouse = Geom2D.vec([ pointerX, pointerY ], b);\n\n    // Projection of toMouse onto normal\n    const f = [\n      normal[0] * Geom2D.len(toMouse) * Math.cos(Geom2D.angleBetween(normal, Geom2D.normalize(toMouse))),\n      normal[1] * Geom2D.len(toMouse) * Math.cos(Geom2D.angleBetween(normal, Geom2D.normalize(toMouse)))\n    ];\n\n    const c = Geom2D.add(b, f);\n    const d = Geom2D.add(a, f);\n\n    this.setPoints([ a, b, c, d ]);\n  }\n\n  toSelection = source => {\n    const points = this.tiltedbox.querySelector('.a9s-inner').getAttribute('points');\n \n    return new Selection({ \n      source,\n      selector: {\n        type: 'SvgSelector',\n        value: `<svg><polygon points=\"${points}\" /></svg>`,\n      },\n      renderedVia: {\n        name: 'annotorious-tilted-box'\n      }\n    });\n  }\n\n  destroy = () => {\n    this.group.parentNode.removeChild(this.group);\n\n    this.element = null;\n    this.group = null;\n  }\n\n}","import api from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./TiltedBoxTool.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import Tool from '@recogito/annotorious/src/tools/Tool';\nimport EditableTiltedBox from './EditableTiltedBox';\nimport RubberbandTiltedBox from './RubberbandTiltedBox';\n\nimport './TiltedBoxTool.scss';\n\nexport default class TiltedBoxTool extends Tool {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n    \n    this.drawingState = null;\n\n    this.rubberbandShape = null;\n  }\n\n  onScaleChanged = scale => \n    this.rubberbandShape?.scalePivot(scale);\n\n  startDrawing = (x, y, _) => {\n    this.attachListeners({\n      mouseMove: this.onMouseMove,\n      mouseUp: this.onMouseUp\n    });\n\n    this.drawingState = 'BASELINE';\n\n    this.rubberbandShape = new RubberbandTiltedBox([\n      [ x, y ],\n      [ x, y ],\n      [ x, y ],\n      [ x, y ]\n    ], this.g, this.config, this.env);\n  }\n\n  onMouseMove = (x, y) => {\n    if (this.drawingState === 'BASELINE')\n      this.rubberbandShape.setBaseEnd(x, y);\n    else if (this.drawingState === 'EXTRUDE')\n      this.rubberbandShape.extrude(x, y);\n  }\n  \n  onMouseUp = () => {\n    if (this.drawingState === 'BASELINE') {\n      if (this.rubberbandShape.isCollapsed) {\n        this.emit('cancel');\n        this.stop();\n      } else {\n        this.drawingState = 'EXTRUDE'\n      }\n    } else if (this.drawingState === 'EXTRUDE') {\n      const shape = this.rubberbandShape.element;\n      shape.annotation = this.rubberbandShape.toSelection(this.env.image.src);\n      this.emit('complete', shape);\n      this.stop();\n    }\n  }\n\n  stop = () => {\n    this.detachListeners();\n    this.drawingState = null;\n    \n    if (this.rubberbandShape) {\n      this.rubberbandShape.destroy();\n      this.rubberbandShape = null;\n    }\n  }\n\n  get isDrawing() {\n    return this.drawingState != null;\n  }\n\n  createEditableShape = annotation =>\n    new EditableTiltedBox(annotation, this.g, this.config, this.env);\n\n}\n\nTiltedBoxTool.identifier = 'annotorious-tilted-box';\n\nTiltedBoxTool.supports = annotation => false;\n","import TiltedBoxTool from './TiltedBoxTool';\n\nconst TiltedBoxPlugin = anno => {\n\n  anno.addDrawingTool(TiltedBoxTool);\n  \n}\n\nexport default TiltedBoxPlugin;"],"names":["root","factory","exports","module","define","amd","self","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","id","_i","push","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","_s","_e","_arr","_n","_d","call","next","done","value","err","_iterableToArrayLimit","o","minLen","n","Object","prototype","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","equal","a","b","keys","RegExp","flags","valueOf","hasOwnProperty","key","E","on","callback","ctx","e","fn","once","listener","off","apply","arguments","_","emit","evtArr","evts","liveEvents","TinyEmitter","___CSS_LOADER_EXPORT___","memo","getTarget","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","forEach","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","newLastIdentifiers","_index","splice","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","d","definition","defineProperty","enumerable","get","prop","getRandomValues","SVG_NAMESPACE","rnds8","Uint8Array","rng","crypto","msCrypto","uuid","REGEX","byteToHex","substr","buf","offset","rnds","random","toLowerCase","validate","WebAnnotation","annotation","opts","opt_props","opt_opts","underlying","type","selector","find","s","other","equals","readOnly","motivation","body","bodies","exact","start","end","args","stub","Selection","cloned","parse","assign","IMPLEMENTATION_MISSING","isTouch","navigator","maxTouchPoints","msMaxTouchPoints","ToolLike","g","config","env","ResizeObserver","resizeObserver","svgBounds","svg","getBoundingClientRect","viewBox","baseVal","width","height","scale","Math","max","onScaleChanged","observe","evt","pt","createSVGPoint","bbox","x","clientX","y","clientY","left","top","matrixTransform","getScreenCTM","inverse","offsetX","offsetY","getCTM","containerGroup","createElementNS","group","drawCircle","r","c","radius","handleRadius","inner","outer","handle","parseFloat","getAttribute","closest","image","Element","HTMLDocument","enableResponsive","disconnect","EventEmitter","Tool","mouseMove","mouseUp","dblClick","getSVGPoint","started","addEventListener","button","removeEventListener","startOnSingleClick","startDrawing","supports","sanitize","doc","cleanEl","el","attr","startsWith","scripts","getElementsByTagName","reverse","querySelectorAll","svgFragmentToShape","originalDoc","namespaced","parser","DOMParser","parseFromString","isPrefixDeclared","lookupPrefix","isDefaultNamespaceSVG","lookupNamespaceURI","XMLSerializer","serializeToString","documentElement","replace","xy1","xy2","sqrt","pow","vec","terminal","starting","round","decimalPlaces","factor","normalize","xy","l","angleBetween","dotProduct","acos","add","mult","elem","createBaseline","optA","optB","setBaseline","createBox","optPoints","setBoxPoints","to","setCoords","line","points","getBoxPoints","split","t","num","createMinorHandle","EditableTiltedBox","box","baseline","baseEndHandle","oppositeHandle","setHandleXY","pivotHandle","currentC","Geom2D","updatedBase","updatedNorm","updatedHeight","isClockwise","setShape","normal","toMouse","f","cos","minorRadius","grabbedElem","grabbedAt","constrain","coord","delta","pos","getBBox","naturalWidth","naturalHeight","dx","dy","updatedPoints","setBaseEnd","setOppositeCorner","shape","cloneNode","serialized","outerHTML","src","toSVGTarget","renderedVia","onMouseMove","onMouseUp","_element","onGrab","drawHandle","EditableShape","TiltedBox","pivot","tiltedbox","setPoints","pointerX","pointerY","element","pointerEvents","w","h","TiltedBoxTool","rubberbandShape","scalePivot","attachListeners","drawingState","RubberbandTiltedBox","extrude","isCollapsed","stop","toSelection","detachListeners","destroy","anno","addDrawingTool"],"sourceRoot":""}