{"ast":null,"code":"require(\"core-js/modules/es.regexp.flags.js\");\n\nrequire(\"core-js/modules/es.typed-array.at.js\");\n\nrequire(\"core-js/modules/esnext.typed-array.find-last.js\");\n\nrequire(\"core-js/modules/esnext.typed-array.find-last-index.js\");\n\nrequire(\"core-js/modules/es.error.cause.js\");\n\n(function webpackUniversalModuleDefinition(root, factory) {\n  if (typeof exports === 'object' && typeof module === 'object') module.exports = factory();else if (typeof define === 'function' && define.amd) define([], factory);else if (typeof exports === 'object') exports[\"Annotorious\"] = factory();else root[\"Annotorious\"] = root[\"Annotorious\"] || {}, root[\"Annotorious\"][\"SelectorPack\"] = factory();\n})(self, () => {\n  return (\n    /******/\n    (() => {\n      // webpackBootstrap\n\n      /******/\n      var __webpack_modules__ = {\n        /***/\n        94:\n        /*!***********************************************!*\\\r\n          !*** ./node_modules/fast-deep-equal/index.js ***!\r\n          \\***********************************************/\n\n        /***/\n        module => {\n          \"use strict\"; // do not edit .js files directly - edit src/index.jst\n\n          function _typeof(obj) {\n            \"@babel/helpers - typeof\";\n\n            return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n              return typeof obj;\n            } : function (obj) {\n              return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n            }, _typeof(obj);\n          }\n\n          module.exports = function equal(a, b) {\n            if (a === b) return true;\n\n            if (a && b && _typeof(a) == 'object' && _typeof(b) == 'object') {\n              if (a.constructor !== b.constructor) return false;\n              var length, i, keys;\n\n              if (Array.isArray(a)) {\n                length = a.length;\n                if (length != b.length) return false;\n\n                for (i = length; i-- !== 0;) {\n                  if (!equal(a[i], b[i])) return false;\n                }\n\n                return true;\n              }\n\n              if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n              if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n              if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n              keys = Object.keys(a);\n              length = keys.length;\n              if (length !== Object.keys(b).length) return false;\n\n              for (i = length; i-- !== 0;) {\n                if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n              }\n\n              for (i = length; i-- !== 0;) {\n                var key = keys[i];\n                if (!equal(a[key], b[key])) return false;\n              }\n\n              return true;\n            } // true if both NaN, false otherwise\n\n\n            return a !== a && b !== b;\n          };\n          /***/\n\n        },\n\n        /***/\n        773:\n        /*!********************************************!*\\\r\n          !*** ./node_modules/tiny-emitter/index.js ***!\r\n          \\********************************************/\n\n        /***/\n        module => {\n          function E() {// Keep this empty so it's easier to inherit from\n            // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n          }\n\n          E.prototype = {\n            on: function on(name, callback, ctx) {\n              var e = this.e || (this.e = {});\n              (e[name] || (e[name] = [])).push({\n                fn: callback,\n                ctx: ctx\n              });\n              return this;\n            },\n            once: function once(name, callback, ctx) {\n              var self = this;\n\n              function listener() {\n                self.off(name, listener);\n                callback.apply(ctx, arguments);\n              }\n\n              ;\n              listener._ = callback;\n              return this.on(name, listener, ctx);\n            },\n            emit: function emit(name) {\n              var data = [].slice.call(arguments, 1);\n              var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n              var i = 0;\n              var len = evtArr.length;\n\n              for (i; i < len; i++) {\n                evtArr[i].fn.apply(evtArr[i].ctx, data);\n              }\n\n              return this;\n            },\n            off: function off(name, callback) {\n              var e = this.e || (this.e = {});\n              var evts = e[name];\n              var liveEvents = [];\n\n              if (evts && callback) {\n                for (var i = 0, len = evts.length; i < len; i++) {\n                  if (evts[i].fn !== callback && evts[i].fn._ !== callback) liveEvents.push(evts[i]);\n                }\n              } // Remove event from queue to prevent memory leak\n              // Suggested by https://github.com/lazd\n              // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n\n              liveEvents.length ? e[name] = liveEvents : delete e[name];\n              return this;\n            }\n          };\n          module.exports = E;\n          module.exports.TinyEmitter = E;\n          /***/\n        }\n        /******/\n\n      };\n      /************************************************************************/\n\n      /******/\n      // The module cache\n\n      /******/\n\n      var __webpack_module_cache__ = {};\n      /******/\n\n      /******/\n      // The require function\n\n      /******/\n\n      function __webpack_require__(moduleId) {\n        /******/\n        // Check if module is in cache\n\n        /******/\n        var cachedModule = __webpack_module_cache__[moduleId];\n        /******/\n\n        if (cachedModule !== undefined) {\n          /******/\n          return cachedModule.exports;\n          /******/\n        }\n        /******/\n        // Create a new module (and put it into the cache)\n\n        /******/\n\n\n        var module = __webpack_module_cache__[moduleId] = {\n          /******/\n          // no module.id needed\n\n          /******/\n          // no module.loaded needed\n\n          /******/\n          exports: {}\n          /******/\n\n        };\n        /******/\n\n        /******/\n        // Execute the module function\n\n        /******/\n\n        __webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n        /******/\n\n        /******/\n        // Return the exports of the module\n\n        /******/\n\n\n        return module.exports;\n        /******/\n      }\n      /******/\n\n      /************************************************************************/\n\n      /******/\n\n      /* webpack/runtime/compat get default export */\n\n      /******/\n\n\n      (() => {\n        /******/\n        // getDefaultExport function for compatibility with non-harmony modules\n\n        /******/\n        __webpack_require__.n = module => {\n          /******/\n          var getter = module && module.__esModule ?\n          /******/\n          () => module['default'] :\n          /******/\n          () => module;\n          /******/\n\n          __webpack_require__.d(getter, {\n            a: getter\n          });\n          /******/\n\n\n          return getter;\n          /******/\n        };\n        /******/\n\n      })();\n      /******/\n\n      /******/\n\n      /* webpack/runtime/define property getters */\n\n      /******/\n\n\n      (() => {\n        /******/\n        // define getter functions for harmony exports\n\n        /******/\n        __webpack_require__.d = (exports, definition) => {\n          /******/\n          for (var key in definition) {\n            /******/\n            if (__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n              /******/\n              Object.defineProperty(exports, key, {\n                enumerable: true,\n                get: definition[key]\n              });\n              /******/\n            }\n            /******/\n\n          }\n          /******/\n\n        };\n        /******/\n\n      })();\n      /******/\n\n      /******/\n\n      /* webpack/runtime/hasOwnProperty shorthand */\n\n      /******/\n\n\n      (() => {\n        /******/\n        __webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n        /******/\n\n      })();\n      /******/\n\n      /************************************************************************/\n\n\n      var __webpack_exports__ = {}; // This entry need to be wrapped in an IIFE because it need to be in strict mode.\n\n      (() => {\n        \"use strict\";\n        /*!***********************************!*\\\r\n          !*** ./src/index.js + 38 modules ***!\r\n          \\***********************************/\n        // EXPORTS\n\n        __webpack_require__.d(__webpack_exports__, {\n          \"default\": () =>\n          /* binding */\n          src\n        }); // EXTERNAL MODULE: ./node_modules/tiny-emitter/index.js\n\n\n        var tiny_emitter = __webpack_require__(773);\n\n        var tiny_emitter_default = /*#__PURE__*/__webpack_require__.n(tiny_emitter);\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/util/Touch.js\n\n        var SIM_EVENTS = {\n          touchstart: 'mousedown',\n          touchmove: 'mousemove',\n          touchend: 'mouseup'\n        };\n\n        var isTouchDevice = function isTouchDevice() {\n          return 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;\n        };\n\n        var enableTouchTranslation = function enableTouchTranslation(el) {\n          var pressAndHoldTrigger = null;\n\n          var simulateEvent = function simulateEvent(type, e) {\n            return new MouseEvent(type, {\n              screenX: e.screenX,\n              screenY: e.screenY,\n              clientX: e.clientX,\n              clientY: e.clientY,\n              pageX: e.pageX,\n              pageY: e.pageY,\n              bubbles: true\n            });\n          };\n\n          var touchHandler = function touchHandler(evt) {\n            var touch = evt.changedTouches[0];\n            var simulatedEvent = simulateEvent(SIM_EVENTS[evt.type], touch);\n            touch.target.dispatchEvent(simulatedEvent);\n            evt.preventDefault();\n\n            if (evt.type === 'touchstart' || evt.type === 'touchmove') {\n              pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\n              pressAndHoldTrigger = setTimeout(function () {\n                var simulatedEvent = simulateEvent('dblclick', touch);\n                touch.target.dispatchEvent(simulatedEvent);\n              }, 800);\n            }\n\n            if (evt.type === 'touchend') pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\n          };\n\n          el.addEventListener('touchstart', touchHandler, true);\n          el.addEventListener('touchmove', touchHandler, true);\n          el.addEventListener('touchend', touchHandler, true);\n          el.addEventListener('touchcancel', touchHandler, true);\n        };\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/util/SVG.js\n\n        var SVG_SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n\n        var getClassNames = function getClassNames(el) {\n          var attr = el.getAttribute('class');\n          return attr ? new Set(attr.split(' ')) : new Set();\n        }; // IE11 doesn't support adding/removing classes to SVG elements except \n        // via .setAttribute\n\n\n        var SVG_addClass = function addClass(el, className) {\n          var classNames = getClassNames(el);\n          classNames.add(className);\n          el.setAttribute('class', Array.from(classNames).join(' '));\n        };\n\n        var removeClass = function removeClass(el, className) {\n          var classNames = getClassNames(el);\n          classNames[\"delete\"](className);\n          if (classNames.size === 0) el.removeAttribute('class');else el.setAttribute('class', Array.from(classNames).join(' '));\n        };\n\n        var hasClass = function hasClass(el, className) {\n          return getClassNames(el).has(className);\n        };\n\n        ; // CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/rng.js\n        // Unique ID creation requires a high quality random # generator. In the browser we therefore\n        // require the crypto API and do not support built-in fallback to lower quality random number\n        // generators (like Math.random()).\n\n        var getRandomValues;\n        var rnds8 = new Uint8Array(16);\n\n        function rng() {\n          // lazy load so that environments that need to polyfill have a chance to do so\n          if (!getRandomValues) {\n            // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n            // find the complete implementation of crypto (msCrypto) on IE11.\n            getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n            if (!getRandomValues) {\n              throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n            }\n          }\n\n          return getRandomValues(rnds8);\n        }\n\n        ; // CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/regex.js\n\n        /* harmony default export */\n\n        const regex = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;\n        ; // CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/validate.js\n\n        function validate(uuid) {\n          return typeof uuid === 'string' && regex.test(uuid);\n        }\n        /* harmony default export */\n\n\n        const esm_browser_validate = validate;\n        ; // CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/stringify.js\n\n        /**\r\n         * Convert array of 16 byte values to UUID string format of the form:\r\n         * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\r\n         */\n\n        var byteToHex = [];\n\n        for (var i = 0; i < 256; ++i) {\n          byteToHex.push((i + 0x100).toString(16).substr(1));\n        }\n\n        function stringify(arr) {\n          var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0; // Note: Be careful editing this code!  It's been tuned for performance\n          // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n\n          var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n          // of the following:\n          // - One or more input array values don't map to a hex octet (leading to\n          // \"undefined\" in the uuid)\n          // - Invalid input values for the RFC `version` or `variant` fields\n\n          if (!esm_browser_validate(uuid)) {\n            throw TypeError('Stringified UUID is invalid');\n          }\n\n          return uuid;\n        }\n        /* harmony default export */\n\n\n        const esm_browser_stringify = stringify;\n        ; // CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/v4.js\n\n        function v4(options, buf, offset) {\n          options = options || {};\n          var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n          rnds[6] = rnds[6] & 0x0f | 0x40;\n          rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n          if (buf) {\n            offset = offset || 0;\n\n            for (var i = 0; i < 16; ++i) {\n              buf[offset + i] = rnds[i];\n            }\n\n            return buf;\n          }\n\n          return esm_browser_stringify(rnds);\n        }\n        /* harmony default export */\n\n\n        const esm_browser_v4 = v4; // EXTERNAL MODULE: ./node_modules/fast-deep-equal/index.js\n\n        var fast_deep_equal = __webpack_require__(94);\n\n        var fast_deep_equal_default = /*#__PURE__*/__webpack_require__.n(fast_deep_equal);\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/recogito-client-core/src/WebAnnotation.js\n\n        function ownKeys(object, enumerableOnly) {\n          var keys = Object.keys(object);\n\n          if (Object.getOwnPropertySymbols) {\n            var symbols = Object.getOwnPropertySymbols(object);\n            enumerableOnly && (symbols = symbols.filter(function (sym) {\n              return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n            })), keys.push.apply(keys, symbols);\n          }\n\n          return keys;\n        }\n\n        function _objectSpread(target) {\n          for (var i = 1; i < arguments.length; i++) {\n            var source = null != arguments[i] ? arguments[i] : {};\n            i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n              _defineProperty(target, key, source[key]);\n            }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n              Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n            });\n          }\n\n          return target;\n        }\n\n        function _classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function _defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function _createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) _defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function _defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var WebAnnotation = /*#__PURE__*/function () {\n          function WebAnnotation(annotation, opts) {\n            var _this = this;\n\n            _classCallCheck(this, WebAnnotation);\n\n            _defineProperty(this, \"clone\", function (opt_props, opt_opts) {\n              return new WebAnnotation(_objectSpread(_objectSpread({}, _this.underlying), opt_props), _objectSpread(_objectSpread({}, _this.opts), opt_opts));\n            });\n\n            _defineProperty(this, \"selector\", function (type) {\n              var target = _this.underlying.target;\n\n              if (target.selector) {\n                // Normalize to array\n                var selectors = Array.isArray(target.selector) ? target.selector : [target.selector];\n                return selectors.find(function (s) {\n                  return s.type === type;\n                });\n              }\n            });\n\n            this.underlying = annotation;\n            this.opts = opts;\n          }\n          /** For convenience - creates an empty web annotation **/\n\n\n          _createClass(WebAnnotation, [{\n            key: \"isEqual\",\n            value:\n            /** An equality check based on the underlying object **/\n            function isEqual(other) {\n              if ((other === null || other === void 0 ? void 0 : other.type) !== 'Annotation') {\n                return false;\n              } else if (this.underlying === other.underlying) {\n                return true;\n              } else if (!this.underlying.id || !other.underlying.id) {\n                return false;\n              } else {\n                return fast_deep_equal_default()(this.underlying, other.underlying);\n              }\n            }\n          }, {\n            key: \"readOnly\",\n            get: function get() {\n              var _this$opts;\n\n              return (_this$opts = this.opts) === null || _this$opts === void 0 ? void 0 : _this$opts.readOnly;\n            }\n            /*************************************/\n\n            /* Getters to forward properties of  */\n\n            /* the underlying annotation         */\n\n            /*************************************/\n\n          }, {\n            key: \"id\",\n            get: function get() {\n              return this.underlying.id;\n            }\n          }, {\n            key: \"context\",\n            get: function get() {\n              return this.underlying['@context'];\n            }\n          }, {\n            key: \"type\",\n            get: function get() {\n              return this.underlying.type;\n            }\n          }, {\n            key: \"motivation\",\n            get: function get() {\n              return this.underlying.motivation;\n            }\n          }, {\n            key: \"body\",\n            get: function get() {\n              return this.underlying.body;\n            }\n          }, {\n            key: \"target\",\n            get: function get() {\n              return this.underlying.target;\n            }\n            /** Same as .body, but guaranteed to return an array **/\n\n          }, {\n            key: \"bodies\",\n            get: function get() {\n              return Array.isArray(this.underlying.body) ? this.underlying.body : [this.underlying.body];\n            }\n            /** Only bodies are meant to be mutated by the application **/\n            ,\n            set: function set(bodies) {\n              this.underlying.body = bodies;\n            }\n            /** Same as .target, but guaranteed to return an array **/\n\n          }, {\n            key: \"targets\",\n            get: function get() {\n              return Array.isArray(this.underlying.target) ? this.underlying.target : [this.underlying.target];\n            }\n            /*****************************************/\n\n            /* Various access helpers and shorthands */\n\n            /*****************************************/\n\n            /** Selector of the given type **/\n\n          }, {\n            key: \"quote\",\n            get:\n            /** Shorthand for the 'exact' field of the TextQuoteSelector **/\n            function get() {\n              var _this$selector;\n\n              return (_this$selector = this.selector('TextQuoteSelector')) === null || _this$selector === void 0 ? void 0 : _this$selector.exact;\n            }\n            /** Shorthand for the 'start' field of the TextPositionSelector **/\n\n          }, {\n            key: \"start\",\n            get: function get() {\n              var _this$selector2;\n\n              return (_this$selector2 = this.selector('TextPositionSelector')) === null || _this$selector2 === void 0 ? void 0 : _this$selector2.start;\n            }\n            /** Shorthand for the 'end' field of the TextPositionSelector **/\n\n          }, {\n            key: \"end\",\n            get: function get() {\n              var _this$selector3;\n\n              return (_this$selector3 = this.selector('TextPositionSelector')) === null || _this$selector3 === void 0 ? void 0 : _this$selector3.end;\n            }\n          }]);\n\n          return WebAnnotation;\n        }();\n\n        _defineProperty(WebAnnotation, \"create\", function (args) {\n          var stub = {\n            '@context': 'http://www.w3.org/ns/anno.jsonld',\n            'type': 'Annotation',\n            'id': \"#\".concat(esm_browser_v4()),\n            'body': []\n          };\n          return new WebAnnotation(_objectSpread(_objectSpread({}, stub), args));\n        });\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/recogito-client-core/src/Selection.js\n\n        function Selection_ownKeys(object, enumerableOnly) {\n          var keys = Object.keys(object);\n\n          if (Object.getOwnPropertySymbols) {\n            var symbols = Object.getOwnPropertySymbols(object);\n            enumerableOnly && (symbols = symbols.filter(function (sym) {\n              return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n            })), keys.push.apply(keys, symbols);\n          }\n\n          return keys;\n        }\n\n        function Selection_objectSpread(target) {\n          for (var i = 1; i < arguments.length; i++) {\n            var source = null != arguments[i] ? arguments[i] : {};\n            i % 2 ? Selection_ownKeys(Object(source), !0).forEach(function (key) {\n              Selection_defineProperty(target, key, source[key]);\n            }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : Selection_ownKeys(Object(source)).forEach(function (key) {\n              Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n            });\n          }\n\n          return target;\n        }\n\n        function Selection_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function Selection_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function Selection_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) Selection_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) Selection_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function Selection_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * An \"annotation in draft mode\". Really the same\r\n         * data structure, but as a separate class so we can\r\n         * tell things apart properly.\r\n         */\n\n\n        var Selection = /*#__PURE__*/function () {\n          function Selection(_target, body) {\n            var _this = this;\n\n            Selection_classCallCheck(this, Selection);\n            Selection_defineProperty(this, \"clone\", function (opt_props) {\n              // Deep-clone\n              var cloned = new Selection();\n              cloned.underlying = JSON.parse(JSON.stringify(_this.underlying));\n              if (opt_props) cloned.underlying = Selection_objectSpread(Selection_objectSpread({}, cloned.underlying), opt_props);\n              return cloned;\n            });\n            Selection_defineProperty(this, \"selector\", function (type) {\n              var target = _this.underlying.target;\n\n              if (target.selector) {\n                // Normalize to array\n                var selectors = Array.isArray(target.selector) ? target.selector : [target.selector];\n                return selectors.find(function (s) {\n                  return s.type === type;\n                });\n              }\n            });\n            Selection_defineProperty(this, \"toAnnotation\", function () {\n              var a = Object.assign({}, _this.underlying, {\n                'type': 'Annotation',\n                'id': \"#\".concat(esm_browser_v4())\n              });\n              return new WebAnnotation(a);\n            });\n            this.underlying = {\n              '@context': 'http://www.w3.org/ns/anno.jsonld',\n              type: 'Selection',\n              body: body || [],\n              target: _target\n            };\n          }\n          /** Creates a copy of this selection **/\n\n\n          Selection_createClass(Selection, [{\n            key: \"context\",\n            get: function get() {\n              return this.underlying['@context'];\n            }\n          }, {\n            key: \"type\",\n            get: function get() {\n              return this.underlying.type;\n            }\n          }, {\n            key: \"body\",\n            get: function get() {\n              return this.underlying.body;\n            }\n          }, {\n            key: \"target\",\n            get: function get() {\n              return this.underlying.target;\n            }\n          }, {\n            key: \"targets\",\n            get: function get() {\n              return Array.isArray(this.underlying.target) ? this.underlying.target : [this.underlying.target];\n            }\n            /** For consistency with WebAnnotation **/\n\n          }, {\n            key: \"isEqual\",\n            value: function isEqual(other) {\n              if (!other) {\n                return false;\n              } else {\n                return fast_deep_equal_default()(this.underlying, other.underlying);\n              }\n            }\n          }, {\n            key: \"bodies\",\n            get: function get() {\n              return Array.isArray(this.underlying.body) ? this.underlying.body : [this.underlying.body];\n            }\n          }, {\n            key: \"quote\",\n            get:\n            /** Shorthand for the 'exact' field of the TextQuoteSelector **/\n            function get() {\n              var _this$selector;\n\n              return (_this$selector = this.selector('TextQuoteSelector')) === null || _this$selector === void 0 ? void 0 : _this$selector.exact;\n            }\n            /*******************************************/\n\n            /* Selection-specific properties & methods */\n\n            /*******************************************/\n\n          }, {\n            key: \"isSelection\",\n            get: function get() {\n              return true;\n            }\n          }]);\n          return Selection;\n        }();\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/tools/Tool.js\n\n        function _typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, _typeof(obj);\n        }\n\n        function Tool_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function Tool_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function Tool_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) Tool_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) Tool_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function _inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) _setPrototypeOf(subClass, superClass);\n        }\n\n        function _setPrototypeOf(o, p) {\n          _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return _setPrototypeOf(o, p);\n        }\n\n        function _createSuper(Derived) {\n          var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n          return function _createSuperInternal() {\n            var Super = _getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = _getPrototypeOf(this).constructor;\n\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return _possibleConstructorReturn(this, result);\n          };\n        }\n\n        function _possibleConstructorReturn(self, call) {\n          if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return _assertThisInitialized(self);\n        }\n\n        function _assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function _isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function _getPrototypeOf(o) {\n          _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return _getPrototypeOf(o);\n        }\n\n        function Tool_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var IMPLEMENTATION_MISSING = \"An implementation is missing\";\n        var isTouch = isTouchDevice();\n        /**\r\n         * A commmon base class for Tools and EditableShapes\r\n         */\n\n        var ToolLike = /*#__PURE__*/function (_EventEmitter) {\n          _inherits(ToolLike, _EventEmitter);\n\n          var _super = _createSuper(ToolLike);\n\n          function ToolLike(g, config, env) {\n            var _this;\n\n            Tool_classCallCheck(this, ToolLike);\n            _this = _super.call(this);\n            Tool_defineProperty(_assertThisInitialized(_this), \"enableResponsive\", function () {\n              if (window.ResizeObserver) {\n                _this.resizeObserver = new ResizeObserver(function () {\n                  var svgBounds = _this.svg.getBoundingClientRect();\n\n                  var _this$svg$viewBox$bas = _this.svg.viewBox.baseVal,\n                      width = _this$svg$viewBox$bas.width,\n                      height = _this$svg$viewBox$bas.height;\n                  _this.scale = Math.max(width / svgBounds.width, height / svgBounds.height);\n                  if (_this.onScaleChanged) _this.onScaleChanged(_this.scale);\n                });\n\n                _this.resizeObserver.observe(_this.svg.parentNode);\n              }\n            });\n            Tool_defineProperty(_assertThisInitialized(_this), \"getSVGPoint\", function (evt) {\n              var pt = _this.svg.createSVGPoint();\n\n              if (isTouch) {\n                var bbox = _this.svg.getBoundingClientRect();\n\n                var x = evt.clientX - bbox.x;\n                var y = evt.clientY - bbox.y;\n\n                var _this$svg$getBounding = _this.svg.getBoundingClientRect(),\n                    left = _this$svg$getBounding.left,\n                    top = _this$svg$getBounding.top;\n\n                pt.x = x + left;\n                pt.y = y + top;\n                return pt.matrixTransform(_this.g.getScreenCTM().inverse());\n              } else {\n                pt.x = evt.offsetX;\n                pt.y = evt.offsetY;\n                return pt.matrixTransform(_this.g.getCTM().inverse());\n              }\n            });\n            Tool_defineProperty(_assertThisInitialized(_this), \"drawHandle\", function (x, y) {\n              var containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n              containerGroup.setAttribute('class', 'a9s-handle');\n              var group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n\n              var drawCircle = function drawCircle(r) {\n                var c = document.createElementNS(SVG_SVG_NAMESPACE, 'circle');\n                c.setAttribute('cx', x);\n                c.setAttribute('cy', y);\n                c.setAttribute('r', r);\n                c.setAttribute('transform-origin', \"\".concat(x, \" \").concat(y));\n                return c;\n              };\n\n              var radius = _this.config.handleRadius || 6;\n              var inner = drawCircle(radius);\n              inner.setAttribute('class', 'a9s-handle-inner');\n              var outer = drawCircle(radius + 1);\n              outer.setAttribute('class', 'a9s-handle-outer');\n              group.appendChild(outer);\n              group.appendChild(inner);\n              containerGroup.appendChild(group);\n              return containerGroup;\n            });\n            Tool_defineProperty(_assertThisInitialized(_this), \"setHandleXY\", function (handle, x, y) {\n              var inner = handle.querySelector('.a9s-handle-inner');\n              inner.setAttribute('cx', x);\n              inner.setAttribute('cy', y);\n              inner.setAttribute('transform-origin', \"\".concat(x, \" \").concat(y));\n              var outer = handle.querySelector('.a9s-handle-outer');\n              outer.setAttribute('cx', x);\n              outer.setAttribute('cy', y);\n              outer.setAttribute('transform-origin', \"\".concat(x, \" \").concat(y));\n            });\n            Tool_defineProperty(_assertThisInitialized(_this), \"getHandleXY\", function (handle) {\n              var outer = handle.querySelector('.a9s-handle-outer');\n              return {\n                x: parseFloat(outer.getAttribute('cx')),\n                y: parseFloat(outer.getAttribute('cy'))\n              };\n            });\n            Tool_defineProperty(_assertThisInitialized(_this), \"scaleHandle\", function (handle) {\n              var inner = handle.querySelector('.a9s-handle-inner');\n              var outer = handle.querySelector('.a9s-handle-outer');\n              var radius = _this.scale * (_this.config.handleRadius || 6);\n              inner.setAttribute('r', radius);\n              outer.setAttribute('r', radius);\n            });\n            _this.svg = g.closest('svg');\n            _this.g = g;\n            _this.config = config;\n            _this.env = env; // Default image scale\n\n            _this.scale = 1; // Bit of a hack. If we are dealing with a 'real' image, we enable\n            // reponsive mode. OpenSeadragon handles scaling in a different way,\n            // so we don't need responsive mode.\n\n            var image = env.image;\n            if (image instanceof Element || image instanceof HTMLDocument) _this.enableResponsive();\n            return _this;\n          }\n          /**\r\n           * Implementations MAY extend this (calling super),\r\n           * to destroy SVG elements, mask, etc.\r\n           */\n\n\n          Tool_createClass(ToolLike, [{\n            key: \"destroy\",\n            value: function destroy() {\n              if (this.resizeObserver) this.resizeObserver.disconnect();\n              this.resizeObserver = null;\n            }\n          }]);\n          return ToolLike;\n        }(tiny_emitter_default());\n        /**\r\n         * Base class that adds some convenience stuff for tool plugins.\r\n         */\n\n\n        var Tool = /*#__PURE__*/function (_ToolLike) {\n          _inherits(Tool, _ToolLike);\n\n          var _super2 = _createSuper(Tool);\n\n          function Tool(g, config, env) {\n            var _this2;\n\n            Tool_classCallCheck(this, Tool);\n            _this2 = _super2.call(this, g, config, env); // We'll keep a flag set to false until\n            // the user has started moving, so we can\n            // fire the startSelection event\n\n            Tool_defineProperty(_assertThisInitialized(_this2), \"attachListeners\", function (_ref) {\n              var mouseMove = _ref.mouseMove,\n                  mouseUp = _ref.mouseUp,\n                  dblClick = _ref.dblClick; // Handle SVG conversion on behalf of tool implementations\n\n              if (mouseMove) {\n                _this2.mouseMove = function (evt) {\n                  var _this2$getSVGPoint = _this2.getSVGPoint(evt),\n                      x = _this2$getSVGPoint.x,\n                      y = _this2$getSVGPoint.y;\n\n                  if (!_this2.started) {\n                    _this2.emit('startSelection', {\n                      x: x,\n                      y: y\n                    });\n\n                    _this2.started = true;\n                  }\n\n                  mouseMove(x, y, evt);\n                }; // Mouse move goes on SVG element\n\n\n                _this2.svg.addEventListener('mousemove', _this2.mouseMove);\n              }\n\n              if (mouseUp) {\n                _this2.mouseUp = function (evt) {\n                  if (evt.button !== 0) return; // left click\n\n                  var _this2$getSVGPoint2 = _this2.getSVGPoint(evt),\n                      x = _this2$getSVGPoint2.x,\n                      y = _this2$getSVGPoint2.y;\n\n                  mouseUp(x, y, evt);\n                }; // Mouse up goes on doc, so we capture events outside, too\n\n\n                document.addEventListener('mouseup', _this2.mouseUp);\n              }\n\n              if (dblClick) {\n                _this2.dblClick = function (evt) {\n                  var _this2$getSVGPoint3 = _this2.getSVGPoint(evt),\n                      x = _this2$getSVGPoint3.x,\n                      y = _this2$getSVGPoint3.y;\n\n                  dblClick(x, y, evt);\n                };\n\n                document.addEventListener('dblclick', _this2.dblClick);\n              }\n            });\n            Tool_defineProperty(_assertThisInitialized(_this2), \"detachListeners\", function () {\n              if (_this2.mouseMove) _this2.svg.removeEventListener('mousemove', _this2.mouseMove);\n              if (_this2.mouseUp) document.removeEventListener('mouseup', _this2.mouseUp);\n              if (_this2.dblClick) document.removeEventListener('dblclick', _this2.dblClick);\n            });\n            Tool_defineProperty(_assertThisInitialized(_this2), \"start\", function (evt, startOnSingleClick) {\n              // Handle SVG conversion on behalf of tool implementations\n              var _this2$getSVGPoint4 = _this2.getSVGPoint(evt),\n                  x = _this2$getSVGPoint4.x,\n                  y = _this2$getSVGPoint4.y;\n\n              _this2.startDrawing(x, y, startOnSingleClick, evt);\n            });\n            Tool_defineProperty(_assertThisInitialized(_this2), \"startDrawing\", function (evt) {\n              throw new Error(IMPLEMENTATION_MISSING);\n            });\n            Tool_defineProperty(_assertThisInitialized(_this2), \"createEditableShape\", function (annotation, formatters) {\n              throw new Error(IMPLEMENTATION_MISSING);\n            });\n            _this2.started = false;\n            return _this2;\n          }\n\n          Tool_createClass(Tool, [{\n            key: \"isDrawing\",\n            get:\n            /**\r\n             * Tool implementations MUST override these\r\n             */\n            function get() {\n              throw new Error(IMPLEMENTATION_MISSING);\n            }\n          }]);\n          return Tool;\n        }(ToolLike); // In addition, Tool implementations need to implement the following static methods\n        // Tool.identifier = '...'\n\n\n        Tool.supports = function (annotation) {\n          throw new Error(IMPLEMENTATION_MISSING);\n        }; // Just some convenience shortcuts to client-core, for quicker\n        // importing in plugins. (In a way, the intention is to make the\n        // Tool class serve as a kind of mini-SDK).\n\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/tools/EditableShape.js\n\n        function EditableShape_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return EditableShape_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, EditableShape_typeof(obj);\n        }\n\n        function EditableShape_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function EditableShape_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function EditableShape_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) EditableShape_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) EditableShape_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function EditableShape_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) EditableShape_setPrototypeOf(subClass, superClass);\n        }\n\n        function EditableShape_setPrototypeOf(o, p) {\n          EditableShape_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return EditableShape_setPrototypeOf(o, p);\n        }\n\n        function EditableShape_createSuper(Derived) {\n          var hasNativeReflectConstruct = EditableShape_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = EditableShape_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = EditableShape_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return EditableShape_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function EditableShape_possibleConstructorReturn(self, call) {\n          if (call && (EditableShape_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return EditableShape_assertThisInitialized(self);\n        }\n\n        function EditableShape_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function EditableShape_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function EditableShape_getPrototypeOf(o) {\n          EditableShape_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return EditableShape_getPrototypeOf(o);\n        }\n\n        function EditableShape_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var EditableShape_IMPLEMENTATION_MISSING = \"An implementation is missing\";\n\n        var EditableShape = /*#__PURE__*/function (_ToolLike) {\n          EditableShape_inherits(EditableShape, _ToolLike);\n\n          var _super = EditableShape_createSuper(EditableShape);\n\n          function EditableShape(annotation, g, config, env) {\n            var _this;\n\n            EditableShape_classCallCheck(this, EditableShape);\n            _this = _super.call(this, g, config, env);\n            EditableShape_defineProperty(EditableShape_assertThisInitialized(_this), \"updateState\", function (annotation) {\n              throw new Error(EditableShape_IMPLEMENTATION_MISSING);\n            });\n            _this.annotation = annotation;\n            return _this;\n          }\n          /**\r\n           * Implementations MUST override this method!\r\n           * \r\n           * Must return the 'g' element with the a9s-annotation class.\r\n           */\n\n\n          EditableShape_createClass(EditableShape, [{\n            key: \"element\",\n            get: function get() {\n              throw new Error(EditableShape_IMPLEMENTATION_MISSING);\n            }\n            /**\r\n             * Implementations MUST override this method!\r\n             * \r\n             * The annotation argument MUST be used to update\r\n             * the current state of the shape. It MUST NOT\r\n             * be stored as 'this.annotation'! 'this.annotation'\r\n             * MUST remain the original annotation at the time\r\n             * this EditableShape was created, because we will\r\n             * need it again in case the user cancels editing.\r\n             * \r\n             * Thinking of it in React terms, 'this.annotation'\r\n             * has the same purpose as props.annotation, whereas\r\n             * this method affects state.\r\n             */\n\n          }]);\n          return EditableShape;\n        }(ToolLike);\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/selectors/RectFragment.js\n\n        function _slicedToArray(arr, i) {\n          return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n        }\n\n        function _nonIterableRest() {\n          throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }\n\n        function _unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n        }\n\n        function _arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n\n        function _iterableToArrayLimit(arr, i) {\n          var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n          if (_i == null) return;\n          var _arr = [];\n          var _n = true;\n          var _d = false;\n\n          var _s, _e;\n\n          try {\n            for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n              _arr.push(_s.value);\n\n              if (i && _arr.length === i) break;\n            }\n          } catch (err) {\n            _d = true;\n            _e = err;\n          } finally {\n            try {\n              if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n            } finally {\n              if (_d) throw _e;\n            }\n          }\n\n          return _arr;\n        }\n\n        function _arrayWithHoles(arr) {\n          if (Array.isArray(arr)) return arr;\n        }\n        /** \r\n         * Parses a W3C Web Annotation FragmentSelector conforming\r\n         * to the Media Fragments spec. Supports (well-formed) xywh=pixel\r\n         * and xywh=percent fragments. \r\n         */\n\n\n        var parseRectFragment = function parseRectFragment(annotation, image) {\n          var selector = annotation.selector('FragmentSelector');\n\n          if (selector !== null && selector !== void 0 && selector.conformsTo.startsWith('http://www.w3.org/TR/media-frags')) {\n            var value = selector.value;\n            var format = value.includes(':') ? value.substring(value.indexOf('=') + 1, value.indexOf(':')) : 'pixel';\n            var coords = value.includes(':') ? value.substring(value.indexOf(':') + 1) : value.substring(value.indexOf('=') + 1);\n\n            var _coords$split$map = coords.split(',').map(parseFloat),\n                _coords$split$map2 = _slicedToArray(_coords$split$map, 4),\n                x = _coords$split$map2[0],\n                y = _coords$split$map2[1],\n                w = _coords$split$map2[2],\n                h = _coords$split$map2[3];\n\n            if (format.toLowerCase() === 'percent') {\n              x = x * image.naturalWidth / 100;\n              y = y * image.naturalHeight / 100;\n              w = w * image.naturalWidth / 100;\n              h = h * image.naturalHeight / 100;\n            }\n\n            return {\n              x: x,\n              y: y,\n              w: w,\n              h: h\n            };\n          }\n        };\n        /** \r\n         * Serializes a (x, y, w, h)-tuple as Media Fragment selector\r\n         * using pixel coordinates.\r\n         */\n\n\n        var toPixelRectFragment = function toPixelRectFragment(x, y, w, h, image) {\n          return {\n            source: image === null || image === void 0 ? void 0 : image.src,\n            selector: {\n              type: \"FragmentSelector\",\n              conformsTo: \"http://www.w3.org/TR/media-frags/\",\n              value: \"xywh=pixel:\".concat(x, \",\").concat(y, \",\").concat(w, \",\").concat(h)\n            }\n          };\n        };\n        /** \r\n         * Serializes a (x, y, w, h)-tuple as Media Fragment selector \r\n         * using percent coordinates.\r\n         */\n\n\n        var toPercentRectFragment = function toPercentRectFragment(x, y, w, h, image) {\n          var px = x / image.naturalWidth * 100;\n          var py = y / image.naturalHeight * 100;\n          var pw = w / image.naturalWidth * 100;\n          var ph = h / image.naturalHeight * 100;\n          return {\n            source: image.src,\n            selector: {\n              type: \"FragmentSelector\",\n              conformsTo: \"http://www.w3.org/TR/media-frags/\",\n              value: \"xywh=percent:\".concat(px, \",\").concat(py, \",\").concat(pw, \",\").concat(ph)\n            }\n          };\n        };\n\n        var toRectFragment = function toRectFragment(x, y, w, h, image, fragmentUnit) {\n          return (fragmentUnit === null || fragmentUnit === void 0 ? void 0 : fragmentUnit.toLowerCase()) === 'percent' ? toPercentRectFragment(x, y, w, h, image) : toPixelRectFragment(x, y, w, h, image);\n        };\n        /** Shorthand to apply the given (x, y, w, h) to the SVG shape **/\n\n\n        var setXYWH = function setXYWH(shape, x, y, w, h) {\n          shape.setAttribute('x', x);\n          shape.setAttribute('y', y);\n          shape.setAttribute('width', w);\n          shape.setAttribute('height', h);\n        };\n\n        var setPointXY = function setPointXY(shape, x, y) {\n          shape.setAttribute('cx', x);\n          shape.setAttribute('cy', y);\n          shape.setAttribute('r', 7); // TODO make configurable\n        };\n\n        var drawRectMask = function drawRectMask(imageDimensions, x, y, w, h) {\n          var mask = document.createElementNS(SVG_NAMESPACE, 'path');\n          mask.setAttribute('fill-rule', 'evenodd');\n          var naturalWidth = imageDimensions.naturalWidth,\n              naturalHeight = imageDimensions.naturalHeight;\n          mask.setAttribute('d', \"M0 0 h\".concat(naturalWidth, \" v\").concat(naturalHeight, \" h-\").concat(naturalWidth, \" z M\").concat(x, \" \").concat(y, \" h\").concat(w, \" v\").concat(h, \" h-\").concat(w, \" z\"));\n          return mask;\n        };\n\n        var setRectMaskSize = function setRectMaskSize(mask, imageDimensions, x, y, w, h) {\n          var naturalWidth = imageDimensions.naturalWidth,\n              naturalHeight = imageDimensions.naturalHeight;\n          mask.setAttribute('d', \"M0 0 h\".concat(naturalWidth, \" v\").concat(naturalHeight, \" h-\").concat(naturalWidth, \" z M\").concat(x, \" \").concat(y, \" h\").concat(w, \" v\").concat(h, \" h-\").concat(w, \" z\"));\n        };\n        /** \r\n         * Draws an SVG rectangle, either from an annotation, or an\r\n         * (x, y, w, h)-tuple.\r\n         */\n\n\n        var drawRect = function drawRect(arg1, arg2, arg3, arg4) {\n          var _ref = arg1.type === 'Annotation' || arg1.type === 'Selection' ? parseRectFragment(arg1, arg2) : {\n            x: arg1,\n            y: arg2,\n            w: arg3,\n            h: arg4\n          },\n              x = _ref.x,\n              y = _ref.y,\n              w = _ref.w,\n              h = _ref.h;\n\n          var g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n          if (w === 0 && h === 0) {\n            // Edge case: rect is actually a point\n            addClass(g, 'a9s-point');\n            addClass(g, 'a9s-non-scaling');\n            g.setAttribute('transform-origin', \"\".concat(x, \" \").concat(y));\n            var outerPoint = document.createElementNS(SVG_NAMESPACE, 'circle');\n            var innerPoint = document.createElementNS(SVG_NAMESPACE, 'circle');\n            innerPoint.setAttribute('class', 'a9s-inner');\n            setPointXY(innerPoint, x, y);\n            outerPoint.setAttribute('class', 'a9s-outer');\n            setPointXY(outerPoint, x, y);\n            g.appendChild(outerPoint);\n            g.appendChild(innerPoint);\n          } else {\n            var outerRect = document.createElementNS(SVG_NAMESPACE, 'rect');\n            var innerRect = document.createElementNS(SVG_NAMESPACE, 'rect');\n            innerRect.setAttribute('class', 'a9s-inner');\n            setXYWH(innerRect, x, y, w, h);\n            outerRect.setAttribute('class', 'a9s-outer');\n            setXYWH(outerRect, x, y, w, h);\n            g.appendChild(outerRect);\n            g.appendChild(innerRect);\n          }\n\n          return g;\n        };\n        /** Gets the (x, y, w, h)-values from the attributes of the SVG group **/\n\n\n        var getRectSize = function getRectSize(g) {\n          var outer = g.querySelector('.a9s-outer');\n\n          if (outer.nodeName === 'rect') {\n            var x = parseFloat(outer.getAttribute('x'));\n            var y = parseFloat(outer.getAttribute('y'));\n            var w = parseFloat(outer.getAttribute('width'));\n            var h = parseFloat(outer.getAttribute('height'));\n            return {\n              x: x,\n              y: y,\n              w: w,\n              h: h\n            };\n          } else {\n            var _x = parseFloat(outer.getAttribute('cx'));\n\n            var _y = parseFloat(outer.getAttribute('cy'));\n\n            return {\n              x: _x,\n              y: _y,\n              w: 0,\n              h: 0\n            };\n          }\n        };\n        /** Applies the (x, y, w, h)-values to the rects in the SVG group **/\n\n\n        var setRectSize = function setRectSize(g, x, y, w, h) {\n          var inner = g.querySelector('.a9s-inner');\n          var outer = g.querySelector('.a9s-outer');\n\n          if (outer.nodeName === 'rect') {\n            setXYWH(inner, x, y, w, h);\n            setXYWH(outer, x, y, w, h);\n          } else {\n            setPointXY(inner, x, y);\n            setPointXY(outer, x, y);\n          }\n        };\n        /** \r\n         * Shorthand to get the area (rectangle w x h) from the \r\n         * annotation's fragment selector. \r\n         */\n\n\n        var rectArea = function rectArea(annotation, image) {\n          var _parseRectFragment = parseRectFragment(annotation, image),\n              w = _parseRectFragment.w,\n              h = _parseRectFragment.h;\n\n          return w * h;\n        };\n\n        ; // CONCATENATED MODULE: ./src/point/Point.js\n\n        function Point_ownKeys(object, enumerableOnly) {\n          var keys = Object.keys(object);\n\n          if (Object.getOwnPropertySymbols) {\n            var symbols = Object.getOwnPropertySymbols(object);\n            enumerableOnly && (symbols = symbols.filter(function (sym) {\n              return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n            })), keys.push.apply(keys, symbols);\n          }\n\n          return keys;\n        }\n\n        function Point_objectSpread(target) {\n          for (var i = 1; i < arguments.length; i++) {\n            var source = null != arguments[i] ? arguments[i] : {};\n            i % 2 ? Point_ownKeys(Object(source), !0).forEach(function (key) {\n              Point_defineProperty(target, key, source[key]);\n            }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : Point_ownKeys(Object(source)).forEach(function (key) {\n              Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n            });\n          }\n\n          return target;\n        }\n\n        function Point_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var isPoint = function isPoint(annotation) {\n          var _annotation$target$re;\n\n          return ((_annotation$target$re = annotation.target.renderedVia) === null || _annotation$target$re === void 0 ? void 0 : _annotation$target$re.name) === 'point';\n        };\n\n        var toFragment = function toFragment(x, y, image, fragmentUnit) {\n          return Point_objectSpread(Point_objectSpread({}, toRectFragment(x, y, 0, 0, image, fragmentUnit)), {}, {\n            renderedVia: {\n              name: 'point'\n            }\n          });\n        };\n\n        ; // CONCATENATED MODULE: ./src/point/EditablePoint.js\n\n        function EditablePoint_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return EditablePoint_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, EditablePoint_typeof(obj);\n        }\n\n        function EditablePoint_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function EditablePoint_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function EditablePoint_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) EditablePoint_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) EditablePoint_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function _get() {\n          if (typeof Reflect !== \"undefined\" && Reflect.get) {\n            _get = Reflect.get.bind();\n          } else {\n            _get = function _get(target, property, receiver) {\n              var base = _superPropBase(target, property);\n\n              if (!base) return;\n              var desc = Object.getOwnPropertyDescriptor(base, property);\n\n              if (desc.get) {\n                return desc.get.call(arguments.length < 3 ? target : receiver);\n              }\n\n              return desc.value;\n            };\n          }\n\n          return _get.apply(this, arguments);\n        }\n\n        function _superPropBase(object, property) {\n          while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = EditablePoint_getPrototypeOf(object);\n            if (object === null) break;\n          }\n\n          return object;\n        }\n\n        function EditablePoint_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) EditablePoint_setPrototypeOf(subClass, superClass);\n        }\n\n        function EditablePoint_setPrototypeOf(o, p) {\n          EditablePoint_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return EditablePoint_setPrototypeOf(o, p);\n        }\n\n        function EditablePoint_createSuper(Derived) {\n          var hasNativeReflectConstruct = EditablePoint_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = EditablePoint_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = EditablePoint_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return EditablePoint_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function EditablePoint_possibleConstructorReturn(self, call) {\n          if (call && (EditablePoint_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return EditablePoint_assertThisInitialized(self);\n        }\n\n        function EditablePoint_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function EditablePoint_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function EditablePoint_getPrototypeOf(o) {\n          EditablePoint_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return EditablePoint_getPrototypeOf(o);\n        }\n\n        function EditablePoint_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var EditablePoint = /*#__PURE__*/function (_EditableShape) {\n          EditablePoint_inherits(EditablePoint, _EditableShape);\n\n          var _super = EditablePoint_createSuper(EditablePoint);\n\n          function EditablePoint(_annotation, g, config, env) {\n            var _this;\n\n            EditablePoint_classCallCheck(this, EditablePoint);\n            _this = _super.call(this, _annotation, g, config, env);\n            EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"onScaleChanged\", function () {\n              return _this.scaleHandle(_this.point);\n            });\n            EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"onGrab\", function () {\n              _this.isGrabbed = true;\n            });\n            EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\n              if (evt.button !== 0) return; // left click\n\n              if (_this.isGrabbed) {\n                var _this$getSVGPoint = _this.getSVGPoint(evt),\n                    x = _this$getSVGPoint.x,\n                    y = _this$getSVGPoint.y;\n\n                _this.setHandleXY(_this.point, x, y);\n\n                var target = toFragment(x, y, _this.env.image, _this.config.fragmentUnit);\n\n                _this.emit('update', target);\n              }\n            });\n            EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"onMouseUp\", function () {\n              _this.isGrabbed = false;\n            });\n            EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"updateState\", function (annotation) {\n              var _parseRectFragment = parseRectFragment(annotation, _this.env.image),\n                  x = _parseRectFragment.x,\n                  y = _parseRectFragment.y;\n\n              _this.setHandleXY(_this.point, x, y);\n            });\n\n            _this.svg.addEventListener('mousemove', _this.onMouseMove);\n\n            _this.svg.addEventListener('mouseup', _this.onMouseUp);\n\n            var _parseRectFragment2 = parseRectFragment(_annotation, env.image),\n                _x = _parseRectFragment2.x,\n                _y = _parseRectFragment2.y;\n\n            _this.container = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n\n            _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n\n            _this.point = _this.drawHandle(_x, _y);\n\n            _this.point.addEventListener('mousedown', _this.onGrab);\n\n            _this.elementGroup.appendChild(_this.point);\n\n            _this.container.appendChild(_this.elementGroup);\n\n            g.appendChild(_this.container); // true if te mouse has grabbed the point\n\n            _this.isGrabbed = false;\n            return _this;\n          }\n\n          EditablePoint_createClass(EditablePoint, [{\n            key: \"element\",\n            get: function get() {\n              return this.elementGroup;\n            }\n          }, {\n            key: \"destroy\",\n            value: function destroy() {\n              this.svg.removeEventListener('mousemove', this.onMouseMove);\n              this.svg.removeEventListener('mouseup', this.onMouseUp);\n              this.container.parentNode.removeChild(this.container);\n\n              _get(EditablePoint_getPrototypeOf(EditablePoint.prototype), \"destroy\", this).call(this);\n            }\n          }]);\n          return EditablePoint;\n        }(EditableShape);\n\n        ; // CONCATENATED MODULE: ./src/point/PointTool.js\n\n        function PointTool_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return PointTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, PointTool_typeof(obj);\n        }\n\n        function PointTool_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function PointTool_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function PointTool_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) PointTool_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) PointTool_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function PointTool_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) PointTool_setPrototypeOf(subClass, superClass);\n        }\n\n        function PointTool_setPrototypeOf(o, p) {\n          PointTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return PointTool_setPrototypeOf(o, p);\n        }\n\n        function PointTool_createSuper(Derived) {\n          var hasNativeReflectConstruct = PointTool_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = PointTool_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = PointTool_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return PointTool_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function PointTool_possibleConstructorReturn(self, call) {\n          if (call && (PointTool_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return PointTool_assertThisInitialized(self);\n        }\n\n        function PointTool_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function PointTool_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function PointTool_getPrototypeOf(o) {\n          PointTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return PointTool_getPrototypeOf(o);\n        }\n\n        function PointTool_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var PointTool = /*#__PURE__*/function (_Tool) {\n          PointTool_inherits(PointTool, _Tool);\n\n          var _super = PointTool_createSuper(PointTool);\n\n          function PointTool(g, config, env) {\n            var _this;\n\n            PointTool_classCallCheck(this, PointTool);\n            _this = _super.call(this, g, config, env);\n            PointTool_defineProperty(PointTool_assertThisInitialized(_this), \"startDrawing\", function (x, y, _, evt) {\n              var _evt$target$closest; // The top-most existing annotation at this position (if any) \n\n\n              var annotation = (_evt$target$closest = evt.target.closest('.a9s-annotation')) === null || _evt$target$closest === void 0 ? void 0 : _evt$target$closest.annotation; // The point drawing tool will ALWAYS create a point annotation,\n              // regardless of whether there's already an annotation underneath.\n              // UNLESS the annotation underneath is itself a point!\n\n              if (!annotation || !isPoint(annotation)) {\n                var element = _this.drawHandle(x, y);\n\n                _this.scaleHandle(element);\n\n                _this.g.appendChild(element);\n\n                element.annotation = new Selection(toFragment(x, y, _this.env.image, _this.config.fragmentUnit));\n\n                _this.emit('complete', element);\n              } else {\n                _this.emit('cancel');\n              }\n            });\n            PointTool_defineProperty(PointTool_assertThisInitialized(_this), \"stop\", function () {// Nothing to do\n            });\n            PointTool_defineProperty(PointTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\n              return new EditablePoint(annotation, _this.g, _this.config, _this.env);\n            });\n            return _this;\n          }\n\n          PointTool_createClass(PointTool, [{\n            key: \"isDrawing\",\n            get: function get() {\n              // Point selection is an instant action - the\n              // tool is never an 'drawing' state\n              return false;\n            }\n          }]);\n          return PointTool;\n        }(Tool);\n\n        PointTool.identifier = 'point';\n\n        PointTool.supports = function (annotation) {\n          // Not needed, since the target.renderedVia property will be evaluated first\n          return false;\n        };\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/selectors/EmbeddedSVG.js\n\n        function _createForOfIteratorHelper(o, allowArrayLike) {\n          var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n          if (!it) {\n            if (Array.isArray(o) || (it = EmbeddedSVG_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n              if (it) o = it;\n              var i = 0;\n\n              var F = function F() {};\n\n              return {\n                s: F,\n                n: function n() {\n                  if (i >= o.length) return {\n                    done: true\n                  };\n                  return {\n                    done: false,\n                    value: o[i++]\n                  };\n                },\n                e: function e(_e) {\n                  throw _e;\n                },\n                f: F\n              };\n            }\n\n            throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n          }\n\n          var normalCompletion = true,\n              didErr = false,\n              err;\n          return {\n            s: function s() {\n              it = it.call(o);\n            },\n            n: function n() {\n              var step = it.next();\n              normalCompletion = step.done;\n              return step;\n            },\n            e: function e(_e2) {\n              didErr = true;\n              err = _e2;\n            },\n            f: function f() {\n              try {\n                if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n              } finally {\n                if (didErr) throw err;\n              }\n            }\n          };\n        }\n\n        function EmbeddedSVG_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return EmbeddedSVG_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EmbeddedSVG_arrayLikeToArray(o, minLen);\n        }\n\n        function EmbeddedSVG_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n        /** Helper that forces an un-namespaced node to SVG **/\n\n\n        var insertSVGNamespace = function insertSVGNamespace(originalDoc) {\n          // Serialize and parse for the namespace to take effect on every node\n          var serializer = new XMLSerializer();\n          var str = serializer.serializeToString(originalDoc.documentElement); // Doesn't seem that there's a clean cross-browser way for this...\n\n          var namespaced = str.replace('<svg>', \"<svg xmlns=\\\"\".concat(SVG_SVG_NAMESPACE, \"\\\">\"));\n          var parser = new DOMParser();\n          var namespacedDoc = parser.parseFromString(namespaced, \"image/svg+xml\");\n          return namespacedDoc.documentElement;\n        };\n\n        var sanitize = function sanitize(doc) {\n          // Cf. https://github.com/mattkrick/sanitize-svg#readme  \n          // for the basic approach\n          var cleanEl = function cleanEl(el) {\n            Array.from(el.attributes).forEach(function (attr) {\n              if (attr.name.startsWith('on')) el.removeAttribute(attr.name);\n            });\n          }; // Remove script tags\n\n\n          var scripts = doc.getElementsByTagName('script');\n          Array.from(scripts).reverse().forEach(function (el) {\n            return el.parentNode.removeChild(el);\n          }); // Remove on... attributes\n\n          cleanEl(doc);\n          Array.from(doc.querySelectorAll('*')).forEach(cleanEl);\n          return doc;\n        };\n\n        var svgFragmentToShape = function svgFragmentToShape(annotation) {\n          var selector = annotation.selector('SvgSelector');\n\n          if (selector) {\n            var parser = new DOMParser(); // Parse the XML document, assuming SVG\n\n            var value = selector.value;\n            var doc = parser.parseFromString(value, \"image/svg+xml\"); // SVG needs a namespace declaration - check if it's set or insert if not\n\n            var isPrefixDeclared = doc.lookupPrefix(SVG_SVG_NAMESPACE); // SVG declared via prefix\n\n            var isDefaultNamespaceSVG = doc.lookupNamespaceURI(null); // SVG declared as default namespace\n\n            if (isPrefixDeclared || isDefaultNamespaceSVG) {\n              return sanitize(doc).firstChild;\n            } else {\n              return sanitize(insertSVGNamespace(doc)).firstChild;\n            }\n          }\n        };\n\n        var drawEmbeddedSVG = function drawEmbeddedSVG(annotation) {\n          var shape = svgFragmentToShape(annotation); // Because we're nitpicky, we don't just draw the shape,\n          // but duplicate it, so we can have inner and an outer lines\n\n          var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n          var inner = shape.cloneNode(true);\n          inner.setAttribute('class', 'a9s-inner');\n          var outer = shape.cloneNode(true);\n          outer.setAttribute('class', 'a9s-outer');\n          g.appendChild(outer);\n          g.appendChild(inner);\n          return g;\n        };\n\n        var toSVGTarget = function toSVGTarget(shape, image) {\n          var inner = shape.querySelector('.a9s-inner').cloneNode(true);\n          inner.removeAttribute('class');\n          inner.removeAttribute('xmlns');\n          var serialized = inner.outerHTML || new XMLSerializer().serializeToString(inner);\n          serialized = serialized.replace(\" xmlns=\\\"\".concat(SVG_SVG_NAMESPACE, \"\\\"\"), '');\n          return {\n            source: image === null || image === void 0 ? void 0 : image.src,\n            selector: {\n              type: \"SvgSelector\",\n              value: \"<svg>\".concat(serialized, \"</svg>\")\n            }\n          };\n        };\n\n        var svgArea = function svgArea(annotation) {\n          var shape = svgFragmentToShape(annotation);\n          var nodeName = shape.nodeName.toLowerCase();\n          if (nodeName === 'polygon') return svgPolygonArea(shape);else if (nodeName === 'circle') return svgCircleArea(shape);else if (nodeName === 'ellipse') return svgEllipseArea(shape);else if (nodeName == 'path') return svgPathArea(shape);else if (nodeName == 'line') return 0;else throw \"Unsupported SVG shape type: \".concat(nodeName);\n        };\n\n        var svgPolygonArea = function svgPolygonArea(polygon) {\n          var points = polygon.getAttribute('points').trim().split(' ') // Split x/y tuples\n          .map(function (xy) {\n            return xy.split(',').map(function (str) {\n              return parseFloat(str.trim());\n            });\n          });\n          return polygonArea(points);\n        };\n\n        var svgCircleArea = function svgCircleArea(circle) {\n          var r = circle.getAttribute('r');\n          return r * r * Math.PI;\n        };\n\n        var svgEllipseArea = function svgEllipseArea(ellipse) {\n          var rx = ellipse.getAttribute('rx');\n          var ry = ellipse.getAttribute('ry');\n          return rx * ry * Math.PI;\n        };\n\n        var svgPathArea = function svgPathArea(path) {\n          var polygons = svgPathToPolygons(path);\n\n          if (polygons.length == 1) {\n            return polygonArea(polygons[0]);\n          } else {\n            // Helper to check if a polygon is a hole\n            var isHole = function isHole(p) {\n              return polygons.find(function (other) {\n                if (p !== other) return polygonInPolygon(p, other);\n              });\n            };\n\n            var area = 0;\n\n            var _iterator = _createForOfIteratorHelper(polygons),\n                _step;\n\n            try {\n              for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                var poly = _step.value;\n                if (isHole(poly)) area -= polygonArea(poly);else area += polygonArea(poly);\n              }\n            } catch (err) {\n              _iterator.e(err);\n            } finally {\n              _iterator.f();\n            }\n\n            return area;\n          }\n        };\n\n        ; // CONCATENATED MODULE: ./src/circle/Circle.js\n\n        /** Shorthand to apply the given (x, y, r) to the SVG shape **/\n\n        var setXYR = function setXYR(shape, x, y, r) {\n          shape.setAttribute('cx', x);\n          shape.setAttribute('cy', y);\n          shape.setAttribute('r', r);\n        };\n        /** \r\n         * Draws an SVG circle, either from an annotation, or an\r\n         * (cx, cy, r)-tuple.\r\n         */\n\n\n        var drawCircle = function drawCircle(cx, cy, r) {\n          var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n          var outerCircle = document.createElementNS(SVG_SVG_NAMESPACE, 'circle');\n          var innerCircle = document.createElementNS(SVG_SVG_NAMESPACE, 'circle');\n          innerCircle.setAttribute('class', 'a9s-inner');\n          setXYR(innerCircle, cx, cy, r);\n          outerCircle.setAttribute('class', 'a9s-outer');\n          setXYR(outerCircle, cx, cy, r);\n          g.appendChild(outerCircle);\n          g.appendChild(innerCircle);\n          return g;\n        };\n\n        var setCircleSize = function setCircleSize(g, cx, cy, r) {\n          var innerCircle = g.querySelector('.a9s-inner');\n          var outerCircle = g.querySelector('.a9s-outer');\n          setXYR(innerCircle, cx, cy, r);\n          setXYR(outerCircle, cx, cy, r);\n        };\n\n        var getCircleSize = function getCircleSize(g) {\n          var outerCircle = g.querySelector('.a9s-outer');\n          var cx = parseFloat(outerCircle.getAttribute('cx'));\n          var cy = parseFloat(outerCircle.getAttribute('cy'));\n          var r = parseFloat(outerCircle.getAttribute('r'));\n          return {\n            cx: cx,\n            cy: cy,\n            r: r\n          };\n        };\n\n        ; // CONCATENATED MODULE: ./src/circle/CircleMask.js\n\n        function CircleMask_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function CircleMask_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function CircleMask_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) CircleMask_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) CircleMask_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function CircleMask_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var CircleMask = /*#__PURE__*/function () {\n          function CircleMask(imageDimensions, circle) {\n            var _this = this;\n\n            CircleMask_classCallCheck(this, CircleMask);\n            CircleMask_defineProperty(this, \"redraw\", function () {\n              var _getCircleSize = getCircleSize(_this.circle),\n                  cx = _getCircleSize.cx,\n                  cy = _getCircleSize.cy,\n                  r = _getCircleSize.r;\n\n              var tx = cx + r > _this.w ? _this.w - r : cx;\n              var ty = cy + r > _this.h ? _this.h - r : cy + r;\n\n              _this.mask.setAttribute('d', \"M0 0 h\".concat(_this.w, \" v\").concat(_this.h, \" h-\").concat(_this.w, \" z M\").concat(tx, \" \").concat(ty, \" a \").concat(r, \" \").concat(r, \" 0 1 1 1 0\"));\n            });\n            CircleMask_defineProperty(this, \"destroy\", function () {\n              return _this.mask.parentNode.removeChild(_this.mask);\n            });\n            this.w = imageDimensions.naturalWidth;\n            this.h = imageDimensions.naturalHeight;\n            this.circle = circle;\n\n            var _getCircleSize2 = getCircleSize(this.circle),\n                _cx = _getCircleSize2.cx,\n                _cy = _getCircleSize2.cy,\n                _r = _getCircleSize2.r;\n\n            var _tx = _cx + _r > this.w ? this.w - _r : _cx;\n\n            var _ty = _cy + _r > this.h ? this.h - _r : _cy + _r;\n\n            this.mask = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\n            this.mask.setAttribute('fill-rule', 'evenodd');\n            this.mask.setAttribute('class', 'a9s-selection-mask');\n            this.mask.setAttribute('d', \"M0 0 h\".concat(this.w, \" v\").concat(this.h, \" h-\").concat(this.w, \" z M\").concat(_tx, \" \").concat(_ty, \" a \").concat(_r, \" \").concat(_r, \" 0 1 1 1 0\"));\n          }\n\n          CircleMask_createClass(CircleMask, [{\n            key: \"element\",\n            get: function get() {\n              return this.mask;\n            }\n          }]);\n          return CircleMask;\n        }();\n\n        ; // CONCATENATED MODULE: ./src/circle/RubberbandCircle.js\n\n        function RubberbandCircle_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandCircle_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandCircle_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandCircle_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandCircle_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandCircle_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * A 'rubberband' selection tool for creating a circle by\r\n         * clicking and dragging.\r\n         */\n\n\n        var RubberbandCircle = /*#__PURE__*/function () {\n          function RubberbandCircle(anchorX, anchorY, g, env) {\n            var _this = this;\n\n            RubberbandCircle_classCallCheck(this, RubberbandCircle);\n            RubberbandCircle_defineProperty(this, \"dragTo\", function (oppositeX, oppositeY) {\n              var _this$env$image = _this.env.image,\n                  naturalWidth = _this$env$image.naturalWidth,\n                  naturalHeight = _this$env$image.naturalHeight; // Make visible\n\n              _this.group.style.display = null;\n              var w = oppositeX - _this.anchor[0];\n              var h = oppositeY - _this.anchor[1];\n              var r = Math.max(1, Math.pow(Math.pow(w, 2) + Math.pow(h, 2), 0.5) / 2);\n              var cx = _this.anchor[0] + w / 2;\n              var cy = _this.anchor[1] + h / 2;\n              if (cx - r < 0 || cx + r > naturalWidth || cy - r < 0 || cy + r > naturalHeight) return;\n              setCircleSize(_this.circle, cx, cy, r);\n\n              _this.mask.redraw();\n            });\n            RubberbandCircle_defineProperty(this, \"getBoundingClientRect\", function () {\n              return _this.circle.getBoundingClientRect();\n            });\n            RubberbandCircle_defineProperty(this, \"toSelection\", function () {\n              return new Selection(toSVGTarget(_this.group, _this.env.image));\n            });\n            RubberbandCircle_defineProperty(this, \"destroy\", function () {\n              _this.group.parentNode.removeChild(_this.group);\n\n              _this.mask = null;\n              _this.circle = null;\n              _this.group = null;\n            });\n            this.anchor = [anchorX, anchorY];\n            this.env = env;\n            this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            this.circle = drawCircle(anchorX, anchorY, 2);\n            this.circle.setAttribute('class', 'a9s-selection');\n            this.mask = new CircleMask(env.image, this.circle); // We make the selection transparent to \n            // pointer events because it would interfere with the \n            // rendered annotations' mouseleave/enter events\n\n            this.group.style.pointerEvents = 'none'; // Additionally, selection remains hidden until \n            // the user actually moves the mouse\n\n            this.group.style.display = 'none';\n            this.group.appendChild(this.mask.element);\n            this.group.appendChild(this.circle);\n            g.appendChild(this.group);\n          }\n\n          RubberbandCircle_createClass(RubberbandCircle, [{\n            key: \"element\",\n            get: function get() {\n              return this.circle;\n            }\n          }]);\n          return RubberbandCircle;\n        }();\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/util/Formatting.js\n\n        function _toConsumableArray(arr) {\n          return _arrayWithoutHoles(arr) || _iterableToArray(arr) || Formatting_unsupportedIterableToArray(arr) || _nonIterableSpread();\n        }\n\n        function _nonIterableSpread() {\n          throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }\n\n        function Formatting_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return Formatting_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Formatting_arrayLikeToArray(o, minLen);\n        }\n\n        function _iterableToArray(iter) {\n          if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n        }\n\n        function _arrayWithoutHoles(arr) {\n          if (Array.isArray(arr)) return Formatting_arrayLikeToArray(arr);\n        }\n\n        function Formatting_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n\n        var isFirefox = /firefox/i.test(navigator.userAgent);\n\n        var formatSvgEl = function formatSvgEl(svgEl, x, y, w, h) {\n          svgEl.setAttribute('width', w);\n          svgEl.setAttribute('height', h); // Argh - Firefox produces broken SVG bounds for nested SVG\n\n          if (isFirefox) {\n            svgEl.setAttribute('x', 0);\n            svgEl.setAttribute('y', 0);\n            svgEl.setAttribute('transform', \"translate(\".concat(x, \", \").concat(y, \")\"));\n          } else {\n            svgEl.setAttribute('x', x);\n            svgEl.setAttribute('y', y);\n          }\n        };\n\n        var appendFormatterEl = function appendFormatterEl(formatterEl, shape) {\n          var _shape$getBBox = shape.getBBox(),\n              x = _shape$getBBox.x,\n              y = _shape$getBBox.y,\n              width = _shape$getBBox.width,\n              height = _shape$getBBox.height;\n\n          var svgEl = document.createElementNS(SVG_SVG_NAMESPACE, 'svg');\n          svgEl.setAttribute('class', 'a9s-formatter-el');\n          formatSvgEl(svgEl, x, y, width, height);\n          var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n          g.appendChild(formatterEl);\n          y;\n          svgEl.appendChild(g);\n          shape.append(svgEl);\n        };\n        /**\r\n         * A formatter is a user-defined function that takes an annotation as input,\r\n         * and returns either a string, or an object. If a string is returned, this\r\n         * will be appended to the annotation element CSS class list. Otherwise, the\r\n         * object can have the following properties: \r\n         * \r\n         * - 'className' added to the CSS class list\r\n         * - 'data-*' added as data attributes\r\n         * - 'style' a list of CSS styles (in the form of a string) \r\n         */\n\n\n        var format = function format(shape, annotation, formatters) {\n          // The formatter can be undefined\n          if (!formatters) return shape; // Merge outputs from all formatter functions into one object\n\n          var format = formatters.reduce(function (merged, fn) {\n            var format = fn(annotation);\n            if (!format) return merged;\n\n            if (typeof format === 'string' || format instanceof String) {\n              merged.className = merged.className ? \"\".concat(merged.className, \" \").concat(format) : format;\n            } else if (format.nodeType === Node.ELEMENT_NODE) {\n              merged.elements = merged.elements ? [].concat(_toConsumableArray(merged.elements), [format]) : [format];\n            } else {\n              var _className = format.className,\n                  _style = format.style,\n                  element = format.element;\n              if (_className) merged.className = merged.className ? \"\".concat(merged.className, \" \").concat(_className) : _className;\n              if (_style) merged.style = merged.style ? \"\".concat(merged.style, \" \").concat(_style) : _style;\n              if (element) merged.elements = merged.elements ? [].concat(_toConsumableArray(merged.elements), [element]) : [element];\n            } // Copy data attributes\n\n\n            for (var key in format) {\n              if (format.hasOwnProperty(key) && key.startsWith('data-')) {\n                merged[key] = format[key];\n              }\n            }\n\n            return merged;\n          }, {});\n          var className = format.className,\n              style = format.style,\n              elements = format.elements;\n          if (className) SVG_addClass(shape, className);\n\n          if (style) {\n            var outer = shape.querySelector('.a9s-outer');\n            var inner = shape.querySelector('.a9s-inner');\n\n            if (outer && inner) {\n              outer.setAttribute('style', 'display:none');\n              inner.setAttribute('style', style);\n            } else {\n              shape.setAttribute('style', style);\n            }\n          }\n\n          if (elements) elements.forEach(function (el) {\n            return appendFormatterEl(el, shape);\n          });\n\n          for (var key in format) {\n            if (format.hasOwnProperty(key) && key.startsWith('data-')) {\n              shape.setAttribute(key, format[key]);\n            }\n          }\n        };\n\n        var setFormatterElSize = function setFormatterElSize(group, x, y, w, h) {\n          var formatterEl = group.querySelector('.a9s-formatter-el');\n          if (formatterEl) formatSvgEl(formatterEl, x, y, w, h);\n        };\n\n        ; // CONCATENATED MODULE: ./src/circle/EditableCircle.js\n\n        function EditableCircle_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return EditableCircle_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, EditableCircle_typeof(obj);\n        }\n\n        function EditableCircle_slicedToArray(arr, i) {\n          return EditableCircle_arrayWithHoles(arr) || EditableCircle_iterableToArrayLimit(arr, i) || EditableCircle_unsupportedIterableToArray(arr, i) || EditableCircle_nonIterableRest();\n        }\n\n        function EditableCircle_nonIterableRest() {\n          throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }\n\n        function EditableCircle_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return EditableCircle_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EditableCircle_arrayLikeToArray(o, minLen);\n        }\n\n        function EditableCircle_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n\n        function EditableCircle_iterableToArrayLimit(arr, i) {\n          var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n          if (_i == null) return;\n          var _arr = [];\n          var _n = true;\n          var _d = false;\n\n          var _s, _e;\n\n          try {\n            for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n              _arr.push(_s.value);\n\n              if (i && _arr.length === i) break;\n            }\n          } catch (err) {\n            _d = true;\n            _e = err;\n          } finally {\n            try {\n              if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n            } finally {\n              if (_d) throw _e;\n            }\n          }\n\n          return _arr;\n        }\n\n        function EditableCircle_arrayWithHoles(arr) {\n          if (Array.isArray(arr)) return arr;\n        }\n\n        function EditableCircle_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function EditableCircle_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function EditableCircle_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) EditableCircle_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) EditableCircle_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function EditableCircle_get() {\n          if (typeof Reflect !== \"undefined\" && Reflect.get) {\n            EditableCircle_get = Reflect.get.bind();\n          } else {\n            EditableCircle_get = function _get(target, property, receiver) {\n              var base = EditableCircle_superPropBase(target, property);\n              if (!base) return;\n              var desc = Object.getOwnPropertyDescriptor(base, property);\n\n              if (desc.get) {\n                return desc.get.call(arguments.length < 3 ? target : receiver);\n              }\n\n              return desc.value;\n            };\n          }\n\n          return EditableCircle_get.apply(this, arguments);\n        }\n\n        function EditableCircle_superPropBase(object, property) {\n          while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = EditableCircle_getPrototypeOf(object);\n            if (object === null) break;\n          }\n\n          return object;\n        }\n\n        function EditableCircle_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) EditableCircle_setPrototypeOf(subClass, superClass);\n        }\n\n        function EditableCircle_setPrototypeOf(o, p) {\n          EditableCircle_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return EditableCircle_setPrototypeOf(o, p);\n        }\n\n        function EditableCircle_createSuper(Derived) {\n          var hasNativeReflectConstruct = EditableCircle_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = EditableCircle_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = EditableCircle_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return EditableCircle_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function EditableCircle_possibleConstructorReturn(self, call) {\n          if (call && (EditableCircle_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return EditableCircle_assertThisInitialized(self);\n        }\n\n        function EditableCircle_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function EditableCircle_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function EditableCircle_getPrototypeOf(o) {\n          EditableCircle_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return EditableCircle_getPrototypeOf(o);\n        }\n\n        function EditableCircle_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * An editable circle shape.\r\n         */\n\n\n        var EditableCircle = /*#__PURE__*/function (_EditableShape) {\n          EditableCircle_inherits(EditableCircle, _EditableShape);\n\n          var _super = EditableCircle_createSuper(EditableCircle);\n\n          function EditableCircle(_annotation, g, config, env) {\n            var _this;\n\n            EditableCircle_classCallCheck(this, EditableCircle);\n            _this = _super.call(this, _annotation, g, config, env);\n            EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"setSize\", function (cx, cy, r) {\n              setCircleSize(_this.circle, cx, cy, r);\n\n              _this.mask.redraw();\n\n              setFormatterElSize(_this.elementGroup, cx, cy, r, r);\n\n              var _this$handles = EditableCircle_slicedToArray(_this.handles, 4),\n                  topleft = _this$handles[0],\n                  topright = _this$handles[1],\n                  bottomright = _this$handles[2],\n                  bottomleft = _this$handles[3];\n\n              _this.setHandleXY(topleft, cx, cy - r);\n\n              _this.setHandleXY(topright, cx + r, cy);\n\n              _this.setHandleXY(bottomright, cx, cy + r);\n\n              _this.setHandleXY(bottomleft, cx - r, cy);\n            });\n            EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"stretchCorners\", function (draggedHandleIdx, anchorHandle, mousePos) {\n              var anchor = _this.getHandleXY(anchorHandle);\n\n              var mouseX = mousePos.x;\n              var mouseY = mousePos.y;\n              var width = 0;\n              var height = 0;\n              var r;\n\n              if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n                mouseX = anchor.x;\n                height = mouseY - anchor.y;\n                r = Math.abs(height) / 2;\n              } else {\n                mouseY = anchor.y;\n                width = mouseX - anchor.x;\n                r = Math.abs(width) / 2;\n              }\n\n              var x = width > 0 ? anchor.x : mouseX;\n              var y = height > 0 ? anchor.y : mouseY;\n              var w = Math.abs(width);\n              var h = Math.abs(height);\n              var cx = x + w / 2;\n              var cy = y + h / 2;\n              setCircleSize(_this.circle, cx, cy, r);\n\n              _this.mask.redraw();\n\n              setFormatterElSize(_this.elementGroup, cx, cy, r, r);\n\n              if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n                var idx0 = 0;\n                var idx2 = 2;\n\n                if (draggedHandleIdx == 0 && height > 0 || draggedHandleIdx == 2 && height < 0) {\n                  idx0 = 2;\n                  idx2 = 0;\n                }\n\n                _this.setHandleXY(_this.handles[idx0], cx, cy - r);\n\n                _this.setHandleXY(_this.handles[idx2], cx, cy + r);\n\n                _this.setHandleXY(_this.handles[1], cx + r, cy);\n\n                _this.setHandleXY(_this.handles[3], cx - r, cy);\n              } else {\n                var idx3 = 3;\n                var idx1 = 1;\n\n                if (draggedHandleIdx == 1 && width > 0 || draggedHandleIdx == 3 && width < 0) {\n                  idx3 = 1;\n                  idx1 = 3;\n                }\n\n                _this.setHandleXY(_this.handles[idx3], cx + r, cy);\n\n                _this.setHandleXY(_this.handles[idx1], cx - r, cy);\n\n                _this.setHandleXY(_this.handles[0], cx, cy - r);\n\n                _this.setHandleXY(_this.handles[2], cx, cy + r);\n              }\n            });\n            EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\n              return function (evt) {\n                _this.grabbedElem = grabbedElem;\n\n                var pos = _this.getSVGPoint(evt);\n\n                var _getCircleSize = getCircleSize(_this.circle),\n                    cx = _getCircleSize.cx,\n                    cy = _getCircleSize.cy;\n\n                _this.grabbedAt = {\n                  x: pos.x - cx,\n                  y: pos.y - cy\n                };\n              };\n            });\n            EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\n              var constrain = function constrain(coord, max) {\n                return coord < 0 ? 0 : coord > max ? max : coord;\n              };\n\n              if (_this.grabbedElem) {\n                var pos = _this.getSVGPoint(evt);\n\n                if (_this.grabbedElem === _this.circle) {\n                  var _getCircleSize2 = getCircleSize(_this.circle),\n                      r = _getCircleSize2.r;\n\n                  var _this$env$image = _this.env.image,\n                      naturalWidth = _this$env$image.naturalWidth,\n                      naturalHeight = _this$env$image.naturalHeight;\n                  var cx = Math.max(constrain(pos.x - _this.grabbedAt.x, naturalWidth - r), r);\n                  var cy = Math.max(constrain(pos.y - _this.grabbedAt.y, naturalHeight - r), r);\n\n                  _this.setSize(cx, cy, r);\n\n                  _this.emit('update', toSVGTarget(_this.circle, _this.env.image));\n                } else {\n                  // Mouse position replaces one of the corner coords, depending\n                  // on which handle is the grabbed element\n                  var handleIdx = _this.handles.indexOf(_this.grabbedElem);\n\n                  var oppositeHandle = handleIdx < 2 ? _this.handles[handleIdx + 2] : _this.handles[handleIdx - 2];\n\n                  _this.stretchCorners(handleIdx, oppositeHandle, pos);\n\n                  _this.emit('update', toSVGTarget(_this.circle, _this.env.image));\n                }\n              }\n            });\n            EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"onMouseUp\", function () {\n              _this.grabbedElem = null;\n              _this.grabbedAt = null;\n            });\n            EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"onScaleChanged\", function (scale) {\n              return _this.handles.map(_this.scaleHandle);\n            });\n            EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"updateState\", function (annotation) {\n              var shape = svgFragmentToShape(annotation);\n              var cx = parseFloat(shape.getAttribute('cx'));\n              var cy = parseFloat(shape.getAttribute('cy'));\n              var r = parseFloat(shape.getAttribute('r'));\n\n              _this.setSize(cx, cy, r);\n            });\n\n            _this.svg.addEventListener('mousemove', _this.onMouseMove);\n\n            _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\n            // \n            // <g>\n            //   <path class=\"a9s-selection mask\"... />\n            //   <g> <-- return this node as .element\n            //     <circle class=\"a9s-outer\" ... />\n            //     <circle class=\"a9s-inner\" ... />\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //   </g> \n            // </g>\n            // 'g' for the editable circle compound shape\n\n\n            _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            _this.circle = drawEmbeddedSVG(_annotation);\n\n            _this.circle.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.circle));\n\n            _this.mask = new CircleMask(env.image, _this.circle);\n\n            _this.containerGroup.appendChild(_this.mask.element); // The 'element' = circle + handles\n\n\n            _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n\n            _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n\n            _this.elementGroup.appendChild(_this.circle);\n\n            var _getCircleSize3 = getCircleSize(_this.circle),\n                _cx = _getCircleSize3.cx,\n                _cy = _getCircleSize3.cy,\n                _r = _getCircleSize3.r;\n\n            _this.handles = [[_cx, _cy - _r], [_cx + _r, _cy], [_cx, _cy + _r], [_cx - _r, _cy]].map(function (t) {\n              var _t = EditableCircle_slicedToArray(t, 2),\n                  x = _t[0],\n                  y = _t[1];\n\n              var handle = _this.drawHandle(x, y);\n\n              handle.addEventListener('mousedown', _this.onGrab(handle));\n\n              _this.elementGroup.appendChild(handle);\n\n              return handle;\n            });\n\n            _this.containerGroup.appendChild(_this.elementGroup);\n\n            g.appendChild(_this.containerGroup);\n            format(_this.circle, _annotation, config.formatter); // The grabbed element (handle or entire group), if any\n\n            _this.grabbedElem = null; // Mouse xy offset inside the shape, if mouse pressed\n\n            _this.grabbedAt = null;\n            return _this;\n          }\n\n          EditableCircle_createClass(EditableCircle, [{\n            key: \"element\",\n            get: function get() {\n              return this.elementGroup;\n            }\n          }, {\n            key: \"destroy\",\n            value: function destroy() {\n              this.containerGroup.parentNode.removeChild(this.containerGroup);\n              EditableCircle_get(EditableCircle_getPrototypeOf(EditableCircle.prototype), \"destroy\", this).call(this);\n            }\n          }]);\n          return EditableCircle;\n        }(EditableShape);\n\n        ; // CONCATENATED MODULE: ./src/circle/RubberbandCircleTool.js\n\n        function RubberbandCircleTool_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return RubberbandCircleTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, RubberbandCircleTool_typeof(obj);\n        }\n\n        function RubberbandCircleTool_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandCircleTool_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandCircleTool_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandCircleTool_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandCircleTool_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandCircleTool_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) RubberbandCircleTool_setPrototypeOf(subClass, superClass);\n        }\n\n        function RubberbandCircleTool_setPrototypeOf(o, p) {\n          RubberbandCircleTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return RubberbandCircleTool_setPrototypeOf(o, p);\n        }\n\n        function RubberbandCircleTool_createSuper(Derived) {\n          var hasNativeReflectConstruct = RubberbandCircleTool_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = RubberbandCircleTool_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = RubberbandCircleTool_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return RubberbandCircleTool_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function RubberbandCircleTool_possibleConstructorReturn(self, call) {\n          if (call && (RubberbandCircleTool_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return RubberbandCircleTool_assertThisInitialized(self);\n        }\n\n        function RubberbandCircleTool_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function RubberbandCircleTool_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function RubberbandCircleTool_getPrototypeOf(o) {\n          RubberbandCircleTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return RubberbandCircleTool_getPrototypeOf(o);\n        }\n\n        function RubberbandCircleTool_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * A rubberband selector for circle selections.\r\n         */\n\n\n        var RubberbandCircleTool = /*#__PURE__*/function (_Tool) {\n          RubberbandCircleTool_inherits(RubberbandCircleTool, _Tool);\n\n          var _super = RubberbandCircleTool_createSuper(RubberbandCircleTool);\n\n          function RubberbandCircleTool(g, config, env) {\n            var _this;\n\n            RubberbandCircleTool_classCallCheck(this, RubberbandCircleTool);\n            _this = _super.call(this, g, config, env);\n            RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\n              _this.attachListeners({\n                mouseMove: _this.onMouseMove,\n                mouseUp: _this.onMouseUp\n              });\n\n              _this.rubberband = new RubberbandCircle(x, y, _this.g, _this.env);\n            });\n            RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"stop\", function () {\n              if (_this.rubberband) {\n                _this.rubberband.destroy();\n\n                _this.rubberband = null;\n              }\n            });\n            RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\n              return _this.rubberband.dragTo(x, y);\n            });\n            RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"onMouseUp\", function () {\n              _this.detachListeners();\n\n              _this.started = false;\n\n              var _this$rubberband$getB = _this.rubberband.getBoundingClientRect(),\n                  width = _this$rubberband$getB.width,\n                  height = _this$rubberband$getB.height;\n\n              var minWidth = _this.config.minSelectionWidth || 4;\n              var minHeight = _this.config.minSelectionHeight || 4;\n\n              if (width >= minWidth && height >= minHeight) {\n                // Emit the SVG shape with selection attached    \n                var element = _this.rubberband.element;\n                element.annotation = _this.rubberband.toSelection(); // Emit the completed shape...\n\n                _this.emit('complete', element);\n              } else {\n                _this.emit('cancel');\n              }\n\n              _this.stop();\n            });\n            RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\n              return new EditableCircle(annotation, _this.g, _this.config, _this.env);\n            });\n            _this.rubberband = null;\n            return _this;\n          }\n\n          RubberbandCircleTool_createClass(RubberbandCircleTool, [{\n            key: \"isDrawing\",\n            get: function get() {\n              return this.rubberband != null;\n            }\n          }]);\n          return RubberbandCircleTool;\n        }(Tool);\n\n        RubberbandCircleTool.identifier = 'circle';\n\n        RubberbandCircleTool.supports = function (annotation) {\n          var _selector$value;\n\n          var selector = annotation.selector('SvgSelector');\n          if (selector) return (_selector$value = selector.value) === null || _selector$value === void 0 ? void 0 : _selector$value.match(/^<svg.*<circle/g);\n        };\n\n        ; // CONCATENATED MODULE: ./src/ellipse/Ellipse.js\n\n        /** Shorthand to apply the given (x, y, rx, ry) to the SVG shape **/\n\n        var Ellipse_setXYR = function setXYR(shape, x, y, rx, ry) {\n          shape.setAttribute('cx', x);\n          shape.setAttribute('cy', y);\n          shape.setAttribute('rx', rx);\n          shape.setAttribute('ry', ry);\n        };\n        /** \r\n         * Draws an SVG ellipse, either from an annotation, or an\r\n         * (cx, cy, rx, ry)-tuple.\r\n         */\n\n\n        var drawEllipse = function drawEllipse(cx, cy, rx, ry) {\n          var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n          var innerEllipse = document.createElementNS(SVG_SVG_NAMESPACE, 'ellipse');\n          var outerEllipse = document.createElementNS(SVG_SVG_NAMESPACE, 'ellipse');\n          innerEllipse.setAttribute('class', 'a9s-inner');\n          Ellipse_setXYR(innerEllipse, cx, cy, rx, ry);\n          outerEllipse.setAttribute('class', 'a9s-outer');\n          Ellipse_setXYR(outerEllipse, cx, cy, rx, ry);\n          g.appendChild(outerEllipse);\n          g.appendChild(innerEllipse);\n          return g;\n        };\n\n        var setEllipseSize = function setEllipseSize(g, cx, cy, rx, ry) {\n          var innerEllipse = g.querySelector('.a9s-inner');\n          var outerEllipse = g.querySelector('.a9s-outer');\n          Ellipse_setXYR(innerEllipse, cx, cy, rx, ry);\n          Ellipse_setXYR(outerEllipse, cx, cy, rx, ry);\n        };\n\n        var getEllipseSize = function getEllipseSize(g) {\n          var outerEllipse = g.querySelector('.a9s-outer');\n          var cx = parseFloat(outerEllipse.getAttribute('cx'));\n          var cy = parseFloat(outerEllipse.getAttribute('cy'));\n          var rx = parseFloat(outerEllipse.getAttribute('rx'));\n          var ry = parseFloat(outerEllipse.getAttribute('ry'));\n          return {\n            cx: cx,\n            cy: cy,\n            rx: rx,\n            ry: ry\n          };\n        };\n\n        ; // CONCATENATED MODULE: ./src/ellipse/EllipseMask.js\n\n        function EllipseMask_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function EllipseMask_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function EllipseMask_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) EllipseMask_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) EllipseMask_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function EllipseMask_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var EllipseMask = /*#__PURE__*/function () {\n          function EllipseMask(imageDimensions, ellipse) {\n            var _this = this;\n\n            EllipseMask_classCallCheck(this, EllipseMask);\n            EllipseMask_defineProperty(this, \"redraw\", function () {\n              var _getEllipseSize = getEllipseSize(_this.ellipse),\n                  cx = _getEllipseSize.cx,\n                  cy = _getEllipseSize.cy,\n                  rx = _getEllipseSize.rx,\n                  ry = _getEllipseSize.ry;\n\n              var ty = cy + ry;\n\n              _this.mask.setAttribute('d', \"M0 0 h\".concat(_this.w, \" v\").concat(_this.h, \" h-\").concat(_this.w, \" z M\").concat(cx, \" \").concat(ty, \" a \").concat(rx, \" \").concat(ry, \" 0 1 1 1 0\"));\n            });\n            EllipseMask_defineProperty(this, \"destroy\", function () {\n              return _this.mask.parentNode.removeChild(_this.mask);\n            });\n            this.w = imageDimensions.naturalWidth;\n            this.h = imageDimensions.naturalHeight;\n            this.ellipse = ellipse;\n\n            var _getEllipseSize2 = getEllipseSize(this.ellipse),\n                _cx = _getEllipseSize2.cx,\n                _cy = _getEllipseSize2.cy,\n                _rx = _getEllipseSize2.rx,\n                _ry = _getEllipseSize2.ry;\n\n            var _ty = _cy + _ry;\n\n            this.mask = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\n            this.mask.setAttribute('fill-rule', 'evenodd');\n            this.mask.setAttribute('class', 'a9s-selection-mask');\n            this.mask.setAttribute('d', \"M0 0 h\".concat(this.w, \" v\").concat(this.h, \" h-\").concat(this.w, \" z M\").concat(_cx, \" \").concat(_ty, \" a \").concat(_rx, \" \").concat(_ry, \" 0 1 1 1 0\"));\n          }\n\n          EllipseMask_createClass(EllipseMask, [{\n            key: \"element\",\n            get: function get() {\n              return this.mask;\n            }\n          }]);\n          return EllipseMask;\n        }();\n\n        ; // CONCATENATED MODULE: ./src/ellipse/RubberbandEllipse.js\n\n        function RubberbandEllipse_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandEllipse_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandEllipse_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandEllipse_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandEllipse_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandEllipse_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * A 'rubberband' selection tool for creating a ellipse by\r\n         * clicking and dragging.\r\n         */\n\n\n        var RubberbandEllipse = /*#__PURE__*/function () {\n          function RubberbandEllipse(anchorX, anchorY, g, env) {\n            var _this = this;\n\n            RubberbandEllipse_classCallCheck(this, RubberbandEllipse);\n            RubberbandEllipse_defineProperty(this, \"dragTo\", function (oppositeX, oppositeY) {\n              // Make visible\n              _this.group.style.display = null;\n              var w = oppositeX - _this.anchor[0];\n              var h = oppositeY - _this.anchor[1];\n              var cx = w > 0 ? _this.anchor[0] + w / 2 : oppositeX + w / 2;\n              var cy = h > 0 ? _this.anchor[1] + h / 2 : oppositeY + h / 2;\n              var rx = Math.abs(w / 2);\n              var ry = Math.abs(h / 2);\n              setEllipseSize(_this.ellipse, cx, cy, rx, ry);\n\n              _this.mask.redraw();\n            });\n            RubberbandEllipse_defineProperty(this, \"getBoundingClientRect\", function () {\n              return _this.ellipse.getBoundingClientRect();\n            });\n            RubberbandEllipse_defineProperty(this, \"toSelection\", function () {\n              return new Selection(toSVGTarget(_this.group, _this.env.image));\n            });\n            RubberbandEllipse_defineProperty(this, \"destroy\", function () {\n              _this.group.parentNode.removeChild(_this.group);\n\n              _this.mask = null;\n              _this.ellipse = null;\n              _this.group = null;\n            });\n            this.anchor = [anchorX, anchorY];\n            this.env = env;\n            this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            this.ellipse = drawEllipse(anchorX, anchorY, 2);\n            this.ellipse.setAttribute('class', 'a9s-selection');\n            this.mask = new EllipseMask(env.image, this.ellipse); // We make the selection transparent to \n            // pointer events because it would interfere with the \n            // rendered annotations' mouseleave/enter events\n\n            this.group.style.pointerEvents = 'none'; // Additionally, selection remains hidden until \n            // the user actually moves the mouse\n\n            this.group.style.display = 'none';\n            this.group.appendChild(this.mask.element);\n            this.group.appendChild(this.ellipse);\n            g.appendChild(this.group);\n          }\n\n          RubberbandEllipse_createClass(RubberbandEllipse, [{\n            key: \"element\",\n            get: function get() {\n              return this.ellipse;\n            }\n          }]);\n          return RubberbandEllipse;\n        }();\n\n        ; // CONCATENATED MODULE: ./src/ellipse/EditableEllipse.js\n\n        function EditableEllipse_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return EditableEllipse_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, EditableEllipse_typeof(obj);\n        }\n\n        function EditableEllipse_slicedToArray(arr, i) {\n          return EditableEllipse_arrayWithHoles(arr) || EditableEllipse_iterableToArrayLimit(arr, i) || EditableEllipse_unsupportedIterableToArray(arr, i) || EditableEllipse_nonIterableRest();\n        }\n\n        function EditableEllipse_nonIterableRest() {\n          throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }\n\n        function EditableEllipse_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return EditableEllipse_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EditableEllipse_arrayLikeToArray(o, minLen);\n        }\n\n        function EditableEllipse_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n\n        function EditableEllipse_iterableToArrayLimit(arr, i) {\n          var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n          if (_i == null) return;\n          var _arr = [];\n          var _n = true;\n          var _d = false;\n\n          var _s, _e;\n\n          try {\n            for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n              _arr.push(_s.value);\n\n              if (i && _arr.length === i) break;\n            }\n          } catch (err) {\n            _d = true;\n            _e = err;\n          } finally {\n            try {\n              if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n            } finally {\n              if (_d) throw _e;\n            }\n          }\n\n          return _arr;\n        }\n\n        function EditableEllipse_arrayWithHoles(arr) {\n          if (Array.isArray(arr)) return arr;\n        }\n\n        function EditableEllipse_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function EditableEllipse_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function EditableEllipse_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) EditableEllipse_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) EditableEllipse_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function EditableEllipse_get() {\n          if (typeof Reflect !== \"undefined\" && Reflect.get) {\n            EditableEllipse_get = Reflect.get.bind();\n          } else {\n            EditableEllipse_get = function _get(target, property, receiver) {\n              var base = EditableEllipse_superPropBase(target, property);\n              if (!base) return;\n              var desc = Object.getOwnPropertyDescriptor(base, property);\n\n              if (desc.get) {\n                return desc.get.call(arguments.length < 3 ? target : receiver);\n              }\n\n              return desc.value;\n            };\n          }\n\n          return EditableEllipse_get.apply(this, arguments);\n        }\n\n        function EditableEllipse_superPropBase(object, property) {\n          while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = EditableEllipse_getPrototypeOf(object);\n            if (object === null) break;\n          }\n\n          return object;\n        }\n\n        function EditableEllipse_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) EditableEllipse_setPrototypeOf(subClass, superClass);\n        }\n\n        function EditableEllipse_setPrototypeOf(o, p) {\n          EditableEllipse_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return EditableEllipse_setPrototypeOf(o, p);\n        }\n\n        function EditableEllipse_createSuper(Derived) {\n          var hasNativeReflectConstruct = EditableEllipse_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = EditableEllipse_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = EditableEllipse_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return EditableEllipse_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function EditableEllipse_possibleConstructorReturn(self, call) {\n          if (call && (EditableEllipse_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return EditableEllipse_assertThisInitialized(self);\n        }\n\n        function EditableEllipse_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function EditableEllipse_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function EditableEllipse_getPrototypeOf(o) {\n          EditableEllipse_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return EditableEllipse_getPrototypeOf(o);\n        }\n\n        function EditableEllipse_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * An editable ellipse shape.\r\n         */\n\n\n        var EditableEllipse = /*#__PURE__*/function (_EditableShape) {\n          EditableEllipse_inherits(EditableEllipse, _EditableShape);\n\n          var _super = EditableEllipse_createSuper(EditableEllipse);\n\n          function EditableEllipse(_annotation, g, config, env) {\n            var _this;\n\n            EditableEllipse_classCallCheck(this, EditableEllipse);\n            _this = _super.call(this, _annotation, g, config, env);\n            EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"setSize\", function (cx, cy, rx, ry) {\n              setEllipseSize(_this.ellipse, cx, cy, rx, ry);\n\n              _this.mask.redraw();\n\n              setFormatterElSize(_this.elementGroup, cx, cy, rx, ry);\n\n              var _this$handles = EditableEllipse_slicedToArray(_this.handles, 4),\n                  topleft = _this$handles[0],\n                  topright = _this$handles[1],\n                  bottomright = _this$handles[2],\n                  bottomleft = _this$handles[3];\n\n              _this.setHandleXY(topleft, cx, cy - ry);\n\n              _this.setHandleXY(topright, cx + rx, cy);\n\n              _this.setHandleXY(bottomright, cx, cy + ry);\n\n              _this.setHandleXY(bottomleft, cx - rx, cy);\n            });\n            EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"stretchCorners\", function (draggedHandleIdx, anchorHandle, leftHandle, mousePos) {\n              var anchor = _this.getHandleXY(anchorHandle);\n\n              var anchorLeft = _this.getHandleXY(leftHandle);\n\n              var mouseX = mousePos.x;\n              var mouseY = mousePos.y;\n              var rx = 0;\n              var ry = 0;\n\n              if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n                mouseX = anchor.x;\n              } else {\n                mouseY = anchor.y;\n              }\n\n              var width = mouseX - anchor.x;\n              var height = mouseY - anchor.y;\n              var x = width > 0 ? anchor.x : mouseX;\n              var y = height > 0 ? anchor.y : mouseY;\n              var w = Math.abs(width);\n              var h = Math.abs(height);\n              var cx = x + w / 2;\n              var cy = y + h / 2;\n              var rx = w / 2;\n              var ry = h / 2;\n\n              if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n                rx = Math.abs(anchor.x - anchorLeft.x);\n              } else {\n                ry = Math.abs(anchor.y - anchorLeft.y);\n              }\n\n              setEllipseSize(_this.ellipse, cx, cy, rx, ry);\n\n              _this.mask.redraw();\n\n              setFormatterElSize(_this.elementGroup, cx, cy, rx, ry);\n\n              if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\n                var idx0 = 0;\n                var idx2 = 2;\n\n                if (draggedHandleIdx == 0 && height > 0 || draggedHandleIdx == 2 && height < 0) {\n                  idx0 = 2;\n                  idx2 = 0;\n                }\n\n                _this.setHandleXY(_this.handles[idx0], cx, cy - ry);\n\n                _this.setHandleXY(_this.handles[idx2], cx, cy + ry);\n\n                _this.setHandleXY(_this.handles[1], cx + rx, cy);\n\n                _this.setHandleXY(_this.handles[3], cx - rx, cy);\n              } else {\n                var idx3 = 3;\n                var idx1 = 1;\n\n                if (draggedHandleIdx == 1 && width > 0 || draggedHandleIdx == 3 && width < 0) {\n                  idx3 = 1;\n                  idx1 = 3;\n                }\n\n                _this.setHandleXY(_this.handles[idx3], cx + rx, cy);\n\n                _this.setHandleXY(_this.handles[idx1], cx - rx, cy);\n\n                _this.setHandleXY(_this.handles[0], cx, cy - ry);\n\n                _this.setHandleXY(_this.handles[2], cx, cy + ry);\n              }\n            });\n            EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\n              return function (evt) {\n                _this.grabbedElem = grabbedElem;\n\n                var pos = _this.getSVGPoint(evt);\n\n                var _getEllipseSize = getEllipseSize(_this.ellipse),\n                    cx = _getEllipseSize.cx,\n                    cy = _getEllipseSize.cy;\n\n                _this.grabbedAt = {\n                  x: pos.x - cx,\n                  y: pos.y - cy\n                };\n              };\n            });\n            EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\n              var constrain = function constrain(coord, max) {\n                return coord < 0 ? 0 : coord > max ? max : coord;\n              };\n\n              if (_this.grabbedElem) {\n                var pos = _this.getSVGPoint(evt);\n\n                if (_this.grabbedElem === _this.ellipse) {\n                  var _getEllipseSize2 = getEllipseSize(_this.ellipse),\n                      rx = _getEllipseSize2.rx,\n                      ry = _getEllipseSize2.ry;\n\n                  var _this$env$image = _this.env.image,\n                      naturalWidth = _this$env$image.naturalWidth,\n                      naturalHeight = _this$env$image.naturalHeight;\n                  var cx = constrain(pos.x - _this.grabbedAt.x, naturalWidth - rx);\n                  var cy = constrain(pos.y - _this.grabbedAt.y, naturalHeight - ry);\n\n                  _this.setSize(cx, cy, rx, ry);\n\n                  _this.emit('update', toSVGTarget(_this.ellipse, _this.env.image));\n                } else {\n                  // Mouse position replaces one of the corner coords, depending\n                  // on which handle is the grabbed element\n                  var handleIdx = _this.handles.indexOf(_this.grabbedElem);\n\n                  var oppositeHandle = handleIdx < 2 ? _this.handles[handleIdx + 2] : _this.handles[handleIdx - 2];\n                  var leftHandle = _this.handles[(handleIdx + 3) % 4];\n\n                  _this.stretchCorners(handleIdx, oppositeHandle, leftHandle, pos);\n\n                  _this.emit('update', toSVGTarget(_this.ellipse, _this.env.image));\n                }\n              }\n            });\n            EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"onMouseUp\", function () {\n              _this.grabbedElem = null;\n              _this.grabbedAt = null;\n            });\n            EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"onScaleChanged\", function (scale) {\n              return _this.handles.map(_this.scaleHandle);\n            });\n            EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"updateState\", function (annotation) {\n              var shape = svgFragmentToShape(annotation);\n              var cx = parseFloat(shape.getAttribute('cx'));\n              var cy = parseFloat(shape.getAttribute('cy'));\n              var rx = parseFloat(shape.getAttribute('rx'));\n              var ry = parseFloat(shape.getAttribute('ry'));\n\n              _this.setSize(cx, cy, rx, ry);\n            });\n\n            _this.svg.addEventListener('mousemove', _this.onMouseMove);\n\n            _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\n            // \n            // <g>\n            //   <path class=\"a9s-selection mask\"... />\n            //   <g> <-- return this node as .element\n            //     <ellipse class=\"a9s-outer\" ... />\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //   </g> \n            // </g>\n            // 'g' for the editable ellipse compound shape\n\n\n            _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            _this.ellipse = drawEmbeddedSVG(_annotation);\n\n            _this.ellipse.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.ellipse));\n\n            _this.mask = new EllipseMask(env.image, _this.ellipse);\n\n            _this.containerGroup.appendChild(_this.mask.element); // The 'element' = ellipse + handles\n\n\n            _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n\n            _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n\n            _this.elementGroup.appendChild(_this.ellipse);\n\n            var _getEllipseSize3 = getEllipseSize(_this.ellipse),\n                _cx = _getEllipseSize3.cx,\n                _cy = _getEllipseSize3.cy,\n                _rx = _getEllipseSize3.rx,\n                _ry = _getEllipseSize3.ry;\n\n            _this.handles = [[_cx, _cy - _ry], [_cx + _rx, _cy], [_cx, _cy + _ry], [_cx - _rx, _cy]].map(function (t) {\n              var _t = EditableEllipse_slicedToArray(t, 2),\n                  x = _t[0],\n                  y = _t[1];\n\n              var handle = _this.drawHandle(x, y);\n\n              handle.addEventListener('mousedown', _this.onGrab(handle));\n\n              _this.elementGroup.appendChild(handle);\n\n              return handle;\n            });\n\n            _this.containerGroup.appendChild(_this.elementGroup);\n\n            g.appendChild(_this.containerGroup);\n            format(_this.ellipse, _annotation, config.formatter); // The grabbed element (handle or entire group), if any\n\n            _this.grabbedElem = null; // Mouse xy offset inside the shape, if mouse pressed\n\n            _this.grabbedAt = null;\n            return _this;\n          }\n\n          EditableEllipse_createClass(EditableEllipse, [{\n            key: \"element\",\n            get: function get() {\n              return this.elementGroup;\n            }\n          }, {\n            key: \"destroy\",\n            value: function destroy() {\n              this.containerGroup.parentNode.removeChild(this.containerGroup);\n              EditableEllipse_get(EditableEllipse_getPrototypeOf(EditableEllipse.prototype), \"destroy\", this).call(this);\n            }\n          }]);\n          return EditableEllipse;\n        }(EditableShape);\n\n        ; // CONCATENATED MODULE: ./src/ellipse/RubberbandEllipseTool.js\n\n        function RubberbandEllipseTool_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return RubberbandEllipseTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, RubberbandEllipseTool_typeof(obj);\n        }\n\n        function RubberbandEllipseTool_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandEllipseTool_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandEllipseTool_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandEllipseTool_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandEllipseTool_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandEllipseTool_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) RubberbandEllipseTool_setPrototypeOf(subClass, superClass);\n        }\n\n        function RubberbandEllipseTool_setPrototypeOf(o, p) {\n          RubberbandEllipseTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return RubberbandEllipseTool_setPrototypeOf(o, p);\n        }\n\n        function RubberbandEllipseTool_createSuper(Derived) {\n          var hasNativeReflectConstruct = RubberbandEllipseTool_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = RubberbandEllipseTool_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = RubberbandEllipseTool_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return RubberbandEllipseTool_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function RubberbandEllipseTool_possibleConstructorReturn(self, call) {\n          if (call && (RubberbandEllipseTool_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return RubberbandEllipseTool_assertThisInitialized(self);\n        }\n\n        function RubberbandEllipseTool_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function RubberbandEllipseTool_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function RubberbandEllipseTool_getPrototypeOf(o) {\n          RubberbandEllipseTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return RubberbandEllipseTool_getPrototypeOf(o);\n        }\n\n        function RubberbandEllipseTool_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * A rubberband selector for ellipse selections.\r\n         */\n\n\n        var RubberbandEllipseTool = /*#__PURE__*/function (_Tool) {\n          RubberbandEllipseTool_inherits(RubberbandEllipseTool, _Tool);\n\n          var _super = RubberbandEllipseTool_createSuper(RubberbandEllipseTool);\n\n          function RubberbandEllipseTool(g, config, env) {\n            var _this;\n\n            RubberbandEllipseTool_classCallCheck(this, RubberbandEllipseTool);\n            _this = _super.call(this, g, config, env);\n            RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\n              _this.attachListeners({\n                mouseMove: _this.onMouseMove,\n                mouseUp: _this.onMouseUp\n              });\n\n              _this.rubberband = new RubberbandEllipse(x, y, _this.g, _this.env);\n            });\n            RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"stop\", function () {\n              if (_this.rubberband) {\n                _this.rubberband.destroy();\n\n                _this.rubberband = null;\n              }\n            });\n            RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\n              return _this.rubberband.dragTo(x, y);\n            });\n            RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"onMouseUp\", function () {\n              _this.detachListeners();\n\n              _this.started = false;\n\n              var _this$rubberband$getB = _this.rubberband.getBoundingClientRect(),\n                  width = _this$rubberband$getB.width,\n                  height = _this$rubberband$getB.height;\n\n              var minWidth = _this.config.minSelectionWidth || 4;\n              var minHeight = _this.config.minSelectionHeight || 4;\n\n              if (width >= minWidth && height >= minHeight) {\n                // Emit the SVG shape with selection attached    \n                var element = _this.rubberband.element;\n                element.annotation = _this.rubberband.toSelection(); // Emit the completed shape...\n\n                _this.emit('complete', element);\n              } else {\n                _this.emit('cancel');\n              }\n\n              _this.stop();\n            });\n            RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\n              return new EditableEllipse(annotation, _this.g, _this.config, _this.env);\n            });\n            _this.rubberband = null;\n            return _this;\n          }\n\n          RubberbandEllipseTool_createClass(RubberbandEllipseTool, [{\n            key: \"isDrawing\",\n            get: function get() {\n              return this.rubberband != null;\n            }\n          }]);\n          return RubberbandEllipseTool;\n        }(Tool);\n\n        RubberbandEllipseTool.identifier = 'ellipse';\n\n        RubberbandEllipseTool.supports = function (annotation) {\n          var _selector$value;\n\n          var selector = annotation.selector('SvgSelector');\n          if (selector) return (_selector$value = selector.value) === null || _selector$value === void 0 ? void 0 : _selector$value.match(/^<svg.*<ellipse/g);\n        };\n\n        ; // CONCATENATED MODULE: ./src/freehand/RubberbandFreehand.js\n\n        function RubberbandFreehand_toConsumableArray(arr) {\n          return RubberbandFreehand_arrayWithoutHoles(arr) || RubberbandFreehand_iterableToArray(arr) || RubberbandFreehand_unsupportedIterableToArray(arr) || RubberbandFreehand_nonIterableSpread();\n        }\n\n        function RubberbandFreehand_nonIterableSpread() {\n          throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }\n\n        function RubberbandFreehand_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return RubberbandFreehand_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return RubberbandFreehand_arrayLikeToArray(o, minLen);\n        }\n\n        function RubberbandFreehand_iterableToArray(iter) {\n          if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n        }\n\n        function RubberbandFreehand_arrayWithoutHoles(arr) {\n          if (Array.isArray(arr)) return RubberbandFreehand_arrayLikeToArray(arr);\n        }\n\n        function RubberbandFreehand_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n\n        function RubberbandFreehand_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandFreehand_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandFreehand_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandFreehand_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandFreehand_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandFreehand_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        } // TODO optional: mask to dim the outside area\n        //import Mask from './FreehandMask';\n\n        /**\r\n         * A 'rubberband' selection tool for creating freehand drawing by\r\n         * clicking and dragging.\r\n         */\n\n\n        var RubberbandFreehand = /*#__PURE__*/function () {\n          function RubberbandFreehand(anchor, g, env) {\n            var _this = this;\n\n            RubberbandFreehand_classCallCheck(this, RubberbandFreehand);\n            RubberbandFreehand_defineProperty(this, \"setPoints\", function (points) {\n              var str = points.map(function (pt) {\n                return \"L\".concat(pt[0], \" \").concat(pt[1]);\n              }).join(' ');\n              str = 'M' + str.substring(1);\n\n              _this.outer.setAttribute('d', str);\n\n              _this.inner.setAttribute('d', str);\n            });\n            RubberbandFreehand_defineProperty(this, \"getBoundingClientRect\", function () {\n              return _this.outer.getBoundingClientRect();\n            });\n            RubberbandFreehand_defineProperty(this, \"dragTo\", function (xy) {\n              // Make visible\n              _this.group.style.display = null; //TODO optional: edge smoothing\n\n              _this.addPoint(xy); // TODO optional: mask to dim the outside area\n              // this.mask.redraw();\n\n            });\n            RubberbandFreehand_defineProperty(this, \"addPoint\", function (xy) {\n              _this.points = [].concat(RubberbandFreehand_toConsumableArray(_this.points), [xy]);\n\n              _this.setPoints(_this.points); // TODO optional: mask to dim the outside area\n              // this.mask.redraw();\n\n            });\n            RubberbandFreehand_defineProperty(this, \"destroy\", function () {\n              _this.group.parentNode.removeChild(_this.group);\n\n              _this.freehand = null;\n              _this.group = null;\n            });\n            RubberbandFreehand_defineProperty(this, \"toSelection\", function () {\n              return new Selection(toSVGTarget(_this.group, _this.env.image));\n            });\n            this.points = [anchor];\n            this.env = env;\n            this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            this.freehand = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            this.freehand.setAttribute('class', 'a9s-selection');\n            this.outer = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\n            this.outer.setAttribute('class', 'a9s-outer');\n            this.inner = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\n            this.inner.setAttribute('class', 'a9s-inner');\n            this.setPoints(this.points); // TODO optional: mask to dim the outside area\n            // this.mask = new Mask(env.image, this.inner);\n\n            this.freehand.appendChild(this.outer);\n            this.freehand.appendChild(this.inner); // Additionally, selection remains hidden until \n            // the user actually moves the mouse\n\n            this.group.style.display = 'none'; // TODO optional: mask to dim the outside area\n            // this.group.appendChild(this.mask.element);\n\n            this.group.appendChild(this.freehand);\n            g.appendChild(this.group);\n          }\n\n          RubberbandFreehand_createClass(RubberbandFreehand, [{\n            key: \"element\",\n            get: function get() {\n              return this.freehand;\n            }\n          }]);\n          return RubberbandFreehand;\n        }();\n\n        ; // CONCATENATED MODULE: ./src/freehand/EditableFreehand.js\n\n        function EditableFreehand_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return EditableFreehand_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, EditableFreehand_typeof(obj);\n        }\n\n        function EditableFreehand_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function EditableFreehand_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function EditableFreehand_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) EditableFreehand_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) EditableFreehand_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function EditableFreehand_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) EditableFreehand_setPrototypeOf(subClass, superClass);\n        }\n\n        function EditableFreehand_setPrototypeOf(o, p) {\n          EditableFreehand_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return EditableFreehand_setPrototypeOf(o, p);\n        }\n\n        function EditableFreehand_createSuper(Derived) {\n          var hasNativeReflectConstruct = EditableFreehand_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = EditableFreehand_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = EditableFreehand_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return EditableFreehand_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function EditableFreehand_possibleConstructorReturn(self, call) {\n          if (call && (EditableFreehand_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return EditableFreehand_assertThisInitialized(self);\n        }\n\n        function EditableFreehand_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function EditableFreehand_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function EditableFreehand_get() {\n          if (typeof Reflect !== \"undefined\" && Reflect.get) {\n            EditableFreehand_get = Reflect.get.bind();\n          } else {\n            EditableFreehand_get = function _get(target, property, receiver) {\n              var base = EditableFreehand_superPropBase(target, property);\n              if (!base) return;\n              var desc = Object.getOwnPropertyDescriptor(base, property);\n\n              if (desc.get) {\n                return desc.get.call(arguments.length < 3 ? target : receiver);\n              }\n\n              return desc.value;\n            };\n          }\n\n          return EditableFreehand_get.apply(this, arguments);\n        }\n\n        function EditableFreehand_superPropBase(object, property) {\n          while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = EditableFreehand_getPrototypeOf(object);\n            if (object === null) break;\n          }\n\n          return object;\n        }\n\n        function EditableFreehand_getPrototypeOf(o) {\n          EditableFreehand_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return EditableFreehand_getPrototypeOf(o);\n        }\n\n        function EditableFreehand_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        } // TODO optional: mask to dim the outside area\n        //import Mask from './FreehandMask';\n\n\n        var getPoints = function getPoints(shape) {\n          var pointList = shape.getAttribute('d').split('L');\n          var points = [];\n\n          if (pointList.length > 0) {\n            var point = pointList[0].substring(1).trim().split(' ');\n            points.push({\n              x: parseFloat(point[0]),\n              y: parseFloat(point[1])\n            });\n\n            for (var i = 1; i < pointList.length; i++) {\n              var point = pointList[i].trim().split(' ');\n              points.push({\n                x: parseFloat(point[0]),\n                y: parseFloat(point[1])\n              });\n            }\n          }\n\n          return points;\n        };\n\n        var getBBox = function getBBox(shape) {\n          return shape.querySelector('.a9s-inner').getBBox();\n        };\n        /**\r\n         * An editable freehand drawing.\r\n         */\n\n\n        var EditableFreehand = /*#__PURE__*/function (_EditableShape) {\n          EditableFreehand_inherits(EditableFreehand, _EditableShape);\n\n          var _super = EditableFreehand_createSuper(EditableFreehand);\n\n          function EditableFreehand(_annotation, g, config, env) {\n            var _thisSuper, _this;\n\n            EditableFreehand_classCallCheck(this, EditableFreehand);\n            _this = _super.call(this, _annotation, g, config, env);\n            EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"setPoints\", function (points) {\n              // Not using .toFixed(1) because that will ALWAYS\n              // return one decimal, e.g. \"15.0\" (when we want \"15\")\n              var round = function round(num) {\n                return Math.round(10 * num) / 10;\n              };\n\n              var str = points.map(function (pt) {\n                return \"L\".concat(round(pt.x), \" \").concat(round(pt.y));\n              }).join(' ');\n              str = 'M' + str.substring(1);\n\n              var inner = _this.shape.querySelector('.a9s-inner');\n\n              inner.setAttribute('d', str);\n\n              var outer = _this.shape.querySelector('.a9s-outer');\n\n              outer.setAttribute('d', str);\n\n              var _outer$getBBox = outer.getBBox(),\n                  x = _outer$getBBox.x,\n                  y = _outer$getBBox.y,\n                  width = _outer$getBBox.width,\n                  height = _outer$getBBox.height; // TODO optional: mask to dim the outside area\n              // this.mask.redraw();\n              // TODO optional: handles to stretch the shape\n\n              /*    const [ topleft, topright, bottomright, bottomleft] = this.handles;\r\n              \r\n                  this.setHandleXY(topleft, x, y);\r\n                  this.setHandleXY(topright, x + width, y);\r\n                  this.setHandleXY(bottomright, x + width, y + height);\r\n                  this.setHandleXY(bottomleft, x, y + height);*/\n\n\n              setFormatterElSize(_this.elementGroup, x, y, width, height);\n            });\n            EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\n              return function (evt) {\n                _this.grabbedElem = grabbedElem;\n\n                var pos = _this.getSVGPoint(evt);\n\n                _this.grabbedAt = {\n                  x: pos.x,\n                  y: pos.y\n                };\n              };\n            });\n            EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\n              var constrain = function constrain(coord, delta, max) {\n                return coord + delta < 0 ? -coord : coord + delta > max ? max - coord : delta;\n              };\n\n              if (_this.grabbedElem) {\n                var pos = _this.getSVGPoint(evt);\n\n                var _getBBox = getBBox(_this.shape),\n                    x = _getBBox.x,\n                    y = _getBBox.y,\n                    width = _getBBox.width,\n                    height = _getBBox.height;\n\n                if (_this.grabbedElem === _this.shape) {\n                  var _this$env$image = _this.env.image,\n                      naturalWidth = _this$env$image.naturalWidth,\n                      naturalHeight = _this$env$image.naturalHeight;\n                  var dx = constrain(x, pos.x - _this.grabbedAt.x, naturalWidth - width);\n                  var dy = constrain(y, pos.y - _this.grabbedAt.y, naturalHeight - height);\n\n                  var inner = _this.shape.querySelector('.a9s-inner');\n\n                  var updatedPoints = getPoints(inner).map(function (pt) {\n                    return {\n                      x: pt.x + dx,\n                      y: pt.y + dy\n                    };\n                  });\n                  _this.grabbedAt = pos;\n\n                  _this.setPoints(updatedPoints);\n\n                  _this.emit('update', toSVGTarget(_this.shape, _this.env.image));\n                } // TODO optional: handles to stretch the shape\n\n                /* else {\r\n                  const handleIdx = this.handles.indexOf(this.grabbedElem);\r\n                  const oppositeHandle = handleIdx < 2 ? \r\n                    this.handles[handleIdx + 2] : this.handles[handleIdx - 2];\r\n                   this.stretchCorners(handleIdx, oppositeHandle, pos);\r\n                   this.emit('update', toSVGTarget(this.shape, this.env.image));\r\n                }*/\n\n              }\n            });\n            EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"onMouseUp\", function (evt) {\n              _this.grabbedElem = null;\n              _this.grabbedAt = null;\n            });\n            EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"updateState\", function (annotation) {\n              var points = getPoints(svgFragmentToShape(annotation));\n\n              _this.setPoints(points);\n            });\n            EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"destroy\", function () {\n              _this.containerGroup.parentNode.removeChild(_this.containerGroup);\n\n              EditableFreehand_get((_thisSuper = EditableFreehand_assertThisInitialized(_this), EditableFreehand_getPrototypeOf(EditableFreehand.prototype)), \"destroy\", _thisSuper).call(_thisSuper);\n            });\n\n            _this.svg.addEventListener('mousemove', _this.onMouseMove);\n\n            _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\n            // \n            // <g>\n            //   <path class=\"a9s-selection mask\"... />\n            //   <g> <-- return this node as .element\n            //     <polygon class=\"a9s-outer\" ... />\n            //     <polygon class=\"a9s-inner\" ... />\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     ...\n            //   </g> \n            // </g>\n            // 'g' for the editable free drawing compound shape\n\n\n            _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            _this.shape = drawEmbeddedSVG(_annotation); // TODO optional: mask to dim the outside area\n            // this.mask = new Mask(env.image, this.shape.querySelector('.a9s-inner'));\n            // this.containerGroup.appendChild(this.mask.element);\n\n            _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n\n            _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n\n            _this.elementGroup.appendChild(_this.shape);\n\n            _this.containerGroup.appendChild(_this.elementGroup);\n\n            g.appendChild(_this.containerGroup);\n            format(_this.shape, _annotation, config.formatter);\n\n            _this.shape.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.shape));\n\n            var _getBBox2 = getBBox(_this.shape),\n                _x = _getBBox2.x,\n                _y = _getBBox2.y,\n                _width = _getBBox2.width,\n                _height = _getBBox2.height; // TODO optional: handles to stretch the shape\n\n            /*    this.handles = [\r\n                  [ x, y ], \r\n                  [ x + width, y ], \r\n                  [ x + width, y + height ], \r\n                  [ x, y + height ]\r\n                ].map(t => { \r\n                  const [ x, y ] = t;\r\n                  const handle = this.drawHandle(x, y);\r\n            \r\n                  handle.addEventListener('mousedown', this.onGrab(handle));\r\n                  this.elementGroup.appendChild(handle);\r\n            \r\n                  return handle;\r\n                });*/\n            // The grabbed element (handle or entire shape), if any\n\n\n            _this.grabbedElem = null; // Mouse grab point\n\n            _this.grabbedAt = null;\n            return _this;\n          }\n\n          EditableFreehand_createClass(EditableFreehand, [{\n            key: \"element\",\n            get: function get() {\n              return this.elementGroup;\n            }\n          }]);\n          return EditableFreehand;\n        }(EditableShape);\n\n        ; // CONCATENATED MODULE: ./src/freehand/RubberbandFreehandTool.js\n\n        function RubberbandFreehandTool_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return RubberbandFreehandTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, RubberbandFreehandTool_typeof(obj);\n        }\n\n        function RubberbandFreehandTool_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandFreehandTool_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandFreehandTool_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandFreehandTool_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandFreehandTool_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandFreehandTool_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) RubberbandFreehandTool_setPrototypeOf(subClass, superClass);\n        }\n\n        function RubberbandFreehandTool_setPrototypeOf(o, p) {\n          RubberbandFreehandTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return RubberbandFreehandTool_setPrototypeOf(o, p);\n        }\n\n        function RubberbandFreehandTool_createSuper(Derived) {\n          var hasNativeReflectConstruct = RubberbandFreehandTool_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = RubberbandFreehandTool_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = RubberbandFreehandTool_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return RubberbandFreehandTool_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function RubberbandFreehandTool_possibleConstructorReturn(self, call) {\n          if (call && (RubberbandFreehandTool_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return RubberbandFreehandTool_assertThisInitialized(self);\n        }\n\n        function RubberbandFreehandTool_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function RubberbandFreehandTool_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function RubberbandFreehandTool_getPrototypeOf(o) {\n          RubberbandFreehandTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return RubberbandFreehandTool_getPrototypeOf(o);\n        }\n\n        function RubberbandFreehandTool_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * A rubberband selector for freehand fragments.\r\n         */\n\n\n        var RubberbandFreehandTool = /*#__PURE__*/function (_Tool) {\n          RubberbandFreehandTool_inherits(RubberbandFreehandTool, _Tool);\n\n          var _super = RubberbandFreehandTool_createSuper(RubberbandFreehandTool);\n\n          function RubberbandFreehandTool(g, config, env) {\n            var _this;\n\n            RubberbandFreehandTool_classCallCheck(this, RubberbandFreehandTool);\n            _this = _super.call(this, g, config, env);\n            RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\n              _this._isDrawing = true;\n\n              _this.attachListeners({\n                mouseMove: _this.onMouseMove,\n                mouseUp: _this.onMouseUp,\n                dblClick: _this.onDblClick\n              });\n\n              _this.rubberband = new RubberbandFreehand([x, y], _this.g, _this.env);\n            });\n            RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"stop\", function () {\n              _this.detachListeners();\n\n              _this._isDrawing = false;\n\n              if (_this.rubberband) {\n                _this.rubberband.destroy();\n\n                _this.rubberband = null;\n              }\n            });\n            RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\n              return _this.rubberband.dragTo([x, y]);\n            });\n            RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"onMouseUp\", function (x, y) {\n              _this.onDblClick(x, y);\n            });\n            RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"onDblClick\", function (x, y) {\n              _this._isDrawing = false;\n\n              _this.rubberband.addPoint([x, y]);\n\n              _this.detachListeners();\n\n              var _this$rubberband$getB = _this.rubberband.getBoundingClientRect(),\n                  width = _this$rubberband$getB.width,\n                  height = _this$rubberband$getB.height;\n\n              var minWidth = _this.config.minSelectionWidth || 4;\n              var minHeight = _this.config.minSelectionHeight || 4;\n\n              if (width >= minWidth || height >= minHeight) {\n                var shape = _this.rubberband.element;\n                shape.annotation = _this.rubberband.toSelection();\n\n                _this.emit('complete', shape);\n              } else {\n                _this.emit('cancel');\n              }\n\n              _this.stop();\n            });\n            RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\n              return new EditableFreehand(annotation, _this.g, _this.config, _this.env);\n            });\n            _this._isDrawing = false;\n            return _this;\n          }\n\n          RubberbandFreehandTool_createClass(RubberbandFreehandTool, [{\n            key: \"isDrawing\",\n            get: function get() {\n              return this._isDrawing;\n            }\n          }]);\n          return RubberbandFreehandTool;\n        }(Tool);\n\n        RubberbandFreehandTool.identifier = 'freehand';\n\n        RubberbandFreehandTool.supports = function (annotation) {\n          var selector = annotation.selector('SvgSelector');\n          if (selector) return selector.value.match(/^<svg.*<path*/g) && !selector.value.toUpperCase().includes('Z');\n        };\n\n        ; // CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/tools/polygon/PolygonMask.js\n\n        function PolygonMask_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function PolygonMask_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function PolygonMask_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) PolygonMask_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) PolygonMask_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function PolygonMask_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var PolygonMask = /*#__PURE__*/function () {\n          function PolygonMask(imageDimensions, polygon) {\n            var _this = this;\n\n            PolygonMask_classCallCheck(this, PolygonMask);\n            PolygonMask_defineProperty(this, \"redraw\", function () {\n              _this.mask.setAttribute('d', \"M0 0 h\".concat(_this.w, \" v\").concat(_this.h, \" h-\").concat(_this.w, \" z M\").concat(_this.polygon.getAttribute('points'), \" z\"));\n            });\n            PolygonMask_defineProperty(this, \"destroy\", function () {\n              return _this.mask.parentNode.removeChild(_this.mask);\n            });\n            this.w = imageDimensions.naturalWidth;\n            this.h = imageDimensions.naturalHeight;\n            this.polygon = polygon;\n            this.mask = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\n            this.mask.setAttribute('fill-rule', 'evenodd');\n            this.mask.setAttribute('class', 'a9s-selection-mask');\n            this.mask.setAttribute('d', \"M0 0 h\".concat(this.w, \" v\").concat(this.h, \" h-\").concat(this.w, \" z M\").concat(this.polygon.getAttribute('points'), \" z\"));\n          }\n\n          PolygonMask_createClass(PolygonMask, [{\n            key: \"element\",\n            get: function get() {\n              return this.mask;\n            }\n          }]);\n          return PolygonMask;\n        }();\n\n        ; // CONCATENATED MODULE: ./src/multipolygon/RubberbandMultipolygon.js\n\n        function RubberbandMultipolygon_ownKeys(object, enumerableOnly) {\n          var keys = Object.keys(object);\n\n          if (Object.getOwnPropertySymbols) {\n            var symbols = Object.getOwnPropertySymbols(object);\n            enumerableOnly && (symbols = symbols.filter(function (sym) {\n              return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n            })), keys.push.apply(keys, symbols);\n          }\n\n          return keys;\n        }\n\n        function RubberbandMultipolygon_objectSpread(target) {\n          for (var i = 1; i < arguments.length; i++) {\n            var source = null != arguments[i] ? arguments[i] : {};\n            i % 2 ? RubberbandMultipolygon_ownKeys(Object(source), !0).forEach(function (key) {\n              RubberbandMultipolygon_defineProperty(target, key, source[key]);\n            }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : RubberbandMultipolygon_ownKeys(Object(source)).forEach(function (key) {\n              Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n            });\n          }\n\n          return target;\n        }\n\n        function RubberbandMultipolygon_toConsumableArray(arr) {\n          return RubberbandMultipolygon_arrayWithoutHoles(arr) || RubberbandMultipolygon_iterableToArray(arr) || RubberbandMultipolygon_unsupportedIterableToArray(arr) || RubberbandMultipolygon_nonIterableSpread();\n        }\n\n        function RubberbandMultipolygon_nonIterableSpread() {\n          throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }\n\n        function RubberbandMultipolygon_iterableToArray(iter) {\n          if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n        }\n\n        function RubberbandMultipolygon_arrayWithoutHoles(arr) {\n          if (Array.isArray(arr)) return RubberbandMultipolygon_arrayLikeToArray(arr);\n        }\n\n        function RubberbandMultipolygon_createForOfIteratorHelper(o, allowArrayLike) {\n          var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n          if (!it) {\n            if (Array.isArray(o) || (it = RubberbandMultipolygon_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n              if (it) o = it;\n              var i = 0;\n\n              var F = function F() {};\n\n              return {\n                s: F,\n                n: function n() {\n                  if (i >= o.length) return {\n                    done: true\n                  };\n                  return {\n                    done: false,\n                    value: o[i++]\n                  };\n                },\n                e: function e(_e) {\n                  throw _e;\n                },\n                f: F\n              };\n            }\n\n            throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n          }\n\n          var normalCompletion = true,\n              didErr = false,\n              err;\n          return {\n            s: function s() {\n              it = it.call(o);\n            },\n            n: function n() {\n              var step = it.next();\n              normalCompletion = step.done;\n              return step;\n            },\n            e: function e(_e2) {\n              didErr = true;\n              err = _e2;\n            },\n            f: function f() {\n              try {\n                if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n              } finally {\n                if (didErr) throw err;\n              }\n            }\n          };\n        }\n\n        function RubberbandMultipolygon_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return RubberbandMultipolygon_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return RubberbandMultipolygon_arrayLikeToArray(o, minLen);\n        }\n\n        function RubberbandMultipolygon_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n\n        function RubberbandMultipolygon_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandMultipolygon_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandMultipolygon_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandMultipolygon_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandMultipolygon_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandMultipolygon_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        } // TODO optional: mask to dim the outside area\n        //import Mask from './multipolygonMask';\n\n        /**\r\n         * A 'rubberband' selection tool for creating multipolygon drawing by\r\n         * clicking and dragging.\r\n         */\n\n\n        var RubberbandMultipolygon = /*#__PURE__*/function () {\n          function RubberbandMultipolygon(anchor, g, env) {\n            var _this = this;\n\n            RubberbandMultipolygon_classCallCheck(this, RubberbandMultipolygon);\n            RubberbandMultipolygon_defineProperty(this, \"setPoints\", function (points) {\n              var attr = \"\";\n\n              var _iterator = RubberbandMultipolygon_createForOfIteratorHelper(points),\n                  _step;\n\n              try {\n                for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                  var ps = _step.value;\n                  var attr2 = \"\";\n\n                  if (ps.length > 0) {\n                    var _iterator2 = RubberbandMultipolygon_createForOfIteratorHelper(ps),\n                        _step2;\n\n                    try {\n                      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                        var p = _step2.value;\n\n                        if (p) {\n                          if (attr2 === \"\") {\n                            attr2 += \"M\".concat(p[0], \",\").concat(p[1]);\n                          } else {\n                            attr2 += \" L\".concat(p[0], \",\").concat(p[1]);\n                          }\n                        }\n                      }\n                    } catch (err) {\n                      _iterator2.e(err);\n                    } finally {\n                      _iterator2.f();\n                    }\n\n                    ;\n                    attr += attr2;\n                  }\n                }\n              } catch (err) {\n                _iterator.e(err);\n              } finally {\n                _iterator.f();\n              }\n\n              attr += \" Z\";\n\n              _this.outer.setAttribute('d', attr);\n\n              _this.inner.setAttribute('d', attr);\n            });\n            RubberbandMultipolygon_defineProperty(this, \"getBoundingClientRect\", function () {\n              return _this.outer.getBoundingClientRect();\n            });\n            RubberbandMultipolygon_defineProperty(this, \"dragTo\", function (xy) {\n              // Make visible\n              _this.group.style.display = null;\n\n              var head = _this.points[_this.points.length - 1].slice(0, _this.points[_this.points.length - 1].length - 1);\n\n              var headRest = _this.points.slice(0, -1);\n\n              var rubberband = [].concat(RubberbandMultipolygon_toConsumableArray(head), [xy, head[0]]);\n              headRest.push(rubberband);\n\n              _this.setPoints(headRest);\n\n              _this.mask.redraw();\n            });\n            RubberbandMultipolygon_defineProperty(this, \"addPoint\", function (xy) {\n              // Don't add a new point if distance < 2 pixels\n              if (_this.points[_this.points.length - 1].length > 0) {\n                var head = _this.points[_this.points.length - 1].slice(0, _this.points[_this.points.length - 1].length - 1);\n\n                var lastCorner = head[head.length - 1];\n                var dist = Math.pow(xy[0] - lastCorner[0], 2) + Math.pow(xy[1] - lastCorner[1], 2);\n\n                if (dist > 4) {\n                  _this.points[_this.points.length - 1] = [].concat(RubberbandMultipolygon_toConsumableArray(head), [xy, head[0]]);\n\n                  _this.setPoints(_this.points);\n\n                  _this.mask.redraw();\n                }\n              } else {\n                _this.points[_this.points.length - 1] = [xy, xy];\n\n                _this.setPoints(_this.points);\n              }\n            });\n            RubberbandMultipolygon_defineProperty(this, \"undo\", function () {\n              if (_this.points[_this.points.length - 1].length > 2) {\n                _this.points[_this.points.length - 1].pop();\n              } else {\n                if (_this.points.length > 1) {\n                  _this.points.pop();\n                }\n              }\n            });\n            RubberbandMultipolygon_defineProperty(this, \"newPart\", function () {\n              _this.points.push([]);\n            });\n            RubberbandMultipolygon_defineProperty(this, \"destroy\", function () {\n              _this.group.parentNode.removeChild(_this.group);\n\n              _this.multipolygon = null;\n              _this.group = null;\n            });\n            RubberbandMultipolygon_defineProperty(this, \"toSelection\", function () {\n              return new Selection(RubberbandMultipolygon_objectSpread(RubberbandMultipolygon_objectSpread({}, toSVGTarget(_this.group, _this.env.image)), {}, {\n                renderedVia: {\n                  name: 'multipolygon'\n                }\n              }));\n            });\n            this.points = [];\n            this.points.push([anchor, anchor]);\n            this.env = env;\n            this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            this.multipolygon = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            this.multipolygon.setAttribute('class', 'a9s-selection');\n            this.outer = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\n            this.outer.setAttribute('class', 'a9s-outer');\n            this.inner = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\n            this.inner.setAttribute('class', 'a9s-inner');\n            this.setPoints(this.points);\n            this.mask = new PolygonMask(env.image, this.inner); // TODO optional: mask to dim the outside area\n            // this.mask = new Mask(env.image, this.inner);\n\n            this.multipolygon.appendChild(this.outer);\n            this.multipolygon.appendChild(this.inner); // Additionally, selection remains hidden until \n            // the user actually moves the mouse\n\n            this.group.style.display = 'none'; // TODO optional: mask to dim the outside area\n            // this.group.appendChild(this.mask.element);\n\n            this.group.appendChild(this.mask.element);\n            this.group.appendChild(this.multipolygon);\n            g.appendChild(this.group);\n          }\n\n          RubberbandMultipolygon_createClass(RubberbandMultipolygon, [{\n            key: \"element\",\n            get: function get() {\n              return this.multipolygon;\n            }\n          }]);\n          return RubberbandMultipolygon;\n        }();\n\n        ; // CONCATENATED MODULE: ./src/multipolygon/EditableMultipolygon.js\n\n        function EditableMultipolygon_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return EditableMultipolygon_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, EditableMultipolygon_typeof(obj);\n        }\n\n        function EditableMultipolygon_ownKeys(object, enumerableOnly) {\n          var keys = Object.keys(object);\n\n          if (Object.getOwnPropertySymbols) {\n            var symbols = Object.getOwnPropertySymbols(object);\n            enumerableOnly && (symbols = symbols.filter(function (sym) {\n              return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n            })), keys.push.apply(keys, symbols);\n          }\n\n          return keys;\n        }\n\n        function EditableMultipolygon_objectSpread(target) {\n          for (var i = 1; i < arguments.length; i++) {\n            var source = null != arguments[i] ? arguments[i] : {};\n            i % 2 ? EditableMultipolygon_ownKeys(Object(source), !0).forEach(function (key) {\n              EditableMultipolygon_defineProperty(target, key, source[key]);\n            }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : EditableMultipolygon_ownKeys(Object(source)).forEach(function (key) {\n              Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n            });\n          }\n\n          return target;\n        }\n\n        function EditableMultipolygon_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function EditableMultipolygon_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function EditableMultipolygon_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) EditableMultipolygon_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) EditableMultipolygon_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function EditableMultipolygon_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) EditableMultipolygon_setPrototypeOf(subClass, superClass);\n        }\n\n        function EditableMultipolygon_setPrototypeOf(o, p) {\n          EditableMultipolygon_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return EditableMultipolygon_setPrototypeOf(o, p);\n        }\n\n        function EditableMultipolygon_createSuper(Derived) {\n          var hasNativeReflectConstruct = EditableMultipolygon_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = EditableMultipolygon_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = EditableMultipolygon_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return EditableMultipolygon_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function EditableMultipolygon_possibleConstructorReturn(self, call) {\n          if (call && (EditableMultipolygon_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return EditableMultipolygon_assertThisInitialized(self);\n        }\n\n        function EditableMultipolygon_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function EditableMultipolygon_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function EditableMultipolygon_get() {\n          if (typeof Reflect !== \"undefined\" && Reflect.get) {\n            EditableMultipolygon_get = Reflect.get.bind();\n          } else {\n            EditableMultipolygon_get = function _get(target, property, receiver) {\n              var base = EditableMultipolygon_superPropBase(target, property);\n              if (!base) return;\n              var desc = Object.getOwnPropertyDescriptor(base, property);\n\n              if (desc.get) {\n                return desc.get.call(arguments.length < 3 ? target : receiver);\n              }\n\n              return desc.value;\n            };\n          }\n\n          return EditableMultipolygon_get.apply(this, arguments);\n        }\n\n        function EditableMultipolygon_superPropBase(object, property) {\n          while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = EditableMultipolygon_getPrototypeOf(object);\n            if (object === null) break;\n          }\n\n          return object;\n        }\n\n        function EditableMultipolygon_getPrototypeOf(o) {\n          EditableMultipolygon_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return EditableMultipolygon_getPrototypeOf(o);\n        }\n\n        function EditableMultipolygon_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        function EditableMultipolygon_createForOfIteratorHelper(o, allowArrayLike) {\n          var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n          if (!it) {\n            if (Array.isArray(o) || (it = EditableMultipolygon_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n              if (it) o = it;\n              var i = 0;\n\n              var F = function F() {};\n\n              return {\n                s: F,\n                n: function n() {\n                  if (i >= o.length) return {\n                    done: true\n                  };\n                  return {\n                    done: false,\n                    value: o[i++]\n                  };\n                },\n                e: function e(_e) {\n                  throw _e;\n                },\n                f: F\n              };\n            }\n\n            throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n          }\n\n          var normalCompletion = true,\n              didErr = false,\n              err;\n          return {\n            s: function s() {\n              it = it.call(o);\n            },\n            n: function n() {\n              var step = it.next();\n              normalCompletion = step.done;\n              return step;\n            },\n            e: function e(_e2) {\n              didErr = true;\n              err = _e2;\n            },\n            f: function f() {\n              try {\n                if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n              } finally {\n                if (didErr) throw err;\n              }\n            }\n          };\n        }\n\n        function EditableMultipolygon_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return EditableMultipolygon_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EditableMultipolygon_arrayLikeToArray(o, minLen);\n        }\n\n        function EditableMultipolygon_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        } // TODO optional: mask to dim the outside area\n        //import Mask from './MultipolygonMask';\n\n\n        var EditableMultipolygon_getPoints = function getPoints(shape) {\n          // Could just be Array.from(shape.querySelector('.inner').points) but...\n          // IE11 :-(\n          var pointLists = getPointsFromPathValue(shape.querySelector('.a9s-inner').attributes.d.nodeValue);\n          var pointArray = [];\n\n          var _iterator = EditableMultipolygon_createForOfIteratorHelper(pointLists),\n              _step;\n\n          try {\n            for (_iterator.s(); !(_step = _iterator.n()).done;) {\n              var pointList = _step.value;\n              var points = [];\n\n              var _iterator2 = EditableMultipolygon_createForOfIteratorHelper(pointList),\n                  _step2;\n\n              try {\n                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                  var point = _step2.value;\n                  var p = {\n                    x: parseFloat(point[0]),\n                    y: parseFloat(point[1])\n                  };\n                  points.push(p);\n                }\n              } catch (err) {\n                _iterator2.e(err);\n              } finally {\n                _iterator2.f();\n              }\n\n              pointArray.push(points);\n            }\n          } catch (err) {\n            _iterator.e(err);\n          } finally {\n            _iterator.f();\n          }\n\n          return pointArray;\n        };\n\n        var getPointsFromPathValue = function getPointsFromPathValue(polygon) {\n          var results = polygon.split('M');\n          var allcoords = [];\n          results.forEach(function (result, index) {\n            if (result.length > 0) {\n              var coords = [];\n              result = result.replace(/ Z/g, \"Z\");\n              result = result.replace(/Z /g, \"Z\");\n              result = result.replace(/Z/g, \"\");\n              result = result.replace(/L /g, \"L\");\n              result = result.replace(/ L/g, \"L\");\n              var coordsString = result.split(\"L\");\n              coordsString.forEach(function (coord, index) {\n                coords.push([parseFloat(coord.split(\",\")[0]).toFixed(2).toString(), parseFloat(coord.split(\",\")[1]).toFixed(2).toString()]);\n              });\n\n              if (coords[0] !== coords[coords.length - 1]) {\n                coords.push(coords[0]);\n              }\n\n              allcoords.push(coords);\n            }\n          });\n          return allcoords;\n        };\n\n        var EditableMultipolygon_getBBox = function getBBox(shape) {\n          return shape.querySelector('.a9s-inner').getBBox();\n        };\n\n        var svgFragmentToPoints = function svgFragmentToPoints(annotation) {\n          var svgShape = svgFragmentToShape(annotation);\n          var polygon = svgShape.getAttribute('d');\n          var allcoords = getPointsFromPathValue(polygon);\n          return allcoords; //svgShape.getAttribute('d')\n          //  .split(' ') // Split x/y tuples\n          //  .map(xy => xy.split(',').map(str => parseFloat(str.trim())));\n        };\n\n        var EditableMultipolygon_drawEmbeddedSVG = function drawEmbeddedSVG(annotation) {\n          var shape = svgFragmentToShape(annotation); // Hack\n\n          svgFragmentToPoints(annotation); // Because we're nitpicky, we don't just draw the shape,\n          // but duplicate it, so we can have inner and an outer lines\n\n          var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n          var inner = shape.cloneNode(true);\n          inner.setAttribute('class', 'a9s-inner');\n          var outer = shape.cloneNode(true);\n          outer.setAttribute('class', 'a9s-outer');\n          g.appendChild(outer);\n          g.appendChild(inner);\n          return g;\n        };\n        /**\r\n         * An editable multipolygon drawing.\r\n         */\n\n\n        var EditableMultipolygon = /*#__PURE__*/function (_EditableShape) {\n          EditableMultipolygon_inherits(EditableMultipolygon, _EditableShape);\n\n          var _super = EditableMultipolygon_createSuper(EditableMultipolygon);\n\n          function EditableMultipolygon(_annotation, g, config, env) {\n            var _thisSuper, _this;\n\n            EditableMultipolygon_classCallCheck(this, EditableMultipolygon);\n            _this = _super.call(this, _annotation, g, config, env);\n            EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"setPoints\", function (points) {\n              var round = function round(num) {\n                return Math.round(10 * num) / 10;\n              };\n\n              var str = \"\";\n\n              var _iterator3 = EditableMultipolygon_createForOfIteratorHelper(points),\n                  _step3;\n\n              try {\n                for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                  var pointList = _step3.value;\n                  str += \"M\";\n                  var first = true;\n\n                  var _iterator4 = EditableMultipolygon_createForOfIteratorHelper(pointList),\n                      _step4;\n\n                  try {\n                    for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n                      var point = _step4.value;\n\n                      if (first) {\n                        first = false;\n                        str += point.x.toString() + \",\" + point.y.toString();\n                      } else {\n                        str += \" L\" + round(point.x).toString() + \",\" + round(point.y).toString();\n                      }\n                    }\n                  } catch (err) {\n                    _iterator4.e(err);\n                  } finally {\n                    _iterator4.f();\n                  }\n\n                  str += \" Z\";\n                }\n              } catch (err) {\n                _iterator3.e(err);\n              } finally {\n                _iterator3.f();\n              }\n\n              var inner = _this.shape.querySelector('.a9s-inner');\n\n              inner.setAttribute('d', str);\n\n              var outer = _this.shape.querySelector('.a9s-outer');\n\n              outer.setAttribute('d', str); // this.mask.redraw();\n\n              var _outer$getBBox = outer.getBBox(),\n                  x = _outer$getBBox.x,\n                  y = _outer$getBBox.y,\n                  width = _outer$getBBox.width,\n                  height = _outer$getBBox.height;\n\n              setFormatterElSize(_this.elementGroup, x, y, width, height);\n            });\n            EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\n              return function (evt) {\n                _this.grabbedElem = grabbedElem;\n\n                var pos = _this.getSVGPoint(evt);\n\n                _this.grabbedAt = {\n                  x: pos.x,\n                  y: pos.y\n                };\n              };\n            });\n            EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\n              if (_this.grabbedElem) {\n                (function () {\n                  var pos = _this.getSVGPoint(evt);\n\n                  if (_this.grabbedElem === _this.shape) {\n                    (function () {\n                      var dx = pos.x - _this.grabbedAt.x;\n                      var dy = pos.y - _this.grabbedAt.y;\n                      var pointList = EditableMultipolygon_getPoints(_this.shape);\n                      var updatedPoints = [];\n\n                      var _iterator5 = EditableMultipolygon_createForOfIteratorHelper(pointList),\n                          _step5;\n\n                      try {\n                        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n                          var points = _step5.value;\n                          updatedPoints.push(points.map(function (pt) {\n                            return {\n                              x: pt.x + dx,\n                              y: pt.y + dy\n                            };\n                          }));\n                        }\n                      } catch (err) {\n                        _iterator5.e(err);\n                      } finally {\n                        _iterator5.f();\n                      }\n\n                      _this.grabbedAt = pos;\n\n                      _this.setPoints(updatedPoints);\n\n                      var i = 0;\n\n                      for (var _i = 0, _updatedPoints = updatedPoints; _i < _updatedPoints.length; _i++) {\n                        var updatedPointsList = _updatedPoints[_i];\n                        updatedPointsList.forEach(function (pt, idx) {\n                          if (_this.handles[i][idx] !== undefined) _this.setHandleXY(_this.handles[i][idx], pt.x, pt.y);\n                        });\n                        i += 1;\n                      }\n\n                      _this.emit('update', EditableMultipolygon_objectSpread(EditableMultipolygon_objectSpread({}, toSVGTarget(_this.shape, _this.env.image)), {}, {\n                        renderedVia: {\n                          name: 'multipolygon'\n                        }\n                      }));\n                    })();\n                  } else {\n                    (function () {\n                      var handleIdx = -1;\n                      var pointListIDX = 0;\n                      var found = false;\n\n                      var _iterator6 = EditableMultipolygon_createForOfIteratorHelper(_this.handles),\n                          _step6;\n\n                      try {\n                        for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\n                          var handle = _step6.value;\n\n                          if (handle.indexOf(_this.grabbedElem) > 0) {\n                            handleIdx = handle.indexOf(_this.grabbedElem);\n                            found = true;\n                          } else {\n                            if (!found) {\n                              pointListIDX += 1;\n                            }\n                          }\n                        }\n                      } catch (err) {\n                        _iterator6.e(err);\n                      } finally {\n                        _iterator6.f();\n                      }\n\n                      var pointList = EditableMultipolygon_getPoints(_this.shape);\n                      var updatedPoints = [];\n                      var updatedPointsIDX = 0;\n\n                      var _iterator7 = EditableMultipolygon_createForOfIteratorHelper(pointList),\n                          _step7;\n\n                      try {\n                        for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\n                          var points = _step7.value;\n\n                          if (updatedPointsIDX === pointListIDX) {\n                            (function () {\n                              var newPoints = [];\n                              points.forEach(function (value, i) {\n                                if (i === handleIdx) {\n                                  newPoints.push(pos);\n                                } else {\n                                  newPoints.push(value);\n                                }\n                              });\n                              updatedPoints.push(newPoints);\n                            })();\n                          } else {\n                            updatedPoints.push(points);\n                          }\n\n                          updatedPointsIDX += 1;\n                        }\n                      } catch (err) {\n                        _iterator7.e(err);\n                      } finally {\n                        _iterator7.f();\n                      }\n\n                      _this.setPoints(updatedPoints);\n\n                      updatedPointsIDX = 0;\n\n                      var _iterator8 = EditableMultipolygon_createForOfIteratorHelper(_this.handles),\n                          _step8;\n\n                      try {\n                        for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\n                          var _handle = _step8.value;\n\n                          if (updatedPointsIDX === pointListIDX) {\n                            _this.setHandleXY(_handle[handleIdx], pos.x, pos.y);\n                          }\n\n                          updatedPointsIDX += 1;\n                        }\n                      } catch (err) {\n                        _iterator8.e(err);\n                      } finally {\n                        _iterator8.f();\n                      }\n\n                      _this.emit('update', EditableMultipolygon_objectSpread(EditableMultipolygon_objectSpread({}, toSVGTarget(_this.shape, _this.env.image)), {}, {\n                        renderedVia: {\n                          name: 'multipolygon'\n                        }\n                      }));\n                    })();\n                  }\n                })();\n              }\n            });\n            EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"onMouseUp\", function (evt) {\n              _this.grabbedElem = null;\n              _this.grabbedAt = null;\n            });\n            EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"updateState\", function (annotation) {\n              var points = EditableMultipolygon_getPoints(svgFragmentToShape(annotation));\n\n              _this.setPoints(points);\n            });\n            EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"destroy\", function () {\n              _this.containerGroup.parentNode.removeChild(_this.containerGroup);\n\n              EditableMultipolygon_get((_thisSuper = EditableMultipolygon_assertThisInitialized(_this), EditableMultipolygon_getPrototypeOf(EditableMultipolygon.prototype)), \"destroy\", _thisSuper).call(_thisSuper);\n            });\n\n            _this.svg.addEventListener('mousemove', _this.onMouseMove);\n\n            _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\n            // \n            // <g>\n            //   <path class=\"a9s-selection mask\"... />\n            //   <g> <-- return this node as .element\n            //     <polygon class=\"a9s-outer\" ... />\n            //     <polygon class=\"a9s-inner\" ... />\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     ...\n            //   </g> \n            // </g>\n            // 'g' for the editable free drawing compound shape\n\n\n            _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            _this.shape = EditableMultipolygon_drawEmbeddedSVG(_annotation); // TODO optional: mask to dim the outside area\n            // this.mask = new Mask(env.image, this.shape.querySelector('.a9s-inner'));\n            // this.containerGroup.appendChild(this.mask.element);\n\n            _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n\n            _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n\n            _this.elementGroup.appendChild(_this.shape);\n\n            var _pointList = EditableMultipolygon_getPoints(_this.shape);\n\n            _this.handles = [];\n\n            var _iterator9 = EditableMultipolygon_createForOfIteratorHelper(_pointList),\n                _step9;\n\n            try {\n              for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\n                var points = _step9.value;\n\n                _this.handles.push(points.map(function (pt) {\n                  var handle = _this.drawHandle(pt.x, pt.y);\n\n                  handle.addEventListener('mousedown', _this.onGrab(handle));\n\n                  _this.elementGroup.appendChild(handle);\n\n                  return handle;\n                }));\n              }\n            } catch (err) {\n              _iterator9.e(err);\n            } finally {\n              _iterator9.f();\n            }\n\n            _this.containerGroup.appendChild(_this.elementGroup);\n\n            g.appendChild(_this.containerGroup);\n            format(_this.shape, _annotation, config.formatter);\n\n            _this.shape.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.shape));\n\n            var _getBBox = EditableMultipolygon_getBBox(_this.shape),\n                _x = _getBBox.x,\n                _y = _getBBox.y,\n                _width = _getBBox.width,\n                _height = _getBBox.height; // TODO optional: handles to stretch the shape\n\n            /*    this.handles = [\r\n                  [ x, y ], \r\n                  [ x + width, y ], \r\n                  [ x + width, y + height ], \r\n                  [ x, y + height ]\r\n                ].map(t => { \r\n                  const [ x, y ] = t;\r\n                  const handle = this.drawHandle(x, y);\r\n            \r\n                  handle.addEventListener('mousedown', this.onGrab(handle));\r\n                  this.elementGroup.appendChild(handle);\r\n            \r\n                  return handle;\r\n                });*/\n            // The grabbed element (handle or entire shape), if any\n\n\n            _this.grabbedElem = null; // Mouse grab point\n\n            _this.grabbedAt = null;\n            return _this;\n          }\n\n          EditableMultipolygon_createClass(EditableMultipolygon, [{\n            key: \"element\",\n            get: function get() {\n              return this.elementGroup;\n            }\n          }]);\n          return EditableMultipolygon;\n        }(EditableShape);\n\n        ; // CONCATENATED MODULE: ./src/multipolygon/RubberbandMultipolygonTool.js\n\n        function RubberbandMultipolygonTool_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return RubberbandMultipolygonTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, RubberbandMultipolygonTool_typeof(obj);\n        }\n\n        function RubberbandMultipolygonTool_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandMultipolygonTool_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandMultipolygonTool_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandMultipolygonTool_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandMultipolygonTool_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandMultipolygonTool_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) RubberbandMultipolygonTool_setPrototypeOf(subClass, superClass);\n        }\n\n        function RubberbandMultipolygonTool_setPrototypeOf(o, p) {\n          RubberbandMultipolygonTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return RubberbandMultipolygonTool_setPrototypeOf(o, p);\n        }\n\n        function RubberbandMultipolygonTool_createSuper(Derived) {\n          var hasNativeReflectConstruct = RubberbandMultipolygonTool_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = RubberbandMultipolygonTool_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = RubberbandMultipolygonTool_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return RubberbandMultipolygonTool_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function RubberbandMultipolygonTool_possibleConstructorReturn(self, call) {\n          if (call && (RubberbandMultipolygonTool_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return RubberbandMultipolygonTool_assertThisInitialized(self);\n        }\n\n        function RubberbandMultipolygonTool_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function RubberbandMultipolygonTool_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function RubberbandMultipolygonTool_getPrototypeOf(o) {\n          RubberbandMultipolygonTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return RubberbandMultipolygonTool_getPrototypeOf(o);\n        }\n\n        function RubberbandMultipolygonTool_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * A rubberband selector for Multipolygon fragments.\r\n         */\n\n\n        var RubberbandMultipolygonTool = /*#__PURE__*/function (_Tool) {\n          RubberbandMultipolygonTool_inherits(RubberbandMultipolygonTool, _Tool);\n\n          var _super = RubberbandMultipolygonTool_createSuper(RubberbandMultipolygonTool);\n\n          function RubberbandMultipolygonTool(g, config, env) {\n            var _this;\n\n            RubberbandMultipolygonTool_classCallCheck(this, RubberbandMultipolygonTool);\n            _this = _super.call(this, g, config, env);\n            RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\n              _this._isDrawing = true;\n\n              _this.attachListeners({\n                mouseMove: _this.onMouseMove,\n                mouseUp: _this.onMouseUp,\n                dblClick: _this.onDblClick\n              });\n\n              _this.rubberband = new RubberbandMultipolygon([x, y], _this.g, _this.env);\n            });\n            RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"stop\", function () {\n              _this.detachListeners();\n\n              _this._isDrawing = false;\n\n              if (_this.rubberband) {\n                _this.rubberband.destroy();\n\n                _this.rubberband = null;\n              }\n            });\n            RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"undo\", function () {\n              if (_this.rubberband) {\n                _this.rubberband.undo();\n              }\n            });\n            RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"newPart\", function () {\n              if (_this.rubberband) {\n                _this.rubberband.newPart();\n              }\n            });\n            RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\n              return _this.rubberband.dragTo([x, y]);\n            });\n            RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"onMouseUp\", function (x, y, evt) {\n              if (evt.altKey) {\n                _this.onDblClick(evt);\n              } else if (evt.ctrlKey) {\n                _this.rubberband.undo();\n              } else {\n                var _this$rubberband$getB = _this.rubberband.getBoundingClientRect(),\n                    width = _this$rubberband$getB.width,\n                    height = _this$rubberband$getB.height;\n\n                var minWidth = _this.config.minSelectionWidth || 4;\n                var minHeight = _this.config.minSelectionHeight || 4;\n\n                if (width >= minWidth || height >= minHeight) {\n                  _this.rubberband.addPoint([x, y]);\n                } else {\n                  _this.emit('cancel');\n\n                  _this.stop();\n                }\n              }\n            });\n            RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"onDblClick\", function (x, y) {\n              _this._isDrawing = false;\n\n              _this.rubberband.addPoint([x, y]);\n\n              var shape = _this.rubberband.element;\n              shape.annotation = _this.rubberband.toSelection();\n\n              _this.emit('complete', shape);\n\n              _this.stop();\n            });\n            RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\n              return new EditableMultipolygon(annotation, _this.g, _this.config, _this.env);\n            });\n            _this._isDrawing = false;\n            document.addEventListener('keydown', function (evt) {\n              if (evt.key == \"z\" && evt.ctrlKey) {\n                _this.undo();\n              }\n\n              if (evt.key == 'n') {\n                _this.newPart();\n              }\n            });\n            return _this;\n          }\n\n          RubberbandMultipolygonTool_createClass(RubberbandMultipolygonTool, [{\n            key: \"isDrawing\",\n            get: function get() {\n              return this._isDrawing;\n            }\n          }]);\n          return RubberbandMultipolygonTool;\n        }(Tool);\n\n        RubberbandMultipolygonTool.identifier = 'multipolygon';\n\n        RubberbandMultipolygonTool.supports = function (annotation) {\n          return false;\n        };\n\n        ; // CONCATENATED MODULE: ./src/line/LineMask.js\n\n        function LineMask_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function LineMask_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function LineMask_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) LineMask_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) LineMask_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function LineMask_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var LineMask = /*#__PURE__*/function () {\n          function LineMask(imageDimensions, line) {\n            var _this = this;\n\n            LineMask_classCallCheck(this, LineMask);\n            LineMask_defineProperty(this, \"redraw\", function () {\n              _this.mask.setAttribute('d', \"M0 0 h\".concat(_this.w, \" v\").concat(_this.h, \" h-\").concat(_this.w, \" z M\").concat(_this.line.getAttribute('x1'), \" \").concat(_this.line.getAttribute('y1'), \" \").concat(_this.line.getAttribute('x2'), \" \").concat(_this.line.getAttribute('y2'), \"z\"));\n            });\n            LineMask_defineProperty(this, \"destroy\", function () {\n              return _this.mask.parentNode.removeChild(_this.mask);\n            });\n            this.w = imageDimensions.naturalWidth;\n            this.h = imageDimensions.naturalHeight;\n            this.line = line;\n            this.mask = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\n            this.mask.setAttribute('fill-rule', 'evenodd');\n            this.mask.setAttribute('class', 'a9s-selection-mask');\n            this.mask.setAttribute('d', \"M0 0 h\".concat(this.w, \" v\").concat(this.h, \" h-\").concat(this.w, \" z M\").concat(this.line.getAttribute('x1'), \" \").concat(this.line.getAttribute('y1'), \" z\"));\n          }\n\n          LineMask_createClass(LineMask, [{\n            key: \"element\",\n            get: function get() {\n              return this.mask;\n            }\n          }]);\n          return LineMask;\n        }();\n\n        ; // CONCATENATED MODULE: ./src/line/RubberbandLine.js\n\n        function RubberbandLine_ownKeys(object, enumerableOnly) {\n          var keys = Object.keys(object);\n\n          if (Object.getOwnPropertySymbols) {\n            var symbols = Object.getOwnPropertySymbols(object);\n            enumerableOnly && (symbols = symbols.filter(function (sym) {\n              return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n            })), keys.push.apply(keys, symbols);\n          }\n\n          return keys;\n        }\n\n        function RubberbandLine_objectSpread(target) {\n          for (var i = 1; i < arguments.length; i++) {\n            var source = null != arguments[i] ? arguments[i] : {};\n            i % 2 ? RubberbandLine_ownKeys(Object(source), !0).forEach(function (key) {\n              RubberbandLine_defineProperty(target, key, source[key]);\n            }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : RubberbandLine_ownKeys(Object(source)).forEach(function (key) {\n              Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n            });\n          }\n\n          return target;\n        }\n\n        function RubberbandLine_toConsumableArray(arr) {\n          return RubberbandLine_arrayWithoutHoles(arr) || RubberbandLine_iterableToArray(arr) || RubberbandLine_unsupportedIterableToArray(arr) || RubberbandLine_nonIterableSpread();\n        }\n\n        function RubberbandLine_nonIterableSpread() {\n          throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }\n\n        function RubberbandLine_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return RubberbandLine_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return RubberbandLine_arrayLikeToArray(o, minLen);\n        }\n\n        function RubberbandLine_iterableToArray(iter) {\n          if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n        }\n\n        function RubberbandLine_arrayWithoutHoles(arr) {\n          if (Array.isArray(arr)) return RubberbandLine_arrayLikeToArray(arr);\n        }\n\n        function RubberbandLine_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n\n        function RubberbandLine_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandLine_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandLine_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandLine_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandLine_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandLine_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * A 'rubberband' selection tool for creating Line drawing by\r\n         * clicking and dragging.\r\n         */\n\n\n        var RubberbandLine = /*#__PURE__*/function () {\n          function RubberbandLine(anchor, g, env) {\n            var _this = this;\n\n            RubberbandLine_classCallCheck(this, RubberbandLine);\n            RubberbandLine_defineProperty(this, \"setPoints\", function (points) {\n              var attr = points; // set attribute for line svg element for outer and inner\n              // example: <line x1=\"0\" y1=\"80\" x2=\"100\" y2=\"20\" stroke=\"black\" />\n\n              _this.outer.setAttribute('x1', attr[0]);\n\n              _this.inner.setAttribute('x1', attr[0]);\n\n              _this.outer.setAttribute('y1', attr[1]);\n\n              _this.inner.setAttribute('y1', attr[1]);\n\n              if (attr.length > 2) {\n                _this.outer.setAttribute('x2', attr[2]);\n\n                _this.inner.setAttribute('x2', attr[2]);\n\n                _this.outer.setAttribute('y2', attr[3]);\n\n                _this.inner.setAttribute('y2', attr[3]);\n              }\n            });\n            RubberbandLine_defineProperty(this, \"getBoundingClientRect\", function () {\n              return _this.outer.getBoundingClientRect();\n            });\n            RubberbandLine_defineProperty(this, \"dragTo\", function (xy) {\n              // Make visible\n              _this.group.style.display = null;\n              _this.mousepos = xy; //console.log(xy);\n\n              var rubberband = [].concat(RubberbandLine_toConsumableArray(_this.points), [xy[0], xy[1]]);\n\n              _this.setPoints(rubberband);\n\n              _this.mask.redraw();\n            });\n            RubberbandLine_defineProperty(this, \"addPoint\", function (xy) {\n              // Don't add a new point if distance < 2 pixels\n              if (_this.points.length <= 2) {\n                _this.points[2] = xy[0];\n                _this.points[3] = xy[1];\n\n                _this.setPoints(_this.points);\n              }\n            });\n            RubberbandLine_defineProperty(this, \"undo\", function () {\n              if (_this.points[_this.points.length - 1].length > 2) {\n                _this.points[_this.points.length - 1].pop();\n              } else {\n                if (_this.points.length > 1) {\n                  _this.points.pop();\n                }\n              }\n            });\n            RubberbandLine_defineProperty(this, \"newPart\", function () {\n              _this.points.push([]);\n            });\n            RubberbandLine_defineProperty(this, \"destroy\", function () {\n              _this.group.parentNode.removeChild(_this.group);\n\n              _this.Line = null;\n              _this.group = null;\n            });\n            RubberbandLine_defineProperty(this, \"toSelection\", function () {\n              return new Selection(RubberbandLine_objectSpread(RubberbandLine_objectSpread({}, toSVGTarget(_this.group, _this.env.image)), {}, {\n                renderedVia: {\n                  name: 'line'\n                }\n              }));\n            });\n            this.points = anchor; //this.points.push([ anchor, anchor ])\n\n            this.env = env;\n            this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            this.Line = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            this.Line.setAttribute('class', 'a9s-selection');\n            this.outer = document.createElementNS(SVG_SVG_NAMESPACE, 'line');\n            this.outer.setAttribute('class', 'a9s-outer');\n            this.inner = document.createElementNS(SVG_SVG_NAMESPACE, 'line');\n            this.inner.setAttribute('class', 'a9s-inner');\n            this.setPoints(this.points);\n            this.mask = new LineMask(env.image, this.inner); // TODO optional: mask to dim the outside area\n            // this.mask = new Mask(env.image, this.inner);\n\n            this.Line.appendChild(this.outer);\n            this.Line.appendChild(this.inner); // Additionally, selection remains hidden until \n            // the user actually moves the mouse\n\n            this.group.style.display = 'none'; // TODO optional: mask to dim the outside area\n            // this.group.appendChild(this.mask.element);\n\n            this.group.appendChild(this.mask.element);\n            this.group.appendChild(this.Line);\n            g.appendChild(this.group);\n          }\n\n          RubberbandLine_createClass(RubberbandLine, [{\n            key: \"element\",\n            get: function get() {\n              return this.Line;\n            }\n          }]);\n          return RubberbandLine;\n        }();\n\n        ; // CONCATENATED MODULE: ./src/line/EditableLine.js\n\n        function EditableLine_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return EditableLine_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, EditableLine_typeof(obj);\n        }\n\n        function EditableLine_slicedToArray(arr, i) {\n          return EditableLine_arrayWithHoles(arr) || EditableLine_iterableToArrayLimit(arr, i) || EditableLine_unsupportedIterableToArray(arr, i) || EditableLine_nonIterableRest();\n        }\n\n        function EditableLine_nonIterableRest() {\n          throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }\n\n        function EditableLine_unsupportedIterableToArray(o, minLen) {\n          if (!o) return;\n          if (typeof o === \"string\") return EditableLine_arrayLikeToArray(o, minLen);\n          var n = Object.prototype.toString.call(o).slice(8, -1);\n          if (n === \"Object\" && o.constructor) n = o.constructor.name;\n          if (n === \"Map\" || n === \"Set\") return Array.from(o);\n          if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EditableLine_arrayLikeToArray(o, minLen);\n        }\n\n        function EditableLine_arrayLikeToArray(arr, len) {\n          if (len == null || len > arr.length) len = arr.length;\n\n          for (var i = 0, arr2 = new Array(len); i < len; i++) {\n            arr2[i] = arr[i];\n          }\n\n          return arr2;\n        }\n\n        function EditableLine_iterableToArrayLimit(arr, i) {\n          var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n          if (_i == null) return;\n          var _arr = [];\n          var _n = true;\n          var _d = false;\n\n          var _s, _e;\n\n          try {\n            for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n              _arr.push(_s.value);\n\n              if (i && _arr.length === i) break;\n            }\n          } catch (err) {\n            _d = true;\n            _e = err;\n          } finally {\n            try {\n              if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n            } finally {\n              if (_d) throw _e;\n            }\n          }\n\n          return _arr;\n        }\n\n        function EditableLine_arrayWithHoles(arr) {\n          if (Array.isArray(arr)) return arr;\n        }\n\n        function EditableLine_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function EditableLine_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function EditableLine_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) EditableLine_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) EditableLine_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function EditableLine_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) EditableLine_setPrototypeOf(subClass, superClass);\n        }\n\n        function EditableLine_setPrototypeOf(o, p) {\n          EditableLine_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return EditableLine_setPrototypeOf(o, p);\n        }\n\n        function EditableLine_createSuper(Derived) {\n          var hasNativeReflectConstruct = EditableLine_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = EditableLine_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = EditableLine_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return EditableLine_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function EditableLine_possibleConstructorReturn(self, call) {\n          if (call && (EditableLine_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return EditableLine_assertThisInitialized(self);\n        }\n\n        function EditableLine_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function EditableLine_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function EditableLine_get() {\n          if (typeof Reflect !== \"undefined\" && Reflect.get) {\n            EditableLine_get = Reflect.get.bind();\n          } else {\n            EditableLine_get = function _get(target, property, receiver) {\n              var base = EditableLine_superPropBase(target, property);\n              if (!base) return;\n              var desc = Object.getOwnPropertyDescriptor(base, property);\n\n              if (desc.get) {\n                return desc.get.call(arguments.length < 3 ? target : receiver);\n              }\n\n              return desc.value;\n            };\n          }\n\n          return EditableLine_get.apply(this, arguments);\n        }\n\n        function EditableLine_superPropBase(object, property) {\n          while (!Object.prototype.hasOwnProperty.call(object, property)) {\n            object = EditableLine_getPrototypeOf(object);\n            if (object === null) break;\n          }\n\n          return object;\n        }\n\n        function EditableLine_getPrototypeOf(o) {\n          EditableLine_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return EditableLine_getPrototypeOf(o);\n        }\n\n        function EditableLine_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n\n        var EditableLine_getPoints = function getPoints(shape) {\n          // Could just be Array.from(shape.querySelector('.inner').points) but...\n          // IE11 :-(\n          var innerElement = shape.querySelector('.a9s-inner');\n          var points = [[innerElement.x1.baseVal, innerElement.y1.baseVal], [innerElement.x2.baseVal, innerElement.y2.baseVal]];\n          return points;\n        };\n\n        var EditableLine_getBBox = function getBBox(shape) {\n          return shape.querySelector('.a9s-inner').getBBox();\n        };\n        /**\r\n         * An editable line shape.\r\n         */\n\n\n        var EditableLine = /*#__PURE__*/function (_EditableShape) {\n          EditableLine_inherits(EditableLine, _EditableShape);\n\n          var _super = EditableLine_createSuper(EditableLine);\n\n          function EditableLine(_annotation, g, config, env) {\n            var _thisSuper, _this;\n\n            EditableLine_classCallCheck(this, EditableLine);\n            _this = _super.call(this, _annotation, g, config, env);\n            EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"onScaleChanged\", function () {\n              return _this.handles.map(_this.scaleHandle);\n            });\n            EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"setPoints\", function (points) {\n              // Not using .toFixed(1) because that will ALWAYS\n              // return one decimal, e.g. \"15.0\" (when we want \"15\")\n              var round = function round(num) {\n                return Math.round(10 * num) / 10;\n              };\n\n              var x1 = points[0].x;\n              var y1 = points[0].y;\n              var x2 = points[1].x;\n              var y2 = points[1].y;\n\n              var inner = _this.shape.querySelector('.a9s-inner');\n\n              inner.setAttribute('x1', x1);\n              inner.setAttribute('y1', y1);\n              inner.setAttribute('x2', x2);\n              inner.setAttribute('y2', y2);\n\n              var outer = _this.shape.querySelector('.a9s-outer');\n\n              outer.setAttribute('x1', x1);\n              outer.setAttribute('y1', y1);\n              outer.setAttribute('x2', x2);\n              outer.setAttribute('y2', y2);\n\n              _this.mask.redraw();\n\n              var _outer$getBBox = outer.getBBox(),\n                  x = _outer$getBBox.x,\n                  y = _outer$getBBox.y,\n                  width = _outer$getBBox.width,\n                  height = _outer$getBBox.height;\n\n              setFormatterElSize(_this.elementGroup, x, y, width, height);\n            });\n            EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\n              return function (evt) {\n                if (evt.button !== 0) return; // left click\n\n                _this.grabbedElem = grabbedElem;\n                _this.grabbedAt = _this.getSVGPoint(evt);\n              };\n            });\n            EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\n              var constrain = function constrain(coord, delta, max) {\n                return coord + delta < 0 ? -coord : coord + delta > max ? max - coord : delta;\n              };\n\n              if (_this.grabbedElem) {\n                var pos = _this.getSVGPoint(evt);\n\n                if (_this.grabbedElem === _this.shape) {\n                  var _getBBox = EditableLine_getBBox(_this.shape),\n                      x = _getBBox.x,\n                      y = _getBBox.y,\n                      width = _getBBox.width,\n                      height = _getBBox.height;\n\n                  var _this$env$image = _this.env.image,\n                      naturalWidth = _this$env$image.naturalWidth,\n                      naturalHeight = _this$env$image.naturalHeight;\n                  var dx = constrain(x, pos.x - _this.grabbedAt.x, naturalWidth - width);\n                  var dy = constrain(y, pos.y - _this.grabbedAt.y, naturalHeight - height);\n                  var updatedPoints = EditableLine_getPoints(_this.shape).map(function (pt) {\n                    return {\n                      x: pt[0].value + dx,\n                      y: pt[1].value + dy\n                    };\n                  });\n                  _this.grabbedAt = pos;\n\n                  _this.setPoints(updatedPoints);\n\n                  updatedPoints.forEach(function (pt, idx) {\n                    return _this.setHandleXY(_this.handles[idx], pt.x, pt.y);\n                  });\n\n                  _this.emit('update', toSVGTarget(_this.shape, _this.env.image));\n                } else {\n                  var handleIdx = _this.handles.indexOf(_this.grabbedElem);\n\n                  var _updatedPoints = EditableLine_getPoints(_this.shape).map(function (pt, idx) {\n                    return idx === handleIdx ? pos : {\n                      'x': pt[0].value,\n                      'y': pt[1].value\n                    };\n                  });\n\n                  _this.setPoints(_updatedPoints);\n\n                  _this.setHandleXY(_this.handles[handleIdx], pos.x, pos.y);\n\n                  _this.emit('update', toSVGTarget(_this.shape, _this.env.image));\n                }\n              }\n            });\n            EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"onMouseUp\", function (evt) {\n              _this.grabbedElem = null;\n              _this.grabbedAt = null;\n            });\n            EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"updateState\", function (annotation) {\n              var points = svgFragmentToShape(annotation).getAttribute('points').split(' ') // Split x/y tuples\n              .map(function (xy) {\n                var _xy$split$map = xy.split(',').map(function (str) {\n                  return parseFloat(str.trim());\n                }),\n                    _xy$split$map2 = EditableLine_slicedToArray(_xy$split$map, 2),\n                    x = _xy$split$map2[0],\n                    y = _xy$split$map2[1];\n\n                return {\n                  x: x,\n                  y: y\n                };\n              });\n\n              _this.setPoints(points);\n\n              points.forEach(function (pt, idx) {\n                return _this.setHandleXY(_this.handles[idx], pt.x, pt.y);\n              });\n            });\n            EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"destroy\", function () {\n              _this.containerGroup.parentNode.removeChild(_this.containerGroup);\n\n              EditableLine_get((_thisSuper = EditableLine_assertThisInitialized(_this), EditableLine_getPrototypeOf(EditableLine.prototype)), \"destroy\", _thisSuper).call(_thisSuper);\n            });\n\n            _this.svg.addEventListener('mousemove', _this.onMouseMove);\n\n            _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\n            //\n            // <g>\n            //   <path class=\"a9s-selection mask\"... />\n            //   <g> <-- return this node as .element\n            //     <line class=\"a9s-outer\" ... />\n            //     <line class=\"a9s-inner\" ... />\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     <g class=\"a9s-handle\" ...> ... </g>\n            //     ...\n            //   </g>\n            // </g>\n            // 'g' for the editable line shape\n\n\n            _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n            _this.shape = drawEmbeddedSVG(_annotation);\n\n            _this.shape.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.shape));\n\n            _this.mask = new LineMask(env.image, _this.shape.querySelector('.a9s-inner'));\n\n            _this.containerGroup.appendChild(_this.mask.element);\n\n            _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\n\n            _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\n\n            _this.elementGroup.setAttribute('data-id', _annotation.id);\n\n            _this.elementGroup.appendChild(_this.shape);\n\n            _this.handles = EditableLine_getPoints(_this.shape).map(function (pt) {\n              var handle = _this.drawHandle(pt[0].value, pt[1].value);\n\n              handle.addEventListener('mousedown', _this.onGrab(handle));\n\n              _this.elementGroup.appendChild(handle);\n\n              return handle;\n            });\n\n            _this.containerGroup.appendChild(_this.elementGroup);\n\n            g.appendChild(_this.containerGroup);\n            format(_this.shape, _annotation, config.formatters); // The grabbed element (handle or entire shape), if any\n\n            _this.grabbedElem = null; // Mouse grab point\n\n            _this.grabbedAt = null;\n            return _this;\n          }\n\n          EditableLine_createClass(EditableLine, [{\n            key: \"element\",\n            get: function get() {\n              return this.elementGroup;\n            } // TODO: update this for line svg Attributes, currently not being used\n\n          }]);\n          return EditableLine;\n        }(EditableShape);\n\n        ; // CONCATENATED MODULE: ./src/line/RubberbandLineTool.js\n\n        function RubberbandLineTool_typeof(obj) {\n          \"@babel/helpers - typeof\";\n\n          return RubberbandLineTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n            return typeof obj;\n          } : function (obj) {\n            return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n          }, RubberbandLineTool_typeof(obj);\n        }\n\n        function RubberbandLineTool_classCallCheck(instance, Constructor) {\n          if (!(instance instanceof Constructor)) {\n            throw new TypeError(\"Cannot call a class as a function\");\n          }\n        }\n\n        function RubberbandLineTool_defineProperties(target, props) {\n          for (var i = 0; i < props.length; i++) {\n            var descriptor = props[i];\n            descriptor.enumerable = descriptor.enumerable || false;\n            descriptor.configurable = true;\n            if (\"value\" in descriptor) descriptor.writable = true;\n            Object.defineProperty(target, descriptor.key, descriptor);\n          }\n        }\n\n        function RubberbandLineTool_createClass(Constructor, protoProps, staticProps) {\n          if (protoProps) RubberbandLineTool_defineProperties(Constructor.prototype, protoProps);\n          if (staticProps) RubberbandLineTool_defineProperties(Constructor, staticProps);\n          Object.defineProperty(Constructor, \"prototype\", {\n            writable: false\n          });\n          return Constructor;\n        }\n\n        function RubberbandLineTool_inherits(subClass, superClass) {\n          if (typeof superClass !== \"function\" && superClass !== null) {\n            throw new TypeError(\"Super expression must either be null or a function\");\n          }\n\n          subClass.prototype = Object.create(superClass && superClass.prototype, {\n            constructor: {\n              value: subClass,\n              writable: true,\n              configurable: true\n            }\n          });\n          Object.defineProperty(subClass, \"prototype\", {\n            writable: false\n          });\n          if (superClass) RubberbandLineTool_setPrototypeOf(subClass, superClass);\n        }\n\n        function RubberbandLineTool_setPrototypeOf(o, p) {\n          RubberbandLineTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n            o.__proto__ = p;\n            return o;\n          };\n          return RubberbandLineTool_setPrototypeOf(o, p);\n        }\n\n        function RubberbandLineTool_createSuper(Derived) {\n          var hasNativeReflectConstruct = RubberbandLineTool_isNativeReflectConstruct();\n          return function _createSuperInternal() {\n            var Super = RubberbandLineTool_getPrototypeOf(Derived),\n                result;\n\n            if (hasNativeReflectConstruct) {\n              var NewTarget = RubberbandLineTool_getPrototypeOf(this).constructor;\n              result = Reflect.construct(Super, arguments, NewTarget);\n            } else {\n              result = Super.apply(this, arguments);\n            }\n\n            return RubberbandLineTool_possibleConstructorReturn(this, result);\n          };\n        }\n\n        function RubberbandLineTool_possibleConstructorReturn(self, call) {\n          if (call && (RubberbandLineTool_typeof(call) === \"object\" || typeof call === \"function\")) {\n            return call;\n          } else if (call !== void 0) {\n            throw new TypeError(\"Derived constructors may only return object or undefined\");\n          }\n\n          return RubberbandLineTool_assertThisInitialized(self);\n        }\n\n        function RubberbandLineTool_assertThisInitialized(self) {\n          if (self === void 0) {\n            throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n          }\n\n          return self;\n        }\n\n        function RubberbandLineTool_isNativeReflectConstruct() {\n          if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n          if (Reflect.construct.sham) return false;\n          if (typeof Proxy === \"function\") return true;\n\n          try {\n            Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n            return true;\n          } catch (e) {\n            return false;\n          }\n        }\n\n        function RubberbandLineTool_getPrototypeOf(o) {\n          RubberbandLineTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n            return o.__proto__ || Object.getPrototypeOf(o);\n          };\n          return RubberbandLineTool_getPrototypeOf(o);\n        }\n\n        function RubberbandLineTool_defineProperty(obj, key, value) {\n          if (key in obj) {\n            Object.defineProperty(obj, key, {\n              value: value,\n              enumerable: true,\n              configurable: true,\n              writable: true\n            });\n          } else {\n            obj[key] = value;\n          }\n\n          return obj;\n        }\n        /**\r\n         * A rubberband selector for Line fragments.\r\n         */\n\n\n        var RubberbandLineTool = /*#__PURE__*/function (_Tool) {\n          RubberbandLineTool_inherits(RubberbandLineTool, _Tool);\n\n          var _super = RubberbandLineTool_createSuper(RubberbandLineTool);\n\n          function RubberbandLineTool(g, config, env) {\n            var _this;\n\n            RubberbandLineTool_classCallCheck(this, RubberbandLineTool);\n            _this = _super.call(this, g, config, env);\n            RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\n              _this._isDrawing = true;\n\n              _this.attachListeners({\n                mouseMove: _this.onMouseMove,\n                mouseUp: _this.onMouseUp\n              });\n\n              _this.rubberband = new RubberbandLine([x, y], _this.g, _this.env);\n            });\n            RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"stop\", function () {\n              _this.detachListeners();\n\n              _this._isDrawing = false;\n\n              if (_this.rubberband) {\n                _this.rubberband.destroy();\n\n                _this.rubberband = null;\n              }\n            });\n            RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"undo\", function () {\n              if (_this.rubberband) {\n                _this.rubberband.undo();\n              }\n            });\n            RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"newPart\", function () {\n              if (_this.rubberband) {\n                _this.rubberband.newPart();\n              }\n            });\n            RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\n              return _this.rubberband.dragTo([x, y]);\n            });\n            RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"onMouseUp\", function (x, y, evt) {\n              if (evt.altKey) {\n                _this.onDblClick(evt);\n              } else if (evt.ctrlKey) {\n                _this.rubberband.undo();\n              } else {\n                // TODO: see when this is useful\n                // const { width, height } = this.rubberband.getBoundingClientRect();\n                // const minWidth = this.config.minSelectionWidth || 4;\n                // const minHeight = this.config.minSelectionHeight || 4;\n                if (_this.rubberband.points.length == 2) {\n                  _this.rubberband.addPoint([x, y]); // check if both coordinates are same\n\n\n                  if (_this.rubberband.points[0] == _this.rubberband.points[2] && _this.rubberband.points[1] == _this.rubberband.points[3]) {\n                    _this.emit('cancel');\n\n                    _this.stop();\n                  } else {\n                    _this._isDrawing = false;\n                    var shape = _this.rubberband.element;\n                    shape.annotation = _this.rubberband.toSelection();\n\n                    _this.emit('complete', shape);\n\n                    _this.stop();\n                  }\n                }\n              }\n            });\n            RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\n              return new EditableLine(annotation, _this.g, _this.config, _this.env);\n            });\n            _this._isDrawing = false;\n            document.addEventListener('keydown', function (evt) {\n              if (evt.key == \"z\" && evt.ctrlKey) {\n                _this.undo();\n              }\n\n              if (evt.key == 'n') {\n                _this.newPart();\n              }\n            });\n            return _this;\n          }\n\n          RubberbandLineTool_createClass(RubberbandLineTool, [{\n            key: \"isDrawing\",\n            get: function get() {\n              return this._isDrawing;\n            }\n          }]);\n          return RubberbandLineTool;\n        }(Tool);\n\n        RubberbandLineTool.identifier = 'line';\n\n        RubberbandLineTool.supports = function (annotation) {\n          var _selector$value;\n\n          var selector = annotation.selector('SvgSelector');\n          if (selector) return (_selector$value = selector.value) === null || _selector$value === void 0 ? void 0 : _selector$value.match(/^<svg.*<line/g);\n        };\n\n        ; // CONCATENATED MODULE: ./src/index.js\n\n        var ALL_TOOLS = new Set(['point', 'circle', 'ellipse', 'freehand', 'line' // 'multipolygon' // exclude from defaults for now\n        ]);\n\n        var SelectorPack = function SelectorPack(anno, config) {\n          // Add configured tools, or all\n          var tools = config !== null && config !== void 0 && config.tools ? config.tools.map(function (t) {\n            return t.toLowerCase();\n          }) : ALL_TOOLS;\n          tools.forEach(function (tool) {\n            if (tool === 'point') anno.addDrawingTool(PointTool);\n            if (tool === 'circle') anno.addDrawingTool(RubberbandCircleTool);\n            if (tool === 'ellipse') anno.addDrawingTool(RubberbandEllipseTool);\n            if (tool === 'freehand') anno.addDrawingTool(RubberbandFreehandTool);\n            if (tool === 'multipolygon') anno.addDrawingTool(RubberbandMultipolygonTool);\n            if (tool === 'line') anno.addDrawingTool(RubberbandLineTool);\n          });\n        };\n        /* harmony default export */\n\n\n        const src = SelectorPack;\n      })();\n\n      __webpack_exports__ = __webpack_exports__[\"default\"];\n      /******/\n\n      return __webpack_exports__;\n      /******/\n    })()\n  );\n});","map":{"version":3,"names":["webpackUniversalModuleDefinition","root","factory","exports","module","define","amd","self","__webpack_modules__","_typeof","obj","Symbol","iterator","constructor","prototype","equal","a","b","length","i","keys","Array","isArray","RegExp","source","flags","valueOf","Object","toString","hasOwnProperty","call","key","E","on","name","callback","ctx","e","push","fn","once","listener","off","apply","arguments","_","emit","data","slice","evtArr","len","evts","liveEvents","TinyEmitter","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","n","getter","__esModule","d","definition","o","defineProperty","enumerable","get","prop","__webpack_exports__","src","tiny_emitter","tiny_emitter_default","SIM_EVENTS","touchstart","touchmove","touchend","isTouchDevice","window","navigator","maxTouchPoints","msMaxTouchPoints","enableTouchTranslation","el","pressAndHoldTrigger","simulateEvent","type","MouseEvent","screenX","screenY","clientX","clientY","pageX","pageY","bubbles","touchHandler","evt","touch","changedTouches","simulatedEvent","target","dispatchEvent","preventDefault","clearTimeout","setTimeout","addEventListener","SVG_SVG_NAMESPACE","getClassNames","attr","getAttribute","Set","split","SVG_addClass","addClass","className","classNames","add","setAttribute","from","join","removeClass","size","removeAttribute","hasClass","has","getRandomValues","rnds8","Uint8Array","rng","crypto","bind","msCrypto","Error","regex","validate","uuid","test","esm_browser_validate","byteToHex","substr","stringify","arr","offset","toLowerCase","TypeError","esm_browser_stringify","v4","options","buf","rnds","random","esm_browser_v4","fast_deep_equal","fast_deep_equal_default","ownKeys","object","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","_objectSpread","forEach","_defineProperty","getOwnPropertyDescriptors","defineProperties","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","configurable","writable","_createClass","protoProps","staticProps","value","WebAnnotation","annotation","opts","_this","opt_props","opt_opts","underlying","selector","selectors","find","s","isEqual","other","id","_this$opts","readOnly","motivation","body","set","bodies","_this$selector","exact","_this$selector2","start","_this$selector3","end","args","stub","concat","Selection_ownKeys","Selection_objectSpread","Selection_defineProperty","Selection_classCallCheck","Selection_defineProperties","Selection_createClass","Selection","_target","cloned","JSON","parse","assign","Tool_classCallCheck","Tool_defineProperties","Tool_createClass","_inherits","subClass","superClass","create","_setPrototypeOf","p","setPrototypeOf","__proto__","_createSuper","Derived","hasNativeReflectConstruct","_isNativeReflectConstruct","_createSuperInternal","Super","_getPrototypeOf","result","NewTarget","Reflect","construct","_possibleConstructorReturn","_assertThisInitialized","ReferenceError","sham","Proxy","Boolean","getPrototypeOf","Tool_defineProperty","IMPLEMENTATION_MISSING","isTouch","ToolLike","_EventEmitter","_super","g","config","env","ResizeObserver","resizeObserver","svgBounds","svg","getBoundingClientRect","_this$svg$viewBox$bas","viewBox","baseVal","width","height","scale","Math","max","onScaleChanged","observe","parentNode","pt","createSVGPoint","bbox","x","y","_this$svg$getBounding","left","top","matrixTransform","getScreenCTM","inverse","offsetX","offsetY","getCTM","containerGroup","document","createElementNS","group","drawCircle","r","c","radius","handleRadius","inner","outer","appendChild","handle","querySelector","parseFloat","closest","image","Element","HTMLDocument","enableResponsive","destroy","disconnect","Tool","_ToolLike","_super2","_this2","_ref","mouseMove","mouseUp","dblClick","_this2$getSVGPoint","getSVGPoint","started","button","_this2$getSVGPoint2","_this2$getSVGPoint3","removeEventListener","startOnSingleClick","_this2$getSVGPoint4","startDrawing","formatters","supports","EditableShape_typeof","EditableShape_classCallCheck","EditableShape_defineProperties","EditableShape_createClass","EditableShape_inherits","EditableShape_setPrototypeOf","EditableShape_createSuper","EditableShape_isNativeReflectConstruct","EditableShape_getPrototypeOf","EditableShape_possibleConstructorReturn","EditableShape_assertThisInitialized","EditableShape_defineProperty","EditableShape_IMPLEMENTATION_MISSING","EditableShape","_slicedToArray","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","minLen","_arrayLikeToArray","arr2","_i","_arr","_n","_d","_s","_e","next","done","err","parseRectFragment","conformsTo","startsWith","format","includes","substring","indexOf","coords","_coords$split$map","map","_coords$split$map2","w","h","naturalWidth","naturalHeight","toPixelRectFragment","toPercentRectFragment","px","py","pw","ph","toRectFragment","fragmentUnit","setXYWH","shape","setPointXY","drawRectMask","imageDimensions","mask","SVG_NAMESPACE","setRectMaskSize","drawRect","arg1","arg2","arg3","arg4","outerPoint","innerPoint","outerRect","innerRect","getRectSize","nodeName","_x","_y","setRectSize","rectArea","_parseRectFragment","Point_ownKeys","Point_objectSpread","Point_defineProperty","isPoint","_annotation$target$re","renderedVia","toFragment","EditablePoint_typeof","EditablePoint_classCallCheck","EditablePoint_defineProperties","EditablePoint_createClass","_get","property","receiver","base","_superPropBase","desc","EditablePoint_getPrototypeOf","EditablePoint_inherits","EditablePoint_setPrototypeOf","EditablePoint_createSuper","EditablePoint_isNativeReflectConstruct","EditablePoint_possibleConstructorReturn","EditablePoint_assertThisInitialized","EditablePoint_defineProperty","EditablePoint","_EditableShape","_annotation","scaleHandle","point","isGrabbed","_this$getSVGPoint","setHandleXY","onMouseMove","onMouseUp","_parseRectFragment2","container","elementGroup","drawHandle","onGrab","removeChild","PointTool_typeof","PointTool_classCallCheck","PointTool_defineProperties","PointTool_createClass","PointTool_inherits","PointTool_setPrototypeOf","PointTool_createSuper","PointTool_isNativeReflectConstruct","PointTool_getPrototypeOf","PointTool_possibleConstructorReturn","PointTool_assertThisInitialized","PointTool_defineProperty","PointTool","_Tool","_evt$target$closest","element","identifier","_createForOfIteratorHelper","allowArrayLike","it","EmbeddedSVG_unsupportedIterableToArray","F","f","normalCompletion","didErr","step","_e2","EmbeddedSVG_arrayLikeToArray","insertSVGNamespace","originalDoc","serializer","XMLSerializer","str","serializeToString","documentElement","namespaced","replace","parser","DOMParser","namespacedDoc","parseFromString","sanitize","doc","cleanEl","attributes","scripts","getElementsByTagName","reverse","querySelectorAll","svgFragmentToShape","isPrefixDeclared","lookupPrefix","isDefaultNamespaceSVG","lookupNamespaceURI","firstChild","drawEmbeddedSVG","cloneNode","toSVGTarget","serialized","outerHTML","svgArea","svgPolygonArea","svgCircleArea","svgEllipseArea","svgPathArea","polygon","points","trim","xy","polygonArea","circle","PI","ellipse","rx","ry","path","polygons","svgPathToPolygons","isHole","polygonInPolygon","area","_iterator","_step","poly","setXYR","cx","cy","outerCircle","innerCircle","setCircleSize","getCircleSize","CircleMask_classCallCheck","CircleMask_defineProperties","CircleMask_createClass","CircleMask_defineProperty","CircleMask","_getCircleSize","tx","ty","_getCircleSize2","_cx","_cy","_r","_tx","_ty","RubberbandCircle_classCallCheck","RubberbandCircle_defineProperties","RubberbandCircle_createClass","RubberbandCircle_defineProperty","RubberbandCircle","anchorX","anchorY","oppositeX","oppositeY","_this$env$image","style","display","anchor","pow","redraw","pointerEvents","_toConsumableArray","_arrayWithoutHoles","_iterableToArray","Formatting_unsupportedIterableToArray","_nonIterableSpread","Formatting_arrayLikeToArray","iter","isFirefox","userAgent","formatSvgEl","svgEl","appendFormatterEl","formatterEl","_shape$getBBox","getBBox","append","reduce","merged","String","nodeType","Node","ELEMENT_NODE","elements","_className","_style","setFormatterElSize","EditableCircle_typeof","EditableCircle_slicedToArray","EditableCircle_arrayWithHoles","EditableCircle_iterableToArrayLimit","EditableCircle_unsupportedIterableToArray","EditableCircle_nonIterableRest","EditableCircle_arrayLikeToArray","EditableCircle_classCallCheck","EditableCircle_defineProperties","EditableCircle_createClass","EditableCircle_get","EditableCircle_superPropBase","EditableCircle_getPrototypeOf","EditableCircle_inherits","EditableCircle_setPrototypeOf","EditableCircle_createSuper","EditableCircle_isNativeReflectConstruct","EditableCircle_possibleConstructorReturn","EditableCircle_assertThisInitialized","EditableCircle_defineProperty","EditableCircle","_this$handles","handles","topleft","topright","bottomright","bottomleft","draggedHandleIdx","anchorHandle","mousePos","getHandleXY","mouseX","mouseY","abs","idx0","idx2","idx3","idx1","grabbedElem","pos","grabbedAt","constrain","coord","setSize","handleIdx","oppositeHandle","stretchCorners","_getCircleSize3","t","_t","formatter","RubberbandCircleTool_typeof","RubberbandCircleTool_classCallCheck","RubberbandCircleTool_defineProperties","RubberbandCircleTool_createClass","RubberbandCircleTool_inherits","RubberbandCircleTool_setPrototypeOf","RubberbandCircleTool_createSuper","RubberbandCircleTool_isNativeReflectConstruct","RubberbandCircleTool_getPrototypeOf","RubberbandCircleTool_possibleConstructorReturn","RubberbandCircleTool_assertThisInitialized","RubberbandCircleTool_defineProperty","RubberbandCircleTool","attachListeners","rubberband","dragTo","detachListeners","_this$rubberband$getB","minWidth","minSelectionWidth","minHeight","minSelectionHeight","toSelection","stop","_selector$value","match","Ellipse_setXYR","drawEllipse","innerEllipse","outerEllipse","setEllipseSize","getEllipseSize","EllipseMask_classCallCheck","EllipseMask_defineProperties","EllipseMask_createClass","EllipseMask_defineProperty","EllipseMask","_getEllipseSize","_getEllipseSize2","_rx","_ry","RubberbandEllipse_classCallCheck","RubberbandEllipse_defineProperties","RubberbandEllipse_createClass","RubberbandEllipse_defineProperty","RubberbandEllipse","EditableEllipse_typeof","EditableEllipse_slicedToArray","EditableEllipse_arrayWithHoles","EditableEllipse_iterableToArrayLimit","EditableEllipse_unsupportedIterableToArray","EditableEllipse_nonIterableRest","EditableEllipse_arrayLikeToArray","EditableEllipse_classCallCheck","EditableEllipse_defineProperties","EditableEllipse_createClass","EditableEllipse_get","EditableEllipse_superPropBase","EditableEllipse_getPrototypeOf","EditableEllipse_inherits","EditableEllipse_setPrototypeOf","EditableEllipse_createSuper","EditableEllipse_isNativeReflectConstruct","EditableEllipse_possibleConstructorReturn","EditableEllipse_assertThisInitialized","EditableEllipse_defineProperty","EditableEllipse","leftHandle","anchorLeft","_getEllipseSize3","RubberbandEllipseTool_typeof","RubberbandEllipseTool_classCallCheck","RubberbandEllipseTool_defineProperties","RubberbandEllipseTool_createClass","RubberbandEllipseTool_inherits","RubberbandEllipseTool_setPrototypeOf","RubberbandEllipseTool_createSuper","RubberbandEllipseTool_isNativeReflectConstruct","RubberbandEllipseTool_getPrototypeOf","RubberbandEllipseTool_possibleConstructorReturn","RubberbandEllipseTool_assertThisInitialized","RubberbandEllipseTool_defineProperty","RubberbandEllipseTool","RubberbandFreehand_toConsumableArray","RubberbandFreehand_arrayWithoutHoles","RubberbandFreehand_iterableToArray","RubberbandFreehand_unsupportedIterableToArray","RubberbandFreehand_nonIterableSpread","RubberbandFreehand_arrayLikeToArray","RubberbandFreehand_classCallCheck","RubberbandFreehand_defineProperties","RubberbandFreehand_createClass","RubberbandFreehand_defineProperty","RubberbandFreehand","addPoint","setPoints","freehand","EditableFreehand_typeof","EditableFreehand_classCallCheck","EditableFreehand_defineProperties","EditableFreehand_createClass","EditableFreehand_inherits","EditableFreehand_setPrototypeOf","EditableFreehand_createSuper","EditableFreehand_isNativeReflectConstruct","EditableFreehand_getPrototypeOf","EditableFreehand_possibleConstructorReturn","EditableFreehand_assertThisInitialized","EditableFreehand_get","EditableFreehand_superPropBase","EditableFreehand_defineProperty","getPoints","pointList","EditableFreehand","_thisSuper","round","num","_outer$getBBox","delta","_getBBox","dx","dy","updatedPoints","_getBBox2","_width","_height","RubberbandFreehandTool_typeof","RubberbandFreehandTool_classCallCheck","RubberbandFreehandTool_defineProperties","RubberbandFreehandTool_createClass","RubberbandFreehandTool_inherits","RubberbandFreehandTool_setPrototypeOf","RubberbandFreehandTool_createSuper","RubberbandFreehandTool_isNativeReflectConstruct","RubberbandFreehandTool_getPrototypeOf","RubberbandFreehandTool_possibleConstructorReturn","RubberbandFreehandTool_assertThisInitialized","RubberbandFreehandTool_defineProperty","RubberbandFreehandTool","_isDrawing","onDblClick","toUpperCase","PolygonMask_classCallCheck","PolygonMask_defineProperties","PolygonMask_createClass","PolygonMask_defineProperty","PolygonMask","RubberbandMultipolygon_ownKeys","RubberbandMultipolygon_objectSpread","RubberbandMultipolygon_defineProperty","RubberbandMultipolygon_toConsumableArray","RubberbandMultipolygon_arrayWithoutHoles","RubberbandMultipolygon_iterableToArray","RubberbandMultipolygon_unsupportedIterableToArray","RubberbandMultipolygon_nonIterableSpread","RubberbandMultipolygon_arrayLikeToArray","RubberbandMultipolygon_createForOfIteratorHelper","RubberbandMultipolygon_classCallCheck","RubberbandMultipolygon_defineProperties","RubberbandMultipolygon_createClass","RubberbandMultipolygon","ps","attr2","_iterator2","_step2","head","headRest","lastCorner","dist","pop","multipolygon","EditableMultipolygon_typeof","EditableMultipolygon_ownKeys","EditableMultipolygon_objectSpread","EditableMultipolygon_defineProperty","EditableMultipolygon_classCallCheck","EditableMultipolygon_defineProperties","EditableMultipolygon_createClass","EditableMultipolygon_inherits","EditableMultipolygon_setPrototypeOf","EditableMultipolygon_createSuper","EditableMultipolygon_isNativeReflectConstruct","EditableMultipolygon_getPrototypeOf","EditableMultipolygon_possibleConstructorReturn","EditableMultipolygon_assertThisInitialized","EditableMultipolygon_get","EditableMultipolygon_superPropBase","EditableMultipolygon_createForOfIteratorHelper","EditableMultipolygon_unsupportedIterableToArray","EditableMultipolygon_arrayLikeToArray","EditableMultipolygon_getPoints","pointLists","getPointsFromPathValue","nodeValue","pointArray","results","allcoords","index","coordsString","toFixed","EditableMultipolygon_getBBox","svgFragmentToPoints","svgShape","EditableMultipolygon_drawEmbeddedSVG","EditableMultipolygon","_iterator3","_step3","first","_iterator4","_step4","_iterator5","_step5","_updatedPoints","updatedPointsList","idx","pointListIDX","found","_iterator6","_step6","updatedPointsIDX","_iterator7","_step7","newPoints","_iterator8","_step8","_handle","_pointList","_iterator9","_step9","RubberbandMultipolygonTool_typeof","RubberbandMultipolygonTool_classCallCheck","RubberbandMultipolygonTool_defineProperties","RubberbandMultipolygonTool_createClass","RubberbandMultipolygonTool_inherits","RubberbandMultipolygonTool_setPrototypeOf","RubberbandMultipolygonTool_createSuper","RubberbandMultipolygonTool_isNativeReflectConstruct","RubberbandMultipolygonTool_getPrototypeOf","RubberbandMultipolygonTool_possibleConstructorReturn","RubberbandMultipolygonTool_assertThisInitialized","RubberbandMultipolygonTool_defineProperty","RubberbandMultipolygonTool","undo","newPart","altKey","ctrlKey","LineMask_classCallCheck","LineMask_defineProperties","LineMask_createClass","LineMask_defineProperty","LineMask","line","RubberbandLine_ownKeys","RubberbandLine_objectSpread","RubberbandLine_defineProperty","RubberbandLine_toConsumableArray","RubberbandLine_arrayWithoutHoles","RubberbandLine_iterableToArray","RubberbandLine_unsupportedIterableToArray","RubberbandLine_nonIterableSpread","RubberbandLine_arrayLikeToArray","RubberbandLine_classCallCheck","RubberbandLine_defineProperties","RubberbandLine_createClass","RubberbandLine","mousepos","Line","EditableLine_typeof","EditableLine_slicedToArray","EditableLine_arrayWithHoles","EditableLine_iterableToArrayLimit","EditableLine_unsupportedIterableToArray","EditableLine_nonIterableRest","EditableLine_arrayLikeToArray","EditableLine_classCallCheck","EditableLine_defineProperties","EditableLine_createClass","EditableLine_inherits","EditableLine_setPrototypeOf","EditableLine_createSuper","EditableLine_isNativeReflectConstruct","EditableLine_getPrototypeOf","EditableLine_possibleConstructorReturn","EditableLine_assertThisInitialized","EditableLine_get","EditableLine_superPropBase","EditableLine_defineProperty","EditableLine_getPoints","innerElement","x1","y1","x2","y2","EditableLine_getBBox","EditableLine","_xy$split$map","_xy$split$map2","RubberbandLineTool_typeof","RubberbandLineTool_classCallCheck","RubberbandLineTool_defineProperties","RubberbandLineTool_createClass","RubberbandLineTool_inherits","RubberbandLineTool_setPrototypeOf","RubberbandLineTool_createSuper","RubberbandLineTool_isNativeReflectConstruct","RubberbandLineTool_getPrototypeOf","RubberbandLineTool_possibleConstructorReturn","RubberbandLineTool_assertThisInitialized","RubberbandLineTool_defineProperty","RubberbandLineTool","ALL_TOOLS","SelectorPack","anno","tools","tool","addDrawingTool"],"sources":["C:/Users/Danil/Desktop/122/src/libs/annotorious-selector-pack.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\r\n\tif(typeof exports === 'object' && typeof module === 'object')\r\n\t\tmodule.exports = factory();\r\n\telse if(typeof define === 'function' && define.amd)\r\n\t\tdefine([], factory);\r\n\telse if(typeof exports === 'object')\r\n\t\texports[\"Annotorious\"] = factory();\r\n\telse\r\n\t\troot[\"Annotorious\"] = root[\"Annotorious\"] || {}, root[\"Annotorious\"][\"SelectorPack\"] = factory();\r\n})(self, () => {\r\nreturn /******/ (() => { // webpackBootstrap\r\n/******/ \tvar __webpack_modules__ = ({\r\n\r\n/***/ 94:\r\n/*!***********************************************!*\\\r\n  !*** ./node_modules/fast-deep-equal/index.js ***!\r\n  \\***********************************************/\r\n/***/ ((module) => {\r\n\r\n\"use strict\";\r\n // do not edit .js files directly - edit src/index.jst\r\n\r\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\r\n\r\nmodule.exports = function equal(a, b) {\r\n  if (a === b) return true;\r\n\r\n  if (a && b && _typeof(a) == 'object' && _typeof(b) == 'object') {\r\n    if (a.constructor !== b.constructor) return false;\r\n    var length, i, keys;\r\n\r\n    if (Array.isArray(a)) {\r\n      length = a.length;\r\n      if (length != b.length) return false;\r\n\r\n      for (i = length; i-- !== 0;) {\r\n        if (!equal(a[i], b[i])) return false;\r\n      }\r\n\r\n      return true;\r\n    }\r\n\r\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\r\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\r\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\r\n    keys = Object.keys(a);\r\n    length = keys.length;\r\n    if (length !== Object.keys(b).length) return false;\r\n\r\n    for (i = length; i-- !== 0;) {\r\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\r\n    }\r\n\r\n    for (i = length; i-- !== 0;) {\r\n      var key = keys[i];\r\n      if (!equal(a[key], b[key])) return false;\r\n    }\r\n\r\n    return true;\r\n  } // true if both NaN, false otherwise\r\n\r\n\r\n  return a !== a && b !== b;\r\n};\r\n\r\n/***/ }),\r\n\r\n/***/ 773:\r\n/*!********************************************!*\\\r\n  !*** ./node_modules/tiny-emitter/index.js ***!\r\n  \\********************************************/\r\n/***/ ((module) => {\r\n\r\nfunction E() {// Keep this empty so it's easier to inherit from\r\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\r\n}\r\n\r\nE.prototype = {\r\n  on: function on(name, callback, ctx) {\r\n    var e = this.e || (this.e = {});\r\n    (e[name] || (e[name] = [])).push({\r\n      fn: callback,\r\n      ctx: ctx\r\n    });\r\n    return this;\r\n  },\r\n  once: function once(name, callback, ctx) {\r\n    var self = this;\r\n\r\n    function listener() {\r\n      self.off(name, listener);\r\n      callback.apply(ctx, arguments);\r\n    }\r\n\r\n    ;\r\n    listener._ = callback;\r\n    return this.on(name, listener, ctx);\r\n  },\r\n  emit: function emit(name) {\r\n    var data = [].slice.call(arguments, 1);\r\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\r\n    var i = 0;\r\n    var len = evtArr.length;\r\n\r\n    for (i; i < len; i++) {\r\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\r\n    }\r\n\r\n    return this;\r\n  },\r\n  off: function off(name, callback) {\r\n    var e = this.e || (this.e = {});\r\n    var evts = e[name];\r\n    var liveEvents = [];\r\n\r\n    if (evts && callback) {\r\n      for (var i = 0, len = evts.length; i < len; i++) {\r\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback) liveEvents.push(evts[i]);\r\n      }\r\n    } // Remove event from queue to prevent memory leak\r\n    // Suggested by https://github.com/lazd\r\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\r\n\r\n\r\n    liveEvents.length ? e[name] = liveEvents : delete e[name];\r\n    return this;\r\n  }\r\n};\r\nmodule.exports = E;\r\nmodule.exports.TinyEmitter = E;\r\n\r\n/***/ })\r\n\r\n/******/ \t});\r\n/************************************************************************/\r\n/******/ \t// The module cache\r\n/******/ \tvar __webpack_module_cache__ = {};\r\n/******/ \t\r\n/******/ \t// The require function\r\n/******/ \tfunction __webpack_require__(moduleId) {\r\n/******/ \t\t// Check if module is in cache\r\n/******/ \t\tvar cachedModule = __webpack_module_cache__[moduleId];\r\n/******/ \t\tif (cachedModule !== undefined) {\r\n/******/ \t\t\treturn cachedModule.exports;\r\n/******/ \t\t}\r\n/******/ \t\t// Create a new module (and put it into the cache)\r\n/******/ \t\tvar module = __webpack_module_cache__[moduleId] = {\r\n/******/ \t\t\t// no module.id needed\r\n/******/ \t\t\t// no module.loaded needed\r\n/******/ \t\t\texports: {}\r\n/******/ \t\t};\r\n/******/ \t\r\n/******/ \t\t// Execute the module function\r\n/******/ \t\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\r\n/******/ \t\r\n/******/ \t\t// Return the exports of the module\r\n/******/ \t\treturn module.exports;\r\n/******/ \t}\r\n/******/ \t\r\n/************************************************************************/\r\n/******/ \t/* webpack/runtime/compat get default export */\r\n/******/ \t(() => {\r\n/******/ \t\t// getDefaultExport function for compatibility with non-harmony modules\r\n/******/ \t\t__webpack_require__.n = (module) => {\r\n/******/ \t\t\tvar getter = module && module.__esModule ?\r\n/******/ \t\t\t\t() => (module['default']) :\r\n/******/ \t\t\t\t() => (module);\r\n/******/ \t\t\t__webpack_require__.d(getter, { a: getter });\r\n/******/ \t\t\treturn getter;\r\n/******/ \t\t};\r\n/******/ \t})();\r\n/******/ \t\r\n/******/ \t/* webpack/runtime/define property getters */\r\n/******/ \t(() => {\r\n/******/ \t\t// define getter functions for harmony exports\r\n/******/ \t\t__webpack_require__.d = (exports, definition) => {\r\n/******/ \t\t\tfor(var key in definition) {\r\n/******/ \t\t\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\r\n/******/ \t\t\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\r\n/******/ \t\t\t\t}\r\n/******/ \t\t\t}\r\n/******/ \t\t};\r\n/******/ \t})();\r\n/******/ \t\r\n/******/ \t/* webpack/runtime/hasOwnProperty shorthand */\r\n/******/ \t(() => {\r\n/******/ \t\t__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))\r\n/******/ \t})();\r\n/******/ \t\r\n/************************************************************************/\r\nvar __webpack_exports__ = {};\r\n// This entry need to be wrapped in an IIFE because it need to be in strict mode.\r\n(() => {\r\n\"use strict\";\r\n/*!***********************************!*\\\r\n  !*** ./src/index.js + 38 modules ***!\r\n  \\***********************************/\r\n\r\n// EXPORTS\r\n__webpack_require__.d(__webpack_exports__, {\r\n  \"default\": () => (/* binding */ src)\r\n});\r\n\r\n// EXTERNAL MODULE: ./node_modules/tiny-emitter/index.js\r\nvar tiny_emitter = __webpack_require__(773);\r\nvar tiny_emitter_default = /*#__PURE__*/__webpack_require__.n(tiny_emitter);\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/util/Touch.js\r\nvar SIM_EVENTS = {\r\n  touchstart: 'mousedown',\r\n  touchmove: 'mousemove',\r\n  touchend: 'mouseup'\r\n};\r\nvar isTouchDevice = function isTouchDevice() {\r\n  return 'ontouchstart' in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0;\r\n};\r\nvar enableTouchTranslation = function enableTouchTranslation(el) {\r\n  var pressAndHoldTrigger = null;\r\n\r\n  var simulateEvent = function simulateEvent(type, e) {\r\n    return new MouseEvent(type, {\r\n      screenX: e.screenX,\r\n      screenY: e.screenY,\r\n      clientX: e.clientX,\r\n      clientY: e.clientY,\r\n      pageX: e.pageX,\r\n      pageY: e.pageY,\r\n      bubbles: true\r\n    });\r\n  };\r\n\r\n  var touchHandler = function touchHandler(evt) {\r\n    var touch = evt.changedTouches[0];\r\n    var simulatedEvent = simulateEvent(SIM_EVENTS[evt.type], touch);\r\n    touch.target.dispatchEvent(simulatedEvent);\r\n    evt.preventDefault();\r\n\r\n    if (evt.type === 'touchstart' || evt.type === 'touchmove') {\r\n      pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\r\n      pressAndHoldTrigger = setTimeout(function () {\r\n        var simulatedEvent = simulateEvent('dblclick', touch);\r\n        touch.target.dispatchEvent(simulatedEvent);\r\n      }, 800);\r\n    }\r\n\r\n    if (evt.type === 'touchend') pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\r\n  };\r\n\r\n  el.addEventListener('touchstart', touchHandler, true);\r\n  el.addEventListener('touchmove', touchHandler, true);\r\n  el.addEventListener('touchend', touchHandler, true);\r\n  el.addEventListener('touchcancel', touchHandler, true);\r\n};\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/util/SVG.js\r\nvar SVG_SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\r\n\r\nvar getClassNames = function getClassNames(el) {\r\n  var attr = el.getAttribute('class');\r\n  return attr ? new Set(attr.split(' ')) : new Set();\r\n}; // IE11 doesn't support adding/removing classes to SVG elements except \r\n// via .setAttribute\r\n\r\n\r\nvar SVG_addClass = function addClass(el, className) {\r\n  var classNames = getClassNames(el);\r\n  classNames.add(className);\r\n  el.setAttribute('class', Array.from(classNames).join(' '));\r\n};\r\nvar removeClass = function removeClass(el, className) {\r\n  var classNames = getClassNames(el);\r\n  classNames[\"delete\"](className);\r\n  if (classNames.size === 0) el.removeAttribute('class');else el.setAttribute('class', Array.from(classNames).join(' '));\r\n};\r\nvar hasClass = function hasClass(el, className) {\r\n  return getClassNames(el).has(className);\r\n};\r\n;// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/rng.js\r\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\r\n// require the crypto API and do not support built-in fallback to lower quality random number\r\n// generators (like Math.random()).\r\nvar getRandomValues;\r\nvar rnds8 = new Uint8Array(16);\r\nfunction rng() {\r\n  // lazy load so that environments that need to polyfill have a chance to do so\r\n  if (!getRandomValues) {\r\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\r\n    // find the complete implementation of crypto (msCrypto) on IE11.\r\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\r\n\r\n    if (!getRandomValues) {\r\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\r\n    }\r\n  }\r\n\r\n  return getRandomValues(rnds8);\r\n}\r\n;// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/regex.js\r\n/* harmony default export */ const regex = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i);\r\n;// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/validate.js\r\n\r\n\r\nfunction validate(uuid) {\r\n  return typeof uuid === 'string' && regex.test(uuid);\r\n}\r\n\r\n/* harmony default export */ const esm_browser_validate = (validate);\r\n;// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/stringify.js\r\n\r\n/**\r\n * Convert array of 16 byte values to UUID string format of the form:\r\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\r\n */\r\n\r\nvar byteToHex = [];\r\n\r\nfor (var i = 0; i < 256; ++i) {\r\n  byteToHex.push((i + 0x100).toString(16).substr(1));\r\n}\r\n\r\nfunction stringify(arr) {\r\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0; // Note: Be careful editing this code!  It's been tuned for performance\r\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\r\n\r\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\r\n  // of the following:\r\n  // - One or more input array values don't map to a hex octet (leading to\r\n  // \"undefined\" in the uuid)\r\n  // - Invalid input values for the RFC `version` or `variant` fields\r\n\r\n  if (!esm_browser_validate(uuid)) {\r\n    throw TypeError('Stringified UUID is invalid');\r\n  }\r\n\r\n  return uuid;\r\n}\r\n\r\n/* harmony default export */ const esm_browser_stringify = (stringify);\r\n;// CONCATENATED MODULE: ./node_modules/uuid/dist/esm-browser/v4.js\r\n\r\n\r\n\r\nfunction v4(options, buf, offset) {\r\n  options = options || {};\r\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\r\n\r\n  rnds[6] = rnds[6] & 0x0f | 0x40;\r\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\r\n\r\n  if (buf) {\r\n    offset = offset || 0;\r\n\r\n    for (var i = 0; i < 16; ++i) {\r\n      buf[offset + i] = rnds[i];\r\n    }\r\n\r\n    return buf;\r\n  }\r\n\r\n  return esm_browser_stringify(rnds);\r\n}\r\n\r\n/* harmony default export */ const esm_browser_v4 = (v4);\r\n// EXTERNAL MODULE: ./node_modules/fast-deep-equal/index.js\r\nvar fast_deep_equal = __webpack_require__(94);\r\nvar fast_deep_equal_default = /*#__PURE__*/__webpack_require__.n(fast_deep_equal);\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/recogito-client-core/src/WebAnnotation.js\r\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\r\n\r\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\r\n\r\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\nvar WebAnnotation = /*#__PURE__*/function () {\r\n  function WebAnnotation(annotation, opts) {\r\n    var _this = this;\r\n\r\n    _classCallCheck(this, WebAnnotation);\r\n\r\n    _defineProperty(this, \"clone\", function (opt_props, opt_opts) {\r\n      return new WebAnnotation(_objectSpread(_objectSpread({}, _this.underlying), opt_props), _objectSpread(_objectSpread({}, _this.opts), opt_opts));\r\n    });\r\n\r\n    _defineProperty(this, \"selector\", function (type) {\r\n      var target = _this.underlying.target;\r\n\r\n      if (target.selector) {\r\n        // Normalize to array\r\n        var selectors = Array.isArray(target.selector) ? target.selector : [target.selector];\r\n        return selectors.find(function (s) {\r\n          return s.type === type;\r\n        });\r\n      }\r\n    });\r\n\r\n    this.underlying = annotation;\r\n    this.opts = opts;\r\n  }\r\n  /** For convenience - creates an empty web annotation **/\r\n\r\n\r\n  _createClass(WebAnnotation, [{\r\n    key: \"isEqual\",\r\n    value:\r\n    /** An equality check based on the underlying object **/\r\n    function isEqual(other) {\r\n      if ((other === null || other === void 0 ? void 0 : other.type) !== 'Annotation') {\r\n        return false;\r\n      } else if (this.underlying === other.underlying) {\r\n        return true;\r\n      } else if (!this.underlying.id || !other.underlying.id) {\r\n        return false;\r\n      } else {\r\n        return fast_deep_equal_default()(this.underlying, other.underlying);\r\n      }\r\n    }\r\n  }, {\r\n    key: \"readOnly\",\r\n    get: function get() {\r\n      var _this$opts;\r\n\r\n      return (_this$opts = this.opts) === null || _this$opts === void 0 ? void 0 : _this$opts.readOnly;\r\n    }\r\n    /*************************************/\r\n\r\n    /* Getters to forward properties of  */\r\n\r\n    /* the underlying annotation         */\r\n\r\n    /*************************************/\r\n\r\n  }, {\r\n    key: \"id\",\r\n    get: function get() {\r\n      return this.underlying.id;\r\n    }\r\n  }, {\r\n    key: \"context\",\r\n    get: function get() {\r\n      return this.underlying['@context'];\r\n    }\r\n  }, {\r\n    key: \"type\",\r\n    get: function get() {\r\n      return this.underlying.type;\r\n    }\r\n  }, {\r\n    key: \"motivation\",\r\n    get: function get() {\r\n      return this.underlying.motivation;\r\n    }\r\n  }, {\r\n    key: \"body\",\r\n    get: function get() {\r\n      return this.underlying.body;\r\n    }\r\n  }, {\r\n    key: \"target\",\r\n    get: function get() {\r\n      return this.underlying.target;\r\n    }\r\n    /** Same as .body, but guaranteed to return an array **/\r\n\r\n  }, {\r\n    key: \"bodies\",\r\n    get: function get() {\r\n      return Array.isArray(this.underlying.body) ? this.underlying.body : [this.underlying.body];\r\n    }\r\n    /** Only bodies are meant to be mutated by the application **/\r\n    ,\r\n    set: function set(bodies) {\r\n      this.underlying.body = bodies;\r\n    }\r\n    /** Same as .target, but guaranteed to return an array **/\r\n\r\n  }, {\r\n    key: \"targets\",\r\n    get: function get() {\r\n      return Array.isArray(this.underlying.target) ? this.underlying.target : [this.underlying.target];\r\n    }\r\n    /*****************************************/\r\n\r\n    /* Various access helpers and shorthands */\r\n\r\n    /*****************************************/\r\n\r\n    /** Selector of the given type **/\r\n\r\n  }, {\r\n    key: \"quote\",\r\n    get:\r\n    /** Shorthand for the 'exact' field of the TextQuoteSelector **/\r\n    function get() {\r\n      var _this$selector;\r\n\r\n      return (_this$selector = this.selector('TextQuoteSelector')) === null || _this$selector === void 0 ? void 0 : _this$selector.exact;\r\n    }\r\n    /** Shorthand for the 'start' field of the TextPositionSelector **/\r\n\r\n  }, {\r\n    key: \"start\",\r\n    get: function get() {\r\n      var _this$selector2;\r\n\r\n      return (_this$selector2 = this.selector('TextPositionSelector')) === null || _this$selector2 === void 0 ? void 0 : _this$selector2.start;\r\n    }\r\n    /** Shorthand for the 'end' field of the TextPositionSelector **/\r\n\r\n  }, {\r\n    key: \"end\",\r\n    get: function get() {\r\n      var _this$selector3;\r\n\r\n      return (_this$selector3 = this.selector('TextPositionSelector')) === null || _this$selector3 === void 0 ? void 0 : _this$selector3.end;\r\n    }\r\n  }]);\r\n\r\n  return WebAnnotation;\r\n}();\r\n\r\n_defineProperty(WebAnnotation, \"create\", function (args) {\r\n  var stub = {\r\n    '@context': 'http://www.w3.org/ns/anno.jsonld',\r\n    'type': 'Annotation',\r\n    'id': \"#\".concat(esm_browser_v4()),\r\n    'body': []\r\n  };\r\n  return new WebAnnotation(_objectSpread(_objectSpread({}, stub), args));\r\n});\r\n\r\n\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/recogito-client-core/src/Selection.js\r\nfunction Selection_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\r\n\r\nfunction Selection_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? Selection_ownKeys(Object(source), !0).forEach(function (key) { Selection_defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : Selection_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\r\n\r\nfunction Selection_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction Selection_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction Selection_createClass(Constructor, protoProps, staticProps) { if (protoProps) Selection_defineProperties(Constructor.prototype, protoProps); if (staticProps) Selection_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction Selection_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n/**\r\n * An \"annotation in draft mode\". Really the same\r\n * data structure, but as a separate class so we can\r\n * tell things apart properly.\r\n */\r\n\r\nvar Selection = /*#__PURE__*/function () {\r\n  function Selection(_target, body) {\r\n    var _this = this;\r\n\r\n    Selection_classCallCheck(this, Selection);\r\n\r\n    Selection_defineProperty(this, \"clone\", function (opt_props) {\r\n      // Deep-clone\r\n      var cloned = new Selection();\r\n      cloned.underlying = JSON.parse(JSON.stringify(_this.underlying));\r\n      if (opt_props) cloned.underlying = Selection_objectSpread(Selection_objectSpread({}, cloned.underlying), opt_props);\r\n      return cloned;\r\n    });\r\n\r\n    Selection_defineProperty(this, \"selector\", function (type) {\r\n      var target = _this.underlying.target;\r\n\r\n      if (target.selector) {\r\n        // Normalize to array\r\n        var selectors = Array.isArray(target.selector) ? target.selector : [target.selector];\r\n        return selectors.find(function (s) {\r\n          return s.type === type;\r\n        });\r\n      }\r\n    });\r\n\r\n    Selection_defineProperty(this, \"toAnnotation\", function () {\r\n      var a = Object.assign({}, _this.underlying, {\r\n        'type': 'Annotation',\r\n        'id': \"#\".concat(esm_browser_v4())\r\n      });\r\n      return new WebAnnotation(a);\r\n    });\r\n\r\n    this.underlying = {\r\n      '@context': 'http://www.w3.org/ns/anno.jsonld',\r\n      type: 'Selection',\r\n      body: body || [],\r\n      target: _target\r\n    };\r\n  }\r\n  /** Creates a copy of this selection **/\r\n\r\n\r\n  Selection_createClass(Selection, [{\r\n    key: \"context\",\r\n    get: function get() {\r\n      return this.underlying['@context'];\r\n    }\r\n  }, {\r\n    key: \"type\",\r\n    get: function get() {\r\n      return this.underlying.type;\r\n    }\r\n  }, {\r\n    key: \"body\",\r\n    get: function get() {\r\n      return this.underlying.body;\r\n    }\r\n  }, {\r\n    key: \"target\",\r\n    get: function get() {\r\n      return this.underlying.target;\r\n    }\r\n  }, {\r\n    key: \"targets\",\r\n    get: function get() {\r\n      return Array.isArray(this.underlying.target) ? this.underlying.target : [this.underlying.target];\r\n    }\r\n    /** For consistency with WebAnnotation **/\r\n\r\n  }, {\r\n    key: \"isEqual\",\r\n    value: function isEqual(other) {\r\n      if (!other) {\r\n        return false;\r\n      } else {\r\n        return fast_deep_equal_default()(this.underlying, other.underlying);\r\n      }\r\n    }\r\n  }, {\r\n    key: \"bodies\",\r\n    get: function get() {\r\n      return Array.isArray(this.underlying.body) ? this.underlying.body : [this.underlying.body];\r\n    }\r\n  }, {\r\n    key: \"quote\",\r\n    get:\r\n    /** Shorthand for the 'exact' field of the TextQuoteSelector **/\r\n    function get() {\r\n      var _this$selector;\r\n\r\n      return (_this$selector = this.selector('TextQuoteSelector')) === null || _this$selector === void 0 ? void 0 : _this$selector.exact;\r\n    }\r\n    /*******************************************/\r\n\r\n    /* Selection-specific properties & methods */\r\n\r\n    /*******************************************/\r\n\r\n  }, {\r\n    key: \"isSelection\",\r\n    get: function get() {\r\n      return true;\r\n    }\r\n  }]);\r\n\r\n  return Selection;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/tools/Tool.js\r\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\r\n\r\nfunction Tool_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction Tool_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction Tool_createClass(Constructor, protoProps, staticProps) { if (protoProps) Tool_defineProperties(Constructor.prototype, protoProps); if (staticProps) Tool_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) _setPrototypeOf(subClass, superClass); }\r\n\r\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\r\n\r\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\r\n\r\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\r\n\r\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\r\n\r\nfunction Tool_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\nvar IMPLEMENTATION_MISSING = \"An implementation is missing\";\r\nvar isTouch = isTouchDevice();\r\n/**\r\n * A commmon base class for Tools and EditableShapes\r\n */\r\n\r\nvar ToolLike = /*#__PURE__*/function (_EventEmitter) {\r\n  _inherits(ToolLike, _EventEmitter);\r\n\r\n  var _super = _createSuper(ToolLike);\r\n\r\n  function ToolLike(g, config, env) {\r\n    var _this;\r\n\r\n    Tool_classCallCheck(this, ToolLike);\r\n\r\n    _this = _super.call(this);\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this), \"enableResponsive\", function () {\r\n      if (window.ResizeObserver) {\r\n        _this.resizeObserver = new ResizeObserver(function () {\r\n          var svgBounds = _this.svg.getBoundingClientRect();\r\n\r\n          var _this$svg$viewBox$bas = _this.svg.viewBox.baseVal,\r\n              width = _this$svg$viewBox$bas.width,\r\n              height = _this$svg$viewBox$bas.height;\r\n          _this.scale = Math.max(width / svgBounds.width, height / svgBounds.height);\r\n          if (_this.onScaleChanged) _this.onScaleChanged(_this.scale);\r\n        });\r\n\r\n        _this.resizeObserver.observe(_this.svg.parentNode);\r\n      }\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this), \"getSVGPoint\", function (evt) {\r\n      var pt = _this.svg.createSVGPoint();\r\n\r\n      if (isTouch) {\r\n        var bbox = _this.svg.getBoundingClientRect();\r\n\r\n        var x = evt.clientX - bbox.x;\r\n        var y = evt.clientY - bbox.y;\r\n\r\n        var _this$svg$getBounding = _this.svg.getBoundingClientRect(),\r\n            left = _this$svg$getBounding.left,\r\n            top = _this$svg$getBounding.top;\r\n\r\n        pt.x = x + left;\r\n        pt.y = y + top;\r\n        return pt.matrixTransform(_this.g.getScreenCTM().inverse());\r\n      } else {\r\n        pt.x = evt.offsetX;\r\n        pt.y = evt.offsetY;\r\n        return pt.matrixTransform(_this.g.getCTM().inverse());\r\n      }\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this), \"drawHandle\", function (x, y) {\r\n      var containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n      containerGroup.setAttribute('class', 'a9s-handle');\r\n      var group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n\r\n      var drawCircle = function drawCircle(r) {\r\n        var c = document.createElementNS(SVG_SVG_NAMESPACE, 'circle');\r\n        c.setAttribute('cx', x);\r\n        c.setAttribute('cy', y);\r\n        c.setAttribute('r', r);\r\n        c.setAttribute('transform-origin', \"\".concat(x, \" \").concat(y));\r\n        return c;\r\n      };\r\n\r\n      var radius = _this.config.handleRadius || 6;\r\n      var inner = drawCircle(radius);\r\n      inner.setAttribute('class', 'a9s-handle-inner');\r\n      var outer = drawCircle(radius + 1);\r\n      outer.setAttribute('class', 'a9s-handle-outer');\r\n      group.appendChild(outer);\r\n      group.appendChild(inner);\r\n      containerGroup.appendChild(group);\r\n      return containerGroup;\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this), \"setHandleXY\", function (handle, x, y) {\r\n      var inner = handle.querySelector('.a9s-handle-inner');\r\n      inner.setAttribute('cx', x);\r\n      inner.setAttribute('cy', y);\r\n      inner.setAttribute('transform-origin', \"\".concat(x, \" \").concat(y));\r\n      var outer = handle.querySelector('.a9s-handle-outer');\r\n      outer.setAttribute('cx', x);\r\n      outer.setAttribute('cy', y);\r\n      outer.setAttribute('transform-origin', \"\".concat(x, \" \").concat(y));\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this), \"getHandleXY\", function (handle) {\r\n      var outer = handle.querySelector('.a9s-handle-outer');\r\n      return {\r\n        x: parseFloat(outer.getAttribute('cx')),\r\n        y: parseFloat(outer.getAttribute('cy'))\r\n      };\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this), \"scaleHandle\", function (handle) {\r\n      var inner = handle.querySelector('.a9s-handle-inner');\r\n      var outer = handle.querySelector('.a9s-handle-outer');\r\n      var radius = _this.scale * (_this.config.handleRadius || 6);\r\n      inner.setAttribute('r', radius);\r\n      outer.setAttribute('r', radius);\r\n    });\r\n\r\n    _this.svg = g.closest('svg');\r\n    _this.g = g;\r\n    _this.config = config;\r\n    _this.env = env; // Default image scale\r\n\r\n    _this.scale = 1; // Bit of a hack. If we are dealing with a 'real' image, we enable\r\n    // reponsive mode. OpenSeadragon handles scaling in a different way,\r\n    // so we don't need responsive mode.\r\n\r\n    var image = env.image;\r\n    if (image instanceof Element || image instanceof HTMLDocument) _this.enableResponsive();\r\n    return _this;\r\n  }\r\n  /**\r\n   * Implementations MAY extend this (calling super),\r\n   * to destroy SVG elements, mask, etc.\r\n   */\r\n\r\n\r\n  Tool_createClass(ToolLike, [{\r\n    key: \"destroy\",\r\n    value: function destroy() {\r\n      if (this.resizeObserver) this.resizeObserver.disconnect();\r\n      this.resizeObserver = null;\r\n    }\r\n  }]);\r\n\r\n  return ToolLike;\r\n}((tiny_emitter_default()));\r\n/**\r\n * Base class that adds some convenience stuff for tool plugins.\r\n */\r\n\r\nvar Tool = /*#__PURE__*/function (_ToolLike) {\r\n  _inherits(Tool, _ToolLike);\r\n\r\n  var _super2 = _createSuper(Tool);\r\n\r\n  function Tool(g, config, env) {\r\n    var _this2;\r\n\r\n    Tool_classCallCheck(this, Tool);\r\n\r\n    _this2 = _super2.call(this, g, config, env); // We'll keep a flag set to false until\r\n    // the user has started moving, so we can\r\n    // fire the startSelection event\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this2), \"attachListeners\", function (_ref) {\r\n      var mouseMove = _ref.mouseMove,\r\n          mouseUp = _ref.mouseUp,\r\n          dblClick = _ref.dblClick;\r\n\r\n      // Handle SVG conversion on behalf of tool implementations\r\n      if (mouseMove) {\r\n        _this2.mouseMove = function (evt) {\r\n          var _this2$getSVGPoint = _this2.getSVGPoint(evt),\r\n              x = _this2$getSVGPoint.x,\r\n              y = _this2$getSVGPoint.y;\r\n\r\n          if (!_this2.started) {\r\n            _this2.emit('startSelection', {\r\n              x: x,\r\n              y: y\r\n            });\r\n\r\n            _this2.started = true;\r\n          }\r\n\r\n          mouseMove(x, y, evt);\r\n        }; // Mouse move goes on SVG element\r\n\r\n\r\n        _this2.svg.addEventListener('mousemove', _this2.mouseMove);\r\n      }\r\n\r\n      if (mouseUp) {\r\n        _this2.mouseUp = function (evt) {\r\n          if (evt.button !== 0) return; // left click\r\n\r\n          var _this2$getSVGPoint2 = _this2.getSVGPoint(evt),\r\n              x = _this2$getSVGPoint2.x,\r\n              y = _this2$getSVGPoint2.y;\r\n\r\n          mouseUp(x, y, evt);\r\n        }; // Mouse up goes on doc, so we capture events outside, too\r\n\r\n\r\n        document.addEventListener('mouseup', _this2.mouseUp);\r\n      }\r\n\r\n      if (dblClick) {\r\n        _this2.dblClick = function (evt) {\r\n          var _this2$getSVGPoint3 = _this2.getSVGPoint(evt),\r\n              x = _this2$getSVGPoint3.x,\r\n              y = _this2$getSVGPoint3.y;\r\n\r\n          dblClick(x, y, evt);\r\n        };\r\n\r\n        document.addEventListener('dblclick', _this2.dblClick);\r\n      }\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this2), \"detachListeners\", function () {\r\n      if (_this2.mouseMove) _this2.svg.removeEventListener('mousemove', _this2.mouseMove);\r\n      if (_this2.mouseUp) document.removeEventListener('mouseup', _this2.mouseUp);\r\n      if (_this2.dblClick) document.removeEventListener('dblclick', _this2.dblClick);\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this2), \"start\", function (evt, startOnSingleClick) {\r\n      // Handle SVG conversion on behalf of tool implementations\r\n      var _this2$getSVGPoint4 = _this2.getSVGPoint(evt),\r\n          x = _this2$getSVGPoint4.x,\r\n          y = _this2$getSVGPoint4.y;\r\n\r\n      _this2.startDrawing(x, y, startOnSingleClick, evt);\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this2), \"startDrawing\", function (evt) {\r\n      throw new Error(IMPLEMENTATION_MISSING);\r\n    });\r\n\r\n    Tool_defineProperty(_assertThisInitialized(_this2), \"createEditableShape\", function (annotation, formatters) {\r\n      throw new Error(IMPLEMENTATION_MISSING);\r\n    });\r\n\r\n    _this2.started = false;\r\n    return _this2;\r\n  }\r\n\r\n  Tool_createClass(Tool, [{\r\n    key: \"isDrawing\",\r\n    get:\r\n    /**\r\n     * Tool implementations MUST override these\r\n     */\r\n    function get() {\r\n      throw new Error(IMPLEMENTATION_MISSING);\r\n    }\r\n  }]);\r\n\r\n  return Tool;\r\n}(ToolLike); // In addition, Tool implementations need to implement the following static methods\r\n// Tool.identifier = '...'\r\n\r\n\r\n\r\n\r\nTool.supports = function (annotation) {\r\n  throw new Error(IMPLEMENTATION_MISSING);\r\n}; // Just some convenience shortcuts to client-core, for quicker\r\n// importing in plugins. (In a way, the intention is to make the\r\n// Tool class serve as a kind of mini-SDK).\r\n\r\n\r\n\r\n\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/tools/EditableShape.js\r\nfunction EditableShape_typeof(obj) { \"@babel/helpers - typeof\"; return EditableShape_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, EditableShape_typeof(obj); }\r\n\r\nfunction EditableShape_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction EditableShape_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction EditableShape_createClass(Constructor, protoProps, staticProps) { if (protoProps) EditableShape_defineProperties(Constructor.prototype, protoProps); if (staticProps) EditableShape_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction EditableShape_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) EditableShape_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction EditableShape_setPrototypeOf(o, p) { EditableShape_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return EditableShape_setPrototypeOf(o, p); }\r\n\r\nfunction EditableShape_createSuper(Derived) { var hasNativeReflectConstruct = EditableShape_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = EditableShape_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = EditableShape_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return EditableShape_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction EditableShape_possibleConstructorReturn(self, call) { if (call && (EditableShape_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return EditableShape_assertThisInitialized(self); }\r\n\r\nfunction EditableShape_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction EditableShape_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction EditableShape_getPrototypeOf(o) { EditableShape_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return EditableShape_getPrototypeOf(o); }\r\n\r\nfunction EditableShape_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\nvar EditableShape_IMPLEMENTATION_MISSING = \"An implementation is missing\";\r\n\r\nvar EditableShape = /*#__PURE__*/function (_ToolLike) {\r\n  EditableShape_inherits(EditableShape, _ToolLike);\r\n\r\n  var _super = EditableShape_createSuper(EditableShape);\r\n\r\n  function EditableShape(annotation, g, config, env) {\r\n    var _this;\r\n\r\n    EditableShape_classCallCheck(this, EditableShape);\r\n\r\n    _this = _super.call(this, g, config, env);\r\n\r\n    EditableShape_defineProperty(EditableShape_assertThisInitialized(_this), \"updateState\", function (annotation) {\r\n      throw new Error(EditableShape_IMPLEMENTATION_MISSING);\r\n    });\r\n\r\n    _this.annotation = annotation;\r\n    return _this;\r\n  }\r\n  /**\r\n   * Implementations MUST override this method!\r\n   * \r\n   * Must return the 'g' element with the a9s-annotation class.\r\n   */\r\n\r\n\r\n  EditableShape_createClass(EditableShape, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      throw new Error(EditableShape_IMPLEMENTATION_MISSING);\r\n    }\r\n    /**\r\n     * Implementations MUST override this method!\r\n     * \r\n     * The annotation argument MUST be used to update\r\n     * the current state of the shape. It MUST NOT\r\n     * be stored as 'this.annotation'! 'this.annotation'\r\n     * MUST remain the original annotation at the time\r\n     * this EditableShape was created, because we will\r\n     * need it again in case the user cancels editing.\r\n     * \r\n     * Thinking of it in React terms, 'this.annotation'\r\n     * has the same purpose as props.annotation, whereas\r\n     * this method affects state.\r\n     */\r\n\r\n  }]);\r\n\r\n  return EditableShape;\r\n}(ToolLike);\r\n\r\n\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/selectors/RectFragment.js\r\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\r\n\r\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\r\n\r\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\r\n\r\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\r\n\r\n\r\n/** \r\n * Parses a W3C Web Annotation FragmentSelector conforming\r\n * to the Media Fragments spec. Supports (well-formed) xywh=pixel\r\n * and xywh=percent fragments. \r\n */\r\n\r\nvar parseRectFragment = function parseRectFragment(annotation, image) {\r\n  var selector = annotation.selector('FragmentSelector');\r\n\r\n  if (selector !== null && selector !== void 0 && selector.conformsTo.startsWith('http://www.w3.org/TR/media-frags')) {\r\n    var value = selector.value;\r\n    var format = value.includes(':') ? value.substring(value.indexOf('=') + 1, value.indexOf(':')) : 'pixel';\r\n    var coords = value.includes(':') ? value.substring(value.indexOf(':') + 1) : value.substring(value.indexOf('=') + 1);\r\n\r\n    var _coords$split$map = coords.split(',').map(parseFloat),\r\n        _coords$split$map2 = _slicedToArray(_coords$split$map, 4),\r\n        x = _coords$split$map2[0],\r\n        y = _coords$split$map2[1],\r\n        w = _coords$split$map2[2],\r\n        h = _coords$split$map2[3];\r\n\r\n    if (format.toLowerCase() === 'percent') {\r\n      x = x * image.naturalWidth / 100;\r\n      y = y * image.naturalHeight / 100;\r\n      w = w * image.naturalWidth / 100;\r\n      h = h * image.naturalHeight / 100;\r\n    }\r\n\r\n    return {\r\n      x: x,\r\n      y: y,\r\n      w: w,\r\n      h: h\r\n    };\r\n  }\r\n};\r\n/** \r\n * Serializes a (x, y, w, h)-tuple as Media Fragment selector\r\n * using pixel coordinates.\r\n */\r\n\r\nvar toPixelRectFragment = function toPixelRectFragment(x, y, w, h, image) {\r\n  return {\r\n    source: image === null || image === void 0 ? void 0 : image.src,\r\n    selector: {\r\n      type: \"FragmentSelector\",\r\n      conformsTo: \"http://www.w3.org/TR/media-frags/\",\r\n      value: \"xywh=pixel:\".concat(x, \",\").concat(y, \",\").concat(w, \",\").concat(h)\r\n    }\r\n  };\r\n};\r\n/** \r\n * Serializes a (x, y, w, h)-tuple as Media Fragment selector \r\n * using percent coordinates.\r\n */\r\n\r\n\r\nvar toPercentRectFragment = function toPercentRectFragment(x, y, w, h, image) {\r\n  var px = x / image.naturalWidth * 100;\r\n  var py = y / image.naturalHeight * 100;\r\n  var pw = w / image.naturalWidth * 100;\r\n  var ph = h / image.naturalHeight * 100;\r\n  return {\r\n    source: image.src,\r\n    selector: {\r\n      type: \"FragmentSelector\",\r\n      conformsTo: \"http://www.w3.org/TR/media-frags/\",\r\n      value: \"xywh=percent:\".concat(px, \",\").concat(py, \",\").concat(pw, \",\").concat(ph)\r\n    }\r\n  };\r\n};\r\n\r\nvar toRectFragment = function toRectFragment(x, y, w, h, image, fragmentUnit) {\r\n  return (fragmentUnit === null || fragmentUnit === void 0 ? void 0 : fragmentUnit.toLowerCase()) === 'percent' ? toPercentRectFragment(x, y, w, h, image) : toPixelRectFragment(x, y, w, h, image);\r\n};\r\n/** Shorthand to apply the given (x, y, w, h) to the SVG shape **/\r\n\r\nvar setXYWH = function setXYWH(shape, x, y, w, h) {\r\n  shape.setAttribute('x', x);\r\n  shape.setAttribute('y', y);\r\n  shape.setAttribute('width', w);\r\n  shape.setAttribute('height', h);\r\n};\r\n\r\nvar setPointXY = function setPointXY(shape, x, y) {\r\n  shape.setAttribute('cx', x);\r\n  shape.setAttribute('cy', y);\r\n  shape.setAttribute('r', 7); // TODO make configurable\r\n};\r\n\r\nvar drawRectMask = function drawRectMask(imageDimensions, x, y, w, h) {\r\n  var mask = document.createElementNS(SVG_NAMESPACE, 'path');\r\n  mask.setAttribute('fill-rule', 'evenodd');\r\n  var naturalWidth = imageDimensions.naturalWidth,\r\n      naturalHeight = imageDimensions.naturalHeight;\r\n  mask.setAttribute('d', \"M0 0 h\".concat(naturalWidth, \" v\").concat(naturalHeight, \" h-\").concat(naturalWidth, \" z M\").concat(x, \" \").concat(y, \" h\").concat(w, \" v\").concat(h, \" h-\").concat(w, \" z\"));\r\n  return mask;\r\n};\r\nvar setRectMaskSize = function setRectMaskSize(mask, imageDimensions, x, y, w, h) {\r\n  var naturalWidth = imageDimensions.naturalWidth,\r\n      naturalHeight = imageDimensions.naturalHeight;\r\n  mask.setAttribute('d', \"M0 0 h\".concat(naturalWidth, \" v\").concat(naturalHeight, \" h-\").concat(naturalWidth, \" z M\").concat(x, \" \").concat(y, \" h\").concat(w, \" v\").concat(h, \" h-\").concat(w, \" z\"));\r\n};\r\n/** \r\n * Draws an SVG rectangle, either from an annotation, or an\r\n * (x, y, w, h)-tuple.\r\n */\r\n\r\nvar drawRect = function drawRect(arg1, arg2, arg3, arg4) {\r\n  var _ref = arg1.type === 'Annotation' || arg1.type === 'Selection' ? parseRectFragment(arg1, arg2) : {\r\n    x: arg1,\r\n    y: arg2,\r\n    w: arg3,\r\n    h: arg4\r\n  },\r\n      x = _ref.x,\r\n      y = _ref.y,\r\n      w = _ref.w,\r\n      h = _ref.h;\r\n\r\n  var g = document.createElementNS(SVG_NAMESPACE, 'g');\r\n\r\n  if (w === 0 && h === 0) {\r\n    // Edge case: rect is actually a point\r\n    addClass(g, 'a9s-point');\r\n    addClass(g, 'a9s-non-scaling');\r\n    g.setAttribute('transform-origin', \"\".concat(x, \" \").concat(y));\r\n    var outerPoint = document.createElementNS(SVG_NAMESPACE, 'circle');\r\n    var innerPoint = document.createElementNS(SVG_NAMESPACE, 'circle');\r\n    innerPoint.setAttribute('class', 'a9s-inner');\r\n    setPointXY(innerPoint, x, y);\r\n    outerPoint.setAttribute('class', 'a9s-outer');\r\n    setPointXY(outerPoint, x, y);\r\n    g.appendChild(outerPoint);\r\n    g.appendChild(innerPoint);\r\n  } else {\r\n    var outerRect = document.createElementNS(SVG_NAMESPACE, 'rect');\r\n    var innerRect = document.createElementNS(SVG_NAMESPACE, 'rect');\r\n    innerRect.setAttribute('class', 'a9s-inner');\r\n    setXYWH(innerRect, x, y, w, h);\r\n    outerRect.setAttribute('class', 'a9s-outer');\r\n    setXYWH(outerRect, x, y, w, h);\r\n    g.appendChild(outerRect);\r\n    g.appendChild(innerRect);\r\n  }\r\n\r\n  return g;\r\n};\r\n/** Gets the (x, y, w, h)-values from the attributes of the SVG group **/\r\n\r\nvar getRectSize = function getRectSize(g) {\r\n  var outer = g.querySelector('.a9s-outer');\r\n\r\n  if (outer.nodeName === 'rect') {\r\n    var x = parseFloat(outer.getAttribute('x'));\r\n    var y = parseFloat(outer.getAttribute('y'));\r\n    var w = parseFloat(outer.getAttribute('width'));\r\n    var h = parseFloat(outer.getAttribute('height'));\r\n    return {\r\n      x: x,\r\n      y: y,\r\n      w: w,\r\n      h: h\r\n    };\r\n  } else {\r\n    var _x = parseFloat(outer.getAttribute('cx'));\r\n\r\n    var _y = parseFloat(outer.getAttribute('cy'));\r\n\r\n    return {\r\n      x: _x,\r\n      y: _y,\r\n      w: 0,\r\n      h: 0\r\n    };\r\n  }\r\n};\r\n/** Applies the (x, y, w, h)-values to the rects in the SVG group **/\r\n\r\nvar setRectSize = function setRectSize(g, x, y, w, h) {\r\n  var inner = g.querySelector('.a9s-inner');\r\n  var outer = g.querySelector('.a9s-outer');\r\n\r\n  if (outer.nodeName === 'rect') {\r\n    setXYWH(inner, x, y, w, h);\r\n    setXYWH(outer, x, y, w, h);\r\n  } else {\r\n    setPointXY(inner, x, y);\r\n    setPointXY(outer, x, y);\r\n  }\r\n};\r\n/** \r\n * Shorthand to get the area (rectangle w x h) from the \r\n * annotation's fragment selector. \r\n */\r\n\r\nvar rectArea = function rectArea(annotation, image) {\r\n  var _parseRectFragment = parseRectFragment(annotation, image),\r\n      w = _parseRectFragment.w,\r\n      h = _parseRectFragment.h;\r\n\r\n  return w * h;\r\n};\r\n;// CONCATENATED MODULE: ./src/point/Point.js\r\nfunction Point_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\r\n\r\nfunction Point_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? Point_ownKeys(Object(source), !0).forEach(function (key) { Point_defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : Point_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\r\n\r\nfunction Point_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\nvar isPoint = function isPoint(annotation) {\r\n  var _annotation$target$re;\r\n\r\n  return ((_annotation$target$re = annotation.target.renderedVia) === null || _annotation$target$re === void 0 ? void 0 : _annotation$target$re.name) === 'point';\r\n};\r\nvar toFragment = function toFragment(x, y, image, fragmentUnit) {\r\n  return Point_objectSpread(Point_objectSpread({}, toRectFragment(x, y, 0, 0, image, fragmentUnit)), {}, {\r\n    renderedVia: {\r\n      name: 'point'\r\n    }\r\n  });\r\n};\r\n;// CONCATENATED MODULE: ./src/point/EditablePoint.js\r\nfunction EditablePoint_typeof(obj) { \"@babel/helpers - typeof\"; return EditablePoint_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, EditablePoint_typeof(obj); }\r\n\r\nfunction EditablePoint_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction EditablePoint_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction EditablePoint_createClass(Constructor, protoProps, staticProps) { if (protoProps) EditablePoint_defineProperties(Constructor.prototype, protoProps); if (staticProps) EditablePoint_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction _get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get.bind(); } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return _get.apply(this, arguments); }\r\n\r\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = EditablePoint_getPrototypeOf(object); if (object === null) break; } return object; }\r\n\r\nfunction EditablePoint_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) EditablePoint_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction EditablePoint_setPrototypeOf(o, p) { EditablePoint_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return EditablePoint_setPrototypeOf(o, p); }\r\n\r\nfunction EditablePoint_createSuper(Derived) { var hasNativeReflectConstruct = EditablePoint_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = EditablePoint_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = EditablePoint_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return EditablePoint_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction EditablePoint_possibleConstructorReturn(self, call) { if (call && (EditablePoint_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return EditablePoint_assertThisInitialized(self); }\r\n\r\nfunction EditablePoint_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction EditablePoint_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction EditablePoint_getPrototypeOf(o) { EditablePoint_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return EditablePoint_getPrototypeOf(o); }\r\n\r\nfunction EditablePoint_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar EditablePoint = /*#__PURE__*/function (_EditableShape) {\r\n  EditablePoint_inherits(EditablePoint, _EditableShape);\r\n\r\n  var _super = EditablePoint_createSuper(EditablePoint);\r\n\r\n  function EditablePoint(_annotation, g, config, env) {\r\n    var _this;\r\n\r\n    EditablePoint_classCallCheck(this, EditablePoint);\r\n\r\n    _this = _super.call(this, _annotation, g, config, env);\r\n\r\n    EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"onScaleChanged\", function () {\r\n      return _this.scaleHandle(_this.point);\r\n    });\r\n\r\n    EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"onGrab\", function () {\r\n      _this.isGrabbed = true;\r\n    });\r\n\r\n    EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\r\n      if (evt.button !== 0) return; // left click\r\n\r\n      if (_this.isGrabbed) {\r\n        var _this$getSVGPoint = _this.getSVGPoint(evt),\r\n            x = _this$getSVGPoint.x,\r\n            y = _this$getSVGPoint.y;\r\n\r\n        _this.setHandleXY(_this.point, x, y);\r\n\r\n        var target = toFragment(x, y, _this.env.image, _this.config.fragmentUnit);\r\n\r\n        _this.emit('update', target);\r\n      }\r\n    });\r\n\r\n    EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"onMouseUp\", function () {\r\n      _this.isGrabbed = false;\r\n    });\r\n\r\n    EditablePoint_defineProperty(EditablePoint_assertThisInitialized(_this), \"updateState\", function (annotation) {\r\n      var _parseRectFragment = parseRectFragment(annotation, _this.env.image),\r\n          x = _parseRectFragment.x,\r\n          y = _parseRectFragment.y;\r\n\r\n      _this.setHandleXY(_this.point, x, y);\r\n    });\r\n\r\n    _this.svg.addEventListener('mousemove', _this.onMouseMove);\r\n\r\n    _this.svg.addEventListener('mouseup', _this.onMouseUp);\r\n\r\n    var _parseRectFragment2 = parseRectFragment(_annotation, env.image),\r\n        _x = _parseRectFragment2.x,\r\n        _y = _parseRectFragment2.y;\r\n\r\n    _this.container = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n\r\n    _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\r\n\r\n    _this.point = _this.drawHandle(_x, _y);\r\n\r\n    _this.point.addEventListener('mousedown', _this.onGrab);\r\n\r\n    _this.elementGroup.appendChild(_this.point);\r\n\r\n    _this.container.appendChild(_this.elementGroup);\r\n\r\n    g.appendChild(_this.container); // true if te mouse has grabbed the point\r\n\r\n    _this.isGrabbed = false;\r\n    return _this;\r\n  }\r\n\r\n  EditablePoint_createClass(EditablePoint, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.elementGroup;\r\n    }\r\n  }, {\r\n    key: \"destroy\",\r\n    value: function destroy() {\r\n      this.svg.removeEventListener('mousemove', this.onMouseMove);\r\n      this.svg.removeEventListener('mouseup', this.onMouseUp);\r\n      this.container.parentNode.removeChild(this.container);\r\n\r\n      _get(EditablePoint_getPrototypeOf(EditablePoint.prototype), \"destroy\", this).call(this);\r\n    }\r\n  }]);\r\n\r\n  return EditablePoint;\r\n}(EditableShape);\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/point/PointTool.js\r\nfunction PointTool_typeof(obj) { \"@babel/helpers - typeof\"; return PointTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, PointTool_typeof(obj); }\r\n\r\nfunction PointTool_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction PointTool_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction PointTool_createClass(Constructor, protoProps, staticProps) { if (protoProps) PointTool_defineProperties(Constructor.prototype, protoProps); if (staticProps) PointTool_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction PointTool_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) PointTool_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction PointTool_setPrototypeOf(o, p) { PointTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return PointTool_setPrototypeOf(o, p); }\r\n\r\nfunction PointTool_createSuper(Derived) { var hasNativeReflectConstruct = PointTool_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = PointTool_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = PointTool_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return PointTool_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction PointTool_possibleConstructorReturn(self, call) { if (call && (PointTool_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return PointTool_assertThisInitialized(self); }\r\n\r\nfunction PointTool_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction PointTool_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction PointTool_getPrototypeOf(o) { PointTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return PointTool_getPrototypeOf(o); }\r\n\r\nfunction PointTool_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n\r\nvar PointTool = /*#__PURE__*/function (_Tool) {\r\n  PointTool_inherits(PointTool, _Tool);\r\n\r\n  var _super = PointTool_createSuper(PointTool);\r\n\r\n  function PointTool(g, config, env) {\r\n    var _this;\r\n\r\n    PointTool_classCallCheck(this, PointTool);\r\n\r\n    _this = _super.call(this, g, config, env);\r\n\r\n    PointTool_defineProperty(PointTool_assertThisInitialized(_this), \"startDrawing\", function (x, y, _, evt) {\r\n      var _evt$target$closest;\r\n\r\n      // The top-most existing annotation at this position (if any) \r\n      var annotation = (_evt$target$closest = evt.target.closest('.a9s-annotation')) === null || _evt$target$closest === void 0 ? void 0 : _evt$target$closest.annotation; // The point drawing tool will ALWAYS create a point annotation,\r\n      // regardless of whether there's already an annotation underneath.\r\n      // UNLESS the annotation underneath is itself a point!\r\n\r\n      if (!annotation || !isPoint(annotation)) {\r\n        var element = _this.drawHandle(x, y);\r\n\r\n        _this.scaleHandle(element);\r\n\r\n        _this.g.appendChild(element);\r\n\r\n        element.annotation = new Selection(toFragment(x, y, _this.env.image, _this.config.fragmentUnit));\r\n\r\n        _this.emit('complete', element);\r\n      } else {\r\n        _this.emit('cancel');\r\n      }\r\n    });\r\n\r\n    PointTool_defineProperty(PointTool_assertThisInitialized(_this), \"stop\", function () {// Nothing to do\r\n    });\r\n\r\n    PointTool_defineProperty(PointTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\r\n      return new EditablePoint(annotation, _this.g, _this.config, _this.env);\r\n    });\r\n\r\n    return _this;\r\n  }\r\n\r\n  PointTool_createClass(PointTool, [{\r\n    key: \"isDrawing\",\r\n    get: function get() {\r\n      // Point selection is an instant action - the\r\n      // tool is never an 'drawing' state\r\n      return false;\r\n    }\r\n  }]);\r\n\r\n  return PointTool;\r\n}(Tool);\r\n\r\n\r\nPointTool.identifier = 'point';\r\n\r\nPointTool.supports = function (annotation) {\r\n  // Not needed, since the target.renderedVia property will be evaluated first\r\n  return false;\r\n};\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/selectors/EmbeddedSVG.js\r\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = EmbeddedSVG_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\r\n\r\nfunction EmbeddedSVG_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return EmbeddedSVG_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EmbeddedSVG_arrayLikeToArray(o, minLen); }\r\n\r\nfunction EmbeddedSVG_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\n\r\n\r\n/** Helper that forces an un-namespaced node to SVG **/\r\n\r\nvar insertSVGNamespace = function insertSVGNamespace(originalDoc) {\r\n  // Serialize and parse for the namespace to take effect on every node\r\n  var serializer = new XMLSerializer();\r\n  var str = serializer.serializeToString(originalDoc.documentElement); // Doesn't seem that there's a clean cross-browser way for this...\r\n\r\n  var namespaced = str.replace('<svg>', \"<svg xmlns=\\\"\".concat(SVG_SVG_NAMESPACE, \"\\\">\"));\r\n  var parser = new DOMParser();\r\n  var namespacedDoc = parser.parseFromString(namespaced, \"image/svg+xml\");\r\n  return namespacedDoc.documentElement;\r\n};\r\n\r\nvar sanitize = function sanitize(doc) {\r\n  // Cf. https://github.com/mattkrick/sanitize-svg#readme  \r\n  // for the basic approach\r\n  var cleanEl = function cleanEl(el) {\r\n    Array.from(el.attributes).forEach(function (attr) {\r\n      if (attr.name.startsWith('on')) el.removeAttribute(attr.name);\r\n    });\r\n  }; // Remove script tags\r\n\r\n\r\n  var scripts = doc.getElementsByTagName('script');\r\n  Array.from(scripts).reverse().forEach(function (el) {\r\n    return el.parentNode.removeChild(el);\r\n  }); // Remove on... attributes\r\n\r\n  cleanEl(doc);\r\n  Array.from(doc.querySelectorAll('*')).forEach(cleanEl);\r\n  return doc;\r\n};\r\n\r\nvar svgFragmentToShape = function svgFragmentToShape(annotation) {\r\n  var selector = annotation.selector('SvgSelector');\r\n\r\n  if (selector) {\r\n    var parser = new DOMParser(); // Parse the XML document, assuming SVG\r\n\r\n    var value = selector.value;\r\n    var doc = parser.parseFromString(value, \"image/svg+xml\"); // SVG needs a namespace declaration - check if it's set or insert if not\r\n\r\n    var isPrefixDeclared = doc.lookupPrefix(SVG_SVG_NAMESPACE); // SVG declared via prefix\r\n\r\n    var isDefaultNamespaceSVG = doc.lookupNamespaceURI(null); // SVG declared as default namespace\r\n\r\n    if (isPrefixDeclared || isDefaultNamespaceSVG) {\r\n      return sanitize(doc).firstChild;\r\n    } else {\r\n      return sanitize(insertSVGNamespace(doc)).firstChild;\r\n    }\r\n  }\r\n};\r\nvar drawEmbeddedSVG = function drawEmbeddedSVG(annotation) {\r\n  var shape = svgFragmentToShape(annotation); // Because we're nitpicky, we don't just draw the shape,\r\n  // but duplicate it, so we can have inner and an outer lines\r\n\r\n  var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n  var inner = shape.cloneNode(true);\r\n  inner.setAttribute('class', 'a9s-inner');\r\n  var outer = shape.cloneNode(true);\r\n  outer.setAttribute('class', 'a9s-outer');\r\n  g.appendChild(outer);\r\n  g.appendChild(inner);\r\n  return g;\r\n};\r\nvar toSVGTarget = function toSVGTarget(shape, image) {\r\n  var inner = shape.querySelector('.a9s-inner').cloneNode(true);\r\n  inner.removeAttribute('class');\r\n  inner.removeAttribute('xmlns');\r\n  var serialized = inner.outerHTML || new XMLSerializer().serializeToString(inner);\r\n  serialized = serialized.replace(\" xmlns=\\\"\".concat(SVG_SVG_NAMESPACE, \"\\\"\"), '');\r\n  return {\r\n    source: image === null || image === void 0 ? void 0 : image.src,\r\n    selector: {\r\n      type: \"SvgSelector\",\r\n      value: \"<svg>\".concat(serialized, \"</svg>\")\r\n    }\r\n  };\r\n};\r\nvar svgArea = function svgArea(annotation) {\r\n  var shape = svgFragmentToShape(annotation);\r\n  var nodeName = shape.nodeName.toLowerCase();\r\n  if (nodeName === 'polygon') return svgPolygonArea(shape);else if (nodeName === 'circle') return svgCircleArea(shape);else if (nodeName === 'ellipse') return svgEllipseArea(shape);else if (nodeName == 'path') return svgPathArea(shape);else if (nodeName == 'line') return 0;else throw \"Unsupported SVG shape type: \".concat(nodeName);\r\n};\r\n\r\nvar svgPolygonArea = function svgPolygonArea(polygon) {\r\n  var points = polygon.getAttribute('points').trim().split(' ') // Split x/y tuples\r\n  .map(function (xy) {\r\n    return xy.split(',').map(function (str) {\r\n      return parseFloat(str.trim());\r\n    });\r\n  });\r\n  return polygonArea(points);\r\n};\r\n\r\nvar svgCircleArea = function svgCircleArea(circle) {\r\n  var r = circle.getAttribute('r');\r\n  return r * r * Math.PI;\r\n};\r\n\r\nvar svgEllipseArea = function svgEllipseArea(ellipse) {\r\n  var rx = ellipse.getAttribute('rx');\r\n  var ry = ellipse.getAttribute('ry');\r\n  return rx * ry * Math.PI;\r\n};\r\n\r\nvar svgPathArea = function svgPathArea(path) {\r\n  var polygons = svgPathToPolygons(path);\r\n\r\n  if (polygons.length == 1) {\r\n    return polygonArea(polygons[0]);\r\n  } else {\r\n    // Helper to check if a polygon is a hole\r\n    var isHole = function isHole(p) {\r\n      return polygons.find(function (other) {\r\n        if (p !== other) return polygonInPolygon(p, other);\r\n      });\r\n    };\r\n\r\n    var area = 0;\r\n\r\n    var _iterator = _createForOfIteratorHelper(polygons),\r\n        _step;\r\n\r\n    try {\r\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\r\n        var poly = _step.value;\r\n        if (isHole(poly)) area -= polygonArea(poly);else area += polygonArea(poly);\r\n      }\r\n    } catch (err) {\r\n      _iterator.e(err);\r\n    } finally {\r\n      _iterator.f();\r\n    }\r\n\r\n    return area;\r\n  }\r\n};\r\n;// CONCATENATED MODULE: ./src/circle/Circle.js\r\n\r\n/** Shorthand to apply the given (x, y, r) to the SVG shape **/\r\n\r\nvar setXYR = function setXYR(shape, x, y, r) {\r\n  shape.setAttribute('cx', x);\r\n  shape.setAttribute('cy', y);\r\n  shape.setAttribute('r', r);\r\n};\r\n/** \r\n * Draws an SVG circle, either from an annotation, or an\r\n * (cx, cy, r)-tuple.\r\n */\r\n\r\n\r\nvar drawCircle = function drawCircle(cx, cy, r) {\r\n  var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n  var outerCircle = document.createElementNS(SVG_SVG_NAMESPACE, 'circle');\r\n  var innerCircle = document.createElementNS(SVG_SVG_NAMESPACE, 'circle');\r\n  innerCircle.setAttribute('class', 'a9s-inner');\r\n  setXYR(innerCircle, cx, cy, r);\r\n  outerCircle.setAttribute('class', 'a9s-outer');\r\n  setXYR(outerCircle, cx, cy, r);\r\n  g.appendChild(outerCircle);\r\n  g.appendChild(innerCircle);\r\n  return g;\r\n};\r\nvar setCircleSize = function setCircleSize(g, cx, cy, r) {\r\n  var innerCircle = g.querySelector('.a9s-inner');\r\n  var outerCircle = g.querySelector('.a9s-outer');\r\n  setXYR(innerCircle, cx, cy, r);\r\n  setXYR(outerCircle, cx, cy, r);\r\n};\r\nvar getCircleSize = function getCircleSize(g) {\r\n  var outerCircle = g.querySelector('.a9s-outer');\r\n  var cx = parseFloat(outerCircle.getAttribute('cx'));\r\n  var cy = parseFloat(outerCircle.getAttribute('cy'));\r\n  var r = parseFloat(outerCircle.getAttribute('r'));\r\n  return {\r\n    cx: cx,\r\n    cy: cy,\r\n    r: r\r\n  };\r\n};\r\n;// CONCATENATED MODULE: ./src/circle/CircleMask.js\r\nfunction CircleMask_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction CircleMask_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction CircleMask_createClass(Constructor, protoProps, staticProps) { if (protoProps) CircleMask_defineProperties(Constructor.prototype, protoProps); if (staticProps) CircleMask_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction CircleMask_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\nvar CircleMask = /*#__PURE__*/function () {\r\n  function CircleMask(imageDimensions, circle) {\r\n    var _this = this;\r\n\r\n    CircleMask_classCallCheck(this, CircleMask);\r\n\r\n    CircleMask_defineProperty(this, \"redraw\", function () {\r\n      var _getCircleSize = getCircleSize(_this.circle),\r\n          cx = _getCircleSize.cx,\r\n          cy = _getCircleSize.cy,\r\n          r = _getCircleSize.r;\r\n\r\n      var tx = cx + r > _this.w ? _this.w - r : cx;\r\n      var ty = cy + r > _this.h ? _this.h - r : cy + r;\r\n\r\n      _this.mask.setAttribute('d', \"M0 0 h\".concat(_this.w, \" v\").concat(_this.h, \" h-\").concat(_this.w, \" z M\").concat(tx, \" \").concat(ty, \" a \").concat(r, \" \").concat(r, \" 0 1 1 1 0\"));\r\n    });\r\n\r\n    CircleMask_defineProperty(this, \"destroy\", function () {\r\n      return _this.mask.parentNode.removeChild(_this.mask);\r\n    });\r\n\r\n    this.w = imageDimensions.naturalWidth;\r\n    this.h = imageDimensions.naturalHeight;\r\n    this.circle = circle;\r\n\r\n    var _getCircleSize2 = getCircleSize(this.circle),\r\n        _cx = _getCircleSize2.cx,\r\n        _cy = _getCircleSize2.cy,\r\n        _r = _getCircleSize2.r;\r\n\r\n    var _tx = _cx + _r > this.w ? this.w - _r : _cx;\r\n\r\n    var _ty = _cy + _r > this.h ? this.h - _r : _cy + _r;\r\n\r\n    this.mask = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\r\n    this.mask.setAttribute('fill-rule', 'evenodd');\r\n    this.mask.setAttribute('class', 'a9s-selection-mask');\r\n    this.mask.setAttribute('d', \"M0 0 h\".concat(this.w, \" v\").concat(this.h, \" h-\").concat(this.w, \" z M\").concat(_tx, \" \").concat(_ty, \" a \").concat(_r, \" \").concat(_r, \" 0 1 1 1 0\"));\r\n  }\r\n\r\n  CircleMask_createClass(CircleMask, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.mask;\r\n    }\r\n  }]);\r\n\r\n  return CircleMask;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/circle/RubberbandCircle.js\r\nfunction RubberbandCircle_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandCircle_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandCircle_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandCircle_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandCircle_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandCircle_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A 'rubberband' selection tool for creating a circle by\r\n * clicking and dragging.\r\n */\r\n\r\nvar RubberbandCircle = /*#__PURE__*/function () {\r\n  function RubberbandCircle(anchorX, anchorY, g, env) {\r\n    var _this = this;\r\n\r\n    RubberbandCircle_classCallCheck(this, RubberbandCircle);\r\n\r\n    RubberbandCircle_defineProperty(this, \"dragTo\", function (oppositeX, oppositeY) {\r\n      var _this$env$image = _this.env.image,\r\n          naturalWidth = _this$env$image.naturalWidth,\r\n          naturalHeight = _this$env$image.naturalHeight; // Make visible\r\n\r\n      _this.group.style.display = null;\r\n      var w = oppositeX - _this.anchor[0];\r\n      var h = oppositeY - _this.anchor[1];\r\n      var r = Math.max(1, Math.pow(Math.pow(w, 2) + Math.pow(h, 2), 0.5) / 2);\r\n      var cx = _this.anchor[0] + w / 2;\r\n      var cy = _this.anchor[1] + h / 2;\r\n      if (cx - r < 0 || cx + r > naturalWidth || cy - r < 0 || cy + r > naturalHeight) return;\r\n      setCircleSize(_this.circle, cx, cy, r);\r\n\r\n      _this.mask.redraw();\r\n    });\r\n\r\n    RubberbandCircle_defineProperty(this, \"getBoundingClientRect\", function () {\r\n      return _this.circle.getBoundingClientRect();\r\n    });\r\n\r\n    RubberbandCircle_defineProperty(this, \"toSelection\", function () {\r\n      return new Selection(toSVGTarget(_this.group, _this.env.image));\r\n    });\r\n\r\n    RubberbandCircle_defineProperty(this, \"destroy\", function () {\r\n      _this.group.parentNode.removeChild(_this.group);\r\n\r\n      _this.mask = null;\r\n      _this.circle = null;\r\n      _this.group = null;\r\n    });\r\n\r\n    this.anchor = [anchorX, anchorY];\r\n    this.env = env;\r\n    this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    this.circle = drawCircle(anchorX, anchorY, 2);\r\n    this.circle.setAttribute('class', 'a9s-selection');\r\n    this.mask = new CircleMask(env.image, this.circle); // We make the selection transparent to \r\n    // pointer events because it would interfere with the \r\n    // rendered annotations' mouseleave/enter events\r\n\r\n    this.group.style.pointerEvents = 'none'; // Additionally, selection remains hidden until \r\n    // the user actually moves the mouse\r\n\r\n    this.group.style.display = 'none';\r\n    this.group.appendChild(this.mask.element);\r\n    this.group.appendChild(this.circle);\r\n    g.appendChild(this.group);\r\n  }\r\n\r\n  RubberbandCircle_createClass(RubberbandCircle, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.circle;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandCircle;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/util/Formatting.js\r\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || Formatting_unsupportedIterableToArray(arr) || _nonIterableSpread(); }\r\n\r\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction Formatting_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return Formatting_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return Formatting_arrayLikeToArray(o, minLen); }\r\n\r\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\r\n\r\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return Formatting_arrayLikeToArray(arr); }\r\n\r\nfunction Formatting_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\n\r\nvar isFirefox = /firefox/i.test(navigator.userAgent);\r\n\r\nvar formatSvgEl = function formatSvgEl(svgEl, x, y, w, h) {\r\n  svgEl.setAttribute('width', w);\r\n  svgEl.setAttribute('height', h); // Argh - Firefox produces broken SVG bounds for nested SVG\r\n\r\n  if (isFirefox) {\r\n    svgEl.setAttribute('x', 0);\r\n    svgEl.setAttribute('y', 0);\r\n    svgEl.setAttribute('transform', \"translate(\".concat(x, \", \").concat(y, \")\"));\r\n  } else {\r\n    svgEl.setAttribute('x', x);\r\n    svgEl.setAttribute('y', y);\r\n  }\r\n};\r\n\r\nvar appendFormatterEl = function appendFormatterEl(formatterEl, shape) {\r\n  var _shape$getBBox = shape.getBBox(),\r\n      x = _shape$getBBox.x,\r\n      y = _shape$getBBox.y,\r\n      width = _shape$getBBox.width,\r\n      height = _shape$getBBox.height;\r\n\r\n  var svgEl = document.createElementNS(SVG_SVG_NAMESPACE, 'svg');\r\n  svgEl.setAttribute('class', 'a9s-formatter-el');\r\n  formatSvgEl(svgEl, x, y, width, height);\r\n  var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n  g.appendChild(formatterEl);\r\n  y;\r\n  svgEl.appendChild(g);\r\n  shape.append(svgEl);\r\n};\r\n/**\r\n * A formatter is a user-defined function that takes an annotation as input,\r\n * and returns either a string, or an object. If a string is returned, this\r\n * will be appended to the annotation element CSS class list. Otherwise, the\r\n * object can have the following properties: \r\n * \r\n * - 'className' added to the CSS class list\r\n * - 'data-*' added as data attributes\r\n * - 'style' a list of CSS styles (in the form of a string) \r\n */\r\n\r\n\r\nvar format = function format(shape, annotation, formatters) {\r\n  // The formatter can be undefined\r\n  if (!formatters) return shape; // Merge outputs from all formatter functions into one object\r\n\r\n  var format = formatters.reduce(function (merged, fn) {\r\n    var format = fn(annotation);\r\n    if (!format) return merged;\r\n\r\n    if (typeof format === 'string' || format instanceof String) {\r\n      merged.className = merged.className ? \"\".concat(merged.className, \" \").concat(format) : format;\r\n    } else if (format.nodeType === Node.ELEMENT_NODE) {\r\n      merged.elements = merged.elements ? [].concat(_toConsumableArray(merged.elements), [format]) : [format];\r\n    } else {\r\n      var _className = format.className,\r\n          _style = format.style,\r\n          element = format.element;\r\n      if (_className) merged.className = merged.className ? \"\".concat(merged.className, \" \").concat(_className) : _className;\r\n      if (_style) merged.style = merged.style ? \"\".concat(merged.style, \" \").concat(_style) : _style;\r\n      if (element) merged.elements = merged.elements ? [].concat(_toConsumableArray(merged.elements), [element]) : [element];\r\n    } // Copy data attributes\r\n\r\n\r\n    for (var key in format) {\r\n      if (format.hasOwnProperty(key) && key.startsWith('data-')) {\r\n        merged[key] = format[key];\r\n      }\r\n    }\r\n\r\n    return merged;\r\n  }, {});\r\n  var className = format.className,\r\n      style = format.style,\r\n      elements = format.elements;\r\n  if (className) SVG_addClass(shape, className);\r\n\r\n  if (style) {\r\n    var outer = shape.querySelector('.a9s-outer');\r\n    var inner = shape.querySelector('.a9s-inner');\r\n\r\n    if (outer && inner) {\r\n      outer.setAttribute('style', 'display:none');\r\n      inner.setAttribute('style', style);\r\n    } else {\r\n      shape.setAttribute('style', style);\r\n    }\r\n  }\r\n\r\n  if (elements) elements.forEach(function (el) {\r\n    return appendFormatterEl(el, shape);\r\n  });\r\n\r\n  for (var key in format) {\r\n    if (format.hasOwnProperty(key) && key.startsWith('data-')) {\r\n      shape.setAttribute(key, format[key]);\r\n    }\r\n  }\r\n};\r\nvar setFormatterElSize = function setFormatterElSize(group, x, y, w, h) {\r\n  var formatterEl = group.querySelector('.a9s-formatter-el');\r\n  if (formatterEl) formatSvgEl(formatterEl, x, y, w, h);\r\n};\r\n;// CONCATENATED MODULE: ./src/circle/EditableCircle.js\r\nfunction EditableCircle_typeof(obj) { \"@babel/helpers - typeof\"; return EditableCircle_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, EditableCircle_typeof(obj); }\r\n\r\nfunction EditableCircle_slicedToArray(arr, i) { return EditableCircle_arrayWithHoles(arr) || EditableCircle_iterableToArrayLimit(arr, i) || EditableCircle_unsupportedIterableToArray(arr, i) || EditableCircle_nonIterableRest(); }\r\n\r\nfunction EditableCircle_nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction EditableCircle_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return EditableCircle_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EditableCircle_arrayLikeToArray(o, minLen); }\r\n\r\nfunction EditableCircle_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction EditableCircle_iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\r\n\r\nfunction EditableCircle_arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\r\n\r\nfunction EditableCircle_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction EditableCircle_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction EditableCircle_createClass(Constructor, protoProps, staticProps) { if (protoProps) EditableCircle_defineProperties(Constructor.prototype, protoProps); if (staticProps) EditableCircle_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction EditableCircle_get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { EditableCircle_get = Reflect.get.bind(); } else { EditableCircle_get = function _get(target, property, receiver) { var base = EditableCircle_superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return EditableCircle_get.apply(this, arguments); }\r\n\r\nfunction EditableCircle_superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = EditableCircle_getPrototypeOf(object); if (object === null) break; } return object; }\r\n\r\nfunction EditableCircle_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) EditableCircle_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction EditableCircle_setPrototypeOf(o, p) { EditableCircle_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return EditableCircle_setPrototypeOf(o, p); }\r\n\r\nfunction EditableCircle_createSuper(Derived) { var hasNativeReflectConstruct = EditableCircle_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = EditableCircle_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = EditableCircle_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return EditableCircle_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction EditableCircle_possibleConstructorReturn(self, call) { if (call && (EditableCircle_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return EditableCircle_assertThisInitialized(self); }\r\n\r\nfunction EditableCircle_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction EditableCircle_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction EditableCircle_getPrototypeOf(o) { EditableCircle_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return EditableCircle_getPrototypeOf(o); }\r\n\r\nfunction EditableCircle_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * An editable circle shape.\r\n */\r\n\r\nvar EditableCircle = /*#__PURE__*/function (_EditableShape) {\r\n  EditableCircle_inherits(EditableCircle, _EditableShape);\r\n\r\n  var _super = EditableCircle_createSuper(EditableCircle);\r\n\r\n  function EditableCircle(_annotation, g, config, env) {\r\n    var _this;\r\n\r\n    EditableCircle_classCallCheck(this, EditableCircle);\r\n\r\n    _this = _super.call(this, _annotation, g, config, env);\r\n\r\n    EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"setSize\", function (cx, cy, r) {\r\n      setCircleSize(_this.circle, cx, cy, r);\r\n\r\n      _this.mask.redraw();\r\n\r\n      setFormatterElSize(_this.elementGroup, cx, cy, r, r);\r\n\r\n      var _this$handles = EditableCircle_slicedToArray(_this.handles, 4),\r\n          topleft = _this$handles[0],\r\n          topright = _this$handles[1],\r\n          bottomright = _this$handles[2],\r\n          bottomleft = _this$handles[3];\r\n\r\n      _this.setHandleXY(topleft, cx, cy - r);\r\n\r\n      _this.setHandleXY(topright, cx + r, cy);\r\n\r\n      _this.setHandleXY(bottomright, cx, cy + r);\r\n\r\n      _this.setHandleXY(bottomleft, cx - r, cy);\r\n    });\r\n\r\n    EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"stretchCorners\", function (draggedHandleIdx, anchorHandle, mousePos) {\r\n      var anchor = _this.getHandleXY(anchorHandle);\r\n\r\n      var mouseX = mousePos.x;\r\n      var mouseY = mousePos.y;\r\n      var width = 0;\r\n      var height = 0;\r\n      var r;\r\n\r\n      if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\r\n        mouseX = anchor.x;\r\n        height = mouseY - anchor.y;\r\n        r = Math.abs(height) / 2;\r\n      } else {\r\n        mouseY = anchor.y;\r\n        width = mouseX - anchor.x;\r\n        r = Math.abs(width) / 2;\r\n      }\r\n\r\n      var x = width > 0 ? anchor.x : mouseX;\r\n      var y = height > 0 ? anchor.y : mouseY;\r\n      var w = Math.abs(width);\r\n      var h = Math.abs(height);\r\n      var cx = x + w / 2;\r\n      var cy = y + h / 2;\r\n      setCircleSize(_this.circle, cx, cy, r);\r\n\r\n      _this.mask.redraw();\r\n\r\n      setFormatterElSize(_this.elementGroup, cx, cy, r, r);\r\n\r\n      if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\r\n        var idx0 = 0;\r\n        var idx2 = 2;\r\n\r\n        if (draggedHandleIdx == 0 && height > 0 || draggedHandleIdx == 2 && height < 0) {\r\n          idx0 = 2;\r\n          idx2 = 0;\r\n        }\r\n\r\n        _this.setHandleXY(_this.handles[idx0], cx, cy - r);\r\n\r\n        _this.setHandleXY(_this.handles[idx2], cx, cy + r);\r\n\r\n        _this.setHandleXY(_this.handles[1], cx + r, cy);\r\n\r\n        _this.setHandleXY(_this.handles[3], cx - r, cy);\r\n      } else {\r\n        var idx3 = 3;\r\n        var idx1 = 1;\r\n\r\n        if (draggedHandleIdx == 1 && width > 0 || draggedHandleIdx == 3 && width < 0) {\r\n          idx3 = 1;\r\n          idx1 = 3;\r\n        }\r\n\r\n        _this.setHandleXY(_this.handles[idx3], cx + r, cy);\r\n\r\n        _this.setHandleXY(_this.handles[idx1], cx - r, cy);\r\n\r\n        _this.setHandleXY(_this.handles[0], cx, cy - r);\r\n\r\n        _this.setHandleXY(_this.handles[2], cx, cy + r);\r\n      }\r\n    });\r\n\r\n    EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\r\n      return function (evt) {\r\n        _this.grabbedElem = grabbedElem;\r\n\r\n        var pos = _this.getSVGPoint(evt);\r\n\r\n        var _getCircleSize = getCircleSize(_this.circle),\r\n            cx = _getCircleSize.cx,\r\n            cy = _getCircleSize.cy;\r\n\r\n        _this.grabbedAt = {\r\n          x: pos.x - cx,\r\n          y: pos.y - cy\r\n        };\r\n      };\r\n    });\r\n\r\n    EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\r\n      var constrain = function constrain(coord, max) {\r\n        return coord < 0 ? 0 : coord > max ? max : coord;\r\n      };\r\n\r\n      if (_this.grabbedElem) {\r\n        var pos = _this.getSVGPoint(evt);\r\n\r\n        if (_this.grabbedElem === _this.circle) {\r\n          var _getCircleSize2 = getCircleSize(_this.circle),\r\n              r = _getCircleSize2.r;\r\n\r\n          var _this$env$image = _this.env.image,\r\n              naturalWidth = _this$env$image.naturalWidth,\r\n              naturalHeight = _this$env$image.naturalHeight;\r\n          var cx = Math.max(constrain(pos.x - _this.grabbedAt.x, naturalWidth - r), r);\r\n          var cy = Math.max(constrain(pos.y - _this.grabbedAt.y, naturalHeight - r), r);\r\n\r\n          _this.setSize(cx, cy, r);\r\n\r\n          _this.emit('update', toSVGTarget(_this.circle, _this.env.image));\r\n        } else {\r\n          // Mouse position replaces one of the corner coords, depending\r\n          // on which handle is the grabbed element\r\n          var handleIdx = _this.handles.indexOf(_this.grabbedElem);\r\n\r\n          var oppositeHandle = handleIdx < 2 ? _this.handles[handleIdx + 2] : _this.handles[handleIdx - 2];\r\n\r\n          _this.stretchCorners(handleIdx, oppositeHandle, pos);\r\n\r\n          _this.emit('update', toSVGTarget(_this.circle, _this.env.image));\r\n        }\r\n      }\r\n    });\r\n\r\n    EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"onMouseUp\", function () {\r\n      _this.grabbedElem = null;\r\n      _this.grabbedAt = null;\r\n    });\r\n\r\n    EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"onScaleChanged\", function (scale) {\r\n      return _this.handles.map(_this.scaleHandle);\r\n    });\r\n\r\n    EditableCircle_defineProperty(EditableCircle_assertThisInitialized(_this), \"updateState\", function (annotation) {\r\n      var shape = svgFragmentToShape(annotation);\r\n      var cx = parseFloat(shape.getAttribute('cx'));\r\n      var cy = parseFloat(shape.getAttribute('cy'));\r\n      var r = parseFloat(shape.getAttribute('r'));\r\n\r\n      _this.setSize(cx, cy, r);\r\n    });\r\n\r\n    _this.svg.addEventListener('mousemove', _this.onMouseMove);\r\n\r\n    _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\r\n    // \r\n    // <g>\r\n    //   <path class=\"a9s-selection mask\"... />\r\n    //   <g> <-- return this node as .element\r\n    //     <circle class=\"a9s-outer\" ... />\r\n    //     <circle class=\"a9s-inner\" ... />\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //   </g> \r\n    // </g>\r\n    // 'g' for the editable circle compound shape\r\n\r\n\r\n    _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    _this.circle = drawEmbeddedSVG(_annotation);\r\n\r\n    _this.circle.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.circle));\r\n\r\n    _this.mask = new CircleMask(env.image, _this.circle);\r\n\r\n    _this.containerGroup.appendChild(_this.mask.element); // The 'element' = circle + handles\r\n\r\n\r\n    _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n\r\n    _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\r\n\r\n    _this.elementGroup.appendChild(_this.circle);\r\n\r\n    var _getCircleSize3 = getCircleSize(_this.circle),\r\n        _cx = _getCircleSize3.cx,\r\n        _cy = _getCircleSize3.cy,\r\n        _r = _getCircleSize3.r;\r\n\r\n    _this.handles = [[_cx, _cy - _r], [_cx + _r, _cy], [_cx, _cy + _r], [_cx - _r, _cy]].map(function (t) {\r\n      var _t = EditableCircle_slicedToArray(t, 2),\r\n          x = _t[0],\r\n          y = _t[1];\r\n\r\n      var handle = _this.drawHandle(x, y);\r\n\r\n      handle.addEventListener('mousedown', _this.onGrab(handle));\r\n\r\n      _this.elementGroup.appendChild(handle);\r\n\r\n      return handle;\r\n    });\r\n\r\n    _this.containerGroup.appendChild(_this.elementGroup);\r\n\r\n    g.appendChild(_this.containerGroup);\r\n    format(_this.circle, _annotation, config.formatter); // The grabbed element (handle or entire group), if any\r\n\r\n    _this.grabbedElem = null; // Mouse xy offset inside the shape, if mouse pressed\r\n\r\n    _this.grabbedAt = null;\r\n    return _this;\r\n  }\r\n\r\n  EditableCircle_createClass(EditableCircle, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.elementGroup;\r\n    }\r\n  }, {\r\n    key: \"destroy\",\r\n    value: function destroy() {\r\n      this.containerGroup.parentNode.removeChild(this.containerGroup);\r\n\r\n      EditableCircle_get(EditableCircle_getPrototypeOf(EditableCircle.prototype), \"destroy\", this).call(this);\r\n    }\r\n  }]);\r\n\r\n  return EditableCircle;\r\n}(EditableShape);\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/circle/RubberbandCircleTool.js\r\nfunction RubberbandCircleTool_typeof(obj) { \"@babel/helpers - typeof\"; return RubberbandCircleTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, RubberbandCircleTool_typeof(obj); }\r\n\r\nfunction RubberbandCircleTool_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandCircleTool_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandCircleTool_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandCircleTool_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandCircleTool_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandCircleTool_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) RubberbandCircleTool_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction RubberbandCircleTool_setPrototypeOf(o, p) { RubberbandCircleTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return RubberbandCircleTool_setPrototypeOf(o, p); }\r\n\r\nfunction RubberbandCircleTool_createSuper(Derived) { var hasNativeReflectConstruct = RubberbandCircleTool_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = RubberbandCircleTool_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = RubberbandCircleTool_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return RubberbandCircleTool_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction RubberbandCircleTool_possibleConstructorReturn(self, call) { if (call && (RubberbandCircleTool_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return RubberbandCircleTool_assertThisInitialized(self); }\r\n\r\nfunction RubberbandCircleTool_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction RubberbandCircleTool_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction RubberbandCircleTool_getPrototypeOf(o) { RubberbandCircleTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return RubberbandCircleTool_getPrototypeOf(o); }\r\n\r\nfunction RubberbandCircleTool_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n/**\r\n * A rubberband selector for circle selections.\r\n */\r\n\r\nvar RubberbandCircleTool = /*#__PURE__*/function (_Tool) {\r\n  RubberbandCircleTool_inherits(RubberbandCircleTool, _Tool);\r\n\r\n  var _super = RubberbandCircleTool_createSuper(RubberbandCircleTool);\r\n\r\n  function RubberbandCircleTool(g, config, env) {\r\n    var _this;\r\n\r\n    RubberbandCircleTool_classCallCheck(this, RubberbandCircleTool);\r\n\r\n    _this = _super.call(this, g, config, env);\r\n\r\n    RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\r\n      _this.attachListeners({\r\n        mouseMove: _this.onMouseMove,\r\n        mouseUp: _this.onMouseUp\r\n      });\r\n\r\n      _this.rubberband = new RubberbandCircle(x, y, _this.g, _this.env);\r\n    });\r\n\r\n    RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"stop\", function () {\r\n      if (_this.rubberband) {\r\n        _this.rubberband.destroy();\r\n\r\n        _this.rubberband = null;\r\n      }\r\n    });\r\n\r\n    RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\r\n      return _this.rubberband.dragTo(x, y);\r\n    });\r\n\r\n    RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"onMouseUp\", function () {\r\n      _this.detachListeners();\r\n\r\n      _this.started = false;\r\n\r\n      var _this$rubberband$getB = _this.rubberband.getBoundingClientRect(),\r\n          width = _this$rubberband$getB.width,\r\n          height = _this$rubberband$getB.height;\r\n\r\n      var minWidth = _this.config.minSelectionWidth || 4;\r\n      var minHeight = _this.config.minSelectionHeight || 4;\r\n\r\n      if (width >= minWidth && height >= minHeight) {\r\n        // Emit the SVG shape with selection attached    \r\n        var element = _this.rubberband.element;\r\n        element.annotation = _this.rubberband.toSelection(); // Emit the completed shape...\r\n\r\n        _this.emit('complete', element);\r\n      } else {\r\n        _this.emit('cancel');\r\n      }\r\n\r\n      _this.stop();\r\n    });\r\n\r\n    RubberbandCircleTool_defineProperty(RubberbandCircleTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\r\n      return new EditableCircle(annotation, _this.g, _this.config, _this.env);\r\n    });\r\n\r\n    _this.rubberband = null;\r\n    return _this;\r\n  }\r\n\r\n  RubberbandCircleTool_createClass(RubberbandCircleTool, [{\r\n    key: \"isDrawing\",\r\n    get: function get() {\r\n      return this.rubberband != null;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandCircleTool;\r\n}(Tool);\r\n\r\n\r\nRubberbandCircleTool.identifier = 'circle';\r\n\r\nRubberbandCircleTool.supports = function (annotation) {\r\n  var _selector$value;\r\n\r\n  var selector = annotation.selector('SvgSelector');\r\n  if (selector) return (_selector$value = selector.value) === null || _selector$value === void 0 ? void 0 : _selector$value.match(/^<svg.*<circle/g);\r\n};\r\n;// CONCATENATED MODULE: ./src/ellipse/Ellipse.js\r\n\r\n/** Shorthand to apply the given (x, y, rx, ry) to the SVG shape **/\r\n\r\nvar Ellipse_setXYR = function setXYR(shape, x, y, rx, ry) {\r\n  shape.setAttribute('cx', x);\r\n  shape.setAttribute('cy', y);\r\n  shape.setAttribute('rx', rx);\r\n  shape.setAttribute('ry', ry);\r\n};\r\n/** \r\n * Draws an SVG ellipse, either from an annotation, or an\r\n * (cx, cy, rx, ry)-tuple.\r\n */\r\n\r\n\r\nvar drawEllipse = function drawEllipse(cx, cy, rx, ry) {\r\n  var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n  var innerEllipse = document.createElementNS(SVG_SVG_NAMESPACE, 'ellipse');\r\n  var outerEllipse = document.createElementNS(SVG_SVG_NAMESPACE, 'ellipse');\r\n  innerEllipse.setAttribute('class', 'a9s-inner');\r\n  Ellipse_setXYR(innerEllipse, cx, cy, rx, ry);\r\n  outerEllipse.setAttribute('class', 'a9s-outer');\r\n  Ellipse_setXYR(outerEllipse, cx, cy, rx, ry);\r\n  g.appendChild(outerEllipse);\r\n  g.appendChild(innerEllipse);\r\n  return g;\r\n};\r\nvar setEllipseSize = function setEllipseSize(g, cx, cy, rx, ry) {\r\n  var innerEllipse = g.querySelector('.a9s-inner');\r\n  var outerEllipse = g.querySelector('.a9s-outer');\r\n  Ellipse_setXYR(innerEllipse, cx, cy, rx, ry);\r\n  Ellipse_setXYR(outerEllipse, cx, cy, rx, ry);\r\n};\r\nvar getEllipseSize = function getEllipseSize(g) {\r\n  var outerEllipse = g.querySelector('.a9s-outer');\r\n  var cx = parseFloat(outerEllipse.getAttribute('cx'));\r\n  var cy = parseFloat(outerEllipse.getAttribute('cy'));\r\n  var rx = parseFloat(outerEllipse.getAttribute('rx'));\r\n  var ry = parseFloat(outerEllipse.getAttribute('ry'));\r\n  return {\r\n    cx: cx,\r\n    cy: cy,\r\n    rx: rx,\r\n    ry: ry\r\n  };\r\n};\r\n;// CONCATENATED MODULE: ./src/ellipse/EllipseMask.js\r\nfunction EllipseMask_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction EllipseMask_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction EllipseMask_createClass(Constructor, protoProps, staticProps) { if (protoProps) EllipseMask_defineProperties(Constructor.prototype, protoProps); if (staticProps) EllipseMask_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction EllipseMask_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\nvar EllipseMask = /*#__PURE__*/function () {\r\n  function EllipseMask(imageDimensions, ellipse) {\r\n    var _this = this;\r\n\r\n    EllipseMask_classCallCheck(this, EllipseMask);\r\n\r\n    EllipseMask_defineProperty(this, \"redraw\", function () {\r\n      var _getEllipseSize = getEllipseSize(_this.ellipse),\r\n          cx = _getEllipseSize.cx,\r\n          cy = _getEllipseSize.cy,\r\n          rx = _getEllipseSize.rx,\r\n          ry = _getEllipseSize.ry;\r\n\r\n      var ty = cy + ry;\r\n\r\n      _this.mask.setAttribute('d', \"M0 0 h\".concat(_this.w, \" v\").concat(_this.h, \" h-\").concat(_this.w, \" z M\").concat(cx, \" \").concat(ty, \" a \").concat(rx, \" \").concat(ry, \" 0 1 1 1 0\"));\r\n    });\r\n\r\n    EllipseMask_defineProperty(this, \"destroy\", function () {\r\n      return _this.mask.parentNode.removeChild(_this.mask);\r\n    });\r\n\r\n    this.w = imageDimensions.naturalWidth;\r\n    this.h = imageDimensions.naturalHeight;\r\n    this.ellipse = ellipse;\r\n\r\n    var _getEllipseSize2 = getEllipseSize(this.ellipse),\r\n        _cx = _getEllipseSize2.cx,\r\n        _cy = _getEllipseSize2.cy,\r\n        _rx = _getEllipseSize2.rx,\r\n        _ry = _getEllipseSize2.ry;\r\n\r\n    var _ty = _cy + _ry;\r\n\r\n    this.mask = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\r\n    this.mask.setAttribute('fill-rule', 'evenodd');\r\n    this.mask.setAttribute('class', 'a9s-selection-mask');\r\n    this.mask.setAttribute('d', \"M0 0 h\".concat(this.w, \" v\").concat(this.h, \" h-\").concat(this.w, \" z M\").concat(_cx, \" \").concat(_ty, \" a \").concat(_rx, \" \").concat(_ry, \" 0 1 1 1 0\"));\r\n  }\r\n\r\n  EllipseMask_createClass(EllipseMask, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.mask;\r\n    }\r\n  }]);\r\n\r\n  return EllipseMask;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/ellipse/RubberbandEllipse.js\r\nfunction RubberbandEllipse_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandEllipse_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandEllipse_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandEllipse_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandEllipse_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandEllipse_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A 'rubberband' selection tool for creating a ellipse by\r\n * clicking and dragging.\r\n */\r\n\r\nvar RubberbandEllipse = /*#__PURE__*/function () {\r\n  function RubberbandEllipse(anchorX, anchorY, g, env) {\r\n    var _this = this;\r\n\r\n    RubberbandEllipse_classCallCheck(this, RubberbandEllipse);\r\n\r\n    RubberbandEllipse_defineProperty(this, \"dragTo\", function (oppositeX, oppositeY) {\r\n      // Make visible\r\n      _this.group.style.display = null;\r\n      var w = oppositeX - _this.anchor[0];\r\n      var h = oppositeY - _this.anchor[1];\r\n      var cx = w > 0 ? _this.anchor[0] + w / 2 : oppositeX + w / 2;\r\n      var cy = h > 0 ? _this.anchor[1] + h / 2 : oppositeY + h / 2;\r\n      var rx = Math.abs(w / 2);\r\n      var ry = Math.abs(h / 2);\r\n      setEllipseSize(_this.ellipse, cx, cy, rx, ry);\r\n\r\n      _this.mask.redraw();\r\n    });\r\n\r\n    RubberbandEllipse_defineProperty(this, \"getBoundingClientRect\", function () {\r\n      return _this.ellipse.getBoundingClientRect();\r\n    });\r\n\r\n    RubberbandEllipse_defineProperty(this, \"toSelection\", function () {\r\n      return new Selection(toSVGTarget(_this.group, _this.env.image));\r\n    });\r\n\r\n    RubberbandEllipse_defineProperty(this, \"destroy\", function () {\r\n      _this.group.parentNode.removeChild(_this.group);\r\n\r\n      _this.mask = null;\r\n      _this.ellipse = null;\r\n      _this.group = null;\r\n    });\r\n\r\n    this.anchor = [anchorX, anchorY];\r\n    this.env = env;\r\n    this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    this.ellipse = drawEllipse(anchorX, anchorY, 2);\r\n    this.ellipse.setAttribute('class', 'a9s-selection');\r\n    this.mask = new EllipseMask(env.image, this.ellipse); // We make the selection transparent to \r\n    // pointer events because it would interfere with the \r\n    // rendered annotations' mouseleave/enter events\r\n\r\n    this.group.style.pointerEvents = 'none'; // Additionally, selection remains hidden until \r\n    // the user actually moves the mouse\r\n\r\n    this.group.style.display = 'none';\r\n    this.group.appendChild(this.mask.element);\r\n    this.group.appendChild(this.ellipse);\r\n    g.appendChild(this.group);\r\n  }\r\n\r\n  RubberbandEllipse_createClass(RubberbandEllipse, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.ellipse;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandEllipse;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/ellipse/EditableEllipse.js\r\nfunction EditableEllipse_typeof(obj) { \"@babel/helpers - typeof\"; return EditableEllipse_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, EditableEllipse_typeof(obj); }\r\n\r\nfunction EditableEllipse_slicedToArray(arr, i) { return EditableEllipse_arrayWithHoles(arr) || EditableEllipse_iterableToArrayLimit(arr, i) || EditableEllipse_unsupportedIterableToArray(arr, i) || EditableEllipse_nonIterableRest(); }\r\n\r\nfunction EditableEllipse_nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction EditableEllipse_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return EditableEllipse_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EditableEllipse_arrayLikeToArray(o, minLen); }\r\n\r\nfunction EditableEllipse_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction EditableEllipse_iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\r\n\r\nfunction EditableEllipse_arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\r\n\r\nfunction EditableEllipse_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction EditableEllipse_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction EditableEllipse_createClass(Constructor, protoProps, staticProps) { if (protoProps) EditableEllipse_defineProperties(Constructor.prototype, protoProps); if (staticProps) EditableEllipse_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction EditableEllipse_get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { EditableEllipse_get = Reflect.get.bind(); } else { EditableEllipse_get = function _get(target, property, receiver) { var base = EditableEllipse_superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return EditableEllipse_get.apply(this, arguments); }\r\n\r\nfunction EditableEllipse_superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = EditableEllipse_getPrototypeOf(object); if (object === null) break; } return object; }\r\n\r\nfunction EditableEllipse_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) EditableEllipse_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction EditableEllipse_setPrototypeOf(o, p) { EditableEllipse_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return EditableEllipse_setPrototypeOf(o, p); }\r\n\r\nfunction EditableEllipse_createSuper(Derived) { var hasNativeReflectConstruct = EditableEllipse_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = EditableEllipse_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = EditableEllipse_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return EditableEllipse_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction EditableEllipse_possibleConstructorReturn(self, call) { if (call && (EditableEllipse_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return EditableEllipse_assertThisInitialized(self); }\r\n\r\nfunction EditableEllipse_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction EditableEllipse_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction EditableEllipse_getPrototypeOf(o) { EditableEllipse_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return EditableEllipse_getPrototypeOf(o); }\r\n\r\nfunction EditableEllipse_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * An editable ellipse shape.\r\n */\r\n\r\nvar EditableEllipse = /*#__PURE__*/function (_EditableShape) {\r\n  EditableEllipse_inherits(EditableEllipse, _EditableShape);\r\n\r\n  var _super = EditableEllipse_createSuper(EditableEllipse);\r\n\r\n  function EditableEllipse(_annotation, g, config, env) {\r\n    var _this;\r\n\r\n    EditableEllipse_classCallCheck(this, EditableEllipse);\r\n\r\n    _this = _super.call(this, _annotation, g, config, env);\r\n\r\n    EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"setSize\", function (cx, cy, rx, ry) {\r\n      setEllipseSize(_this.ellipse, cx, cy, rx, ry);\r\n\r\n      _this.mask.redraw();\r\n\r\n      setFormatterElSize(_this.elementGroup, cx, cy, rx, ry);\r\n\r\n      var _this$handles = EditableEllipse_slicedToArray(_this.handles, 4),\r\n          topleft = _this$handles[0],\r\n          topright = _this$handles[1],\r\n          bottomright = _this$handles[2],\r\n          bottomleft = _this$handles[3];\r\n\r\n      _this.setHandleXY(topleft, cx, cy - ry);\r\n\r\n      _this.setHandleXY(topright, cx + rx, cy);\r\n\r\n      _this.setHandleXY(bottomright, cx, cy + ry);\r\n\r\n      _this.setHandleXY(bottomleft, cx - rx, cy);\r\n    });\r\n\r\n    EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"stretchCorners\", function (draggedHandleIdx, anchorHandle, leftHandle, mousePos) {\r\n      var anchor = _this.getHandleXY(anchorHandle);\r\n\r\n      var anchorLeft = _this.getHandleXY(leftHandle);\r\n\r\n      var mouseX = mousePos.x;\r\n      var mouseY = mousePos.y;\r\n      var rx = 0;\r\n      var ry = 0;\r\n\r\n      if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\r\n        mouseX = anchor.x;\r\n      } else {\r\n        mouseY = anchor.y;\r\n      }\r\n\r\n      var width = mouseX - anchor.x;\r\n      var height = mouseY - anchor.y;\r\n      var x = width > 0 ? anchor.x : mouseX;\r\n      var y = height > 0 ? anchor.y : mouseY;\r\n      var w = Math.abs(width);\r\n      var h = Math.abs(height);\r\n      var cx = x + w / 2;\r\n      var cy = y + h / 2;\r\n      var rx = w / 2;\r\n      var ry = h / 2;\r\n\r\n      if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\r\n        rx = Math.abs(anchor.x - anchorLeft.x);\r\n      } else {\r\n        ry = Math.abs(anchor.y - anchorLeft.y);\r\n      }\r\n\r\n      setEllipseSize(_this.ellipse, cx, cy, rx, ry);\r\n\r\n      _this.mask.redraw();\r\n\r\n      setFormatterElSize(_this.elementGroup, cx, cy, rx, ry);\r\n\r\n      if (draggedHandleIdx == 0 || draggedHandleIdx == 2) {\r\n        var idx0 = 0;\r\n        var idx2 = 2;\r\n\r\n        if (draggedHandleIdx == 0 && height > 0 || draggedHandleIdx == 2 && height < 0) {\r\n          idx0 = 2;\r\n          idx2 = 0;\r\n        }\r\n\r\n        _this.setHandleXY(_this.handles[idx0], cx, cy - ry);\r\n\r\n        _this.setHandleXY(_this.handles[idx2], cx, cy + ry);\r\n\r\n        _this.setHandleXY(_this.handles[1], cx + rx, cy);\r\n\r\n        _this.setHandleXY(_this.handles[3], cx - rx, cy);\r\n      } else {\r\n        var idx3 = 3;\r\n        var idx1 = 1;\r\n\r\n        if (draggedHandleIdx == 1 && width > 0 || draggedHandleIdx == 3 && width < 0) {\r\n          idx3 = 1;\r\n          idx1 = 3;\r\n        }\r\n\r\n        _this.setHandleXY(_this.handles[idx3], cx + rx, cy);\r\n\r\n        _this.setHandleXY(_this.handles[idx1], cx - rx, cy);\r\n\r\n        _this.setHandleXY(_this.handles[0], cx, cy - ry);\r\n\r\n        _this.setHandleXY(_this.handles[2], cx, cy + ry);\r\n      }\r\n    });\r\n\r\n    EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\r\n      return function (evt) {\r\n        _this.grabbedElem = grabbedElem;\r\n\r\n        var pos = _this.getSVGPoint(evt);\r\n\r\n        var _getEllipseSize = getEllipseSize(_this.ellipse),\r\n            cx = _getEllipseSize.cx,\r\n            cy = _getEllipseSize.cy;\r\n\r\n        _this.grabbedAt = {\r\n          x: pos.x - cx,\r\n          y: pos.y - cy\r\n        };\r\n      };\r\n    });\r\n\r\n    EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\r\n      var constrain = function constrain(coord, max) {\r\n        return coord < 0 ? 0 : coord > max ? max : coord;\r\n      };\r\n\r\n      if (_this.grabbedElem) {\r\n        var pos = _this.getSVGPoint(evt);\r\n\r\n        if (_this.grabbedElem === _this.ellipse) {\r\n          var _getEllipseSize2 = getEllipseSize(_this.ellipse),\r\n              rx = _getEllipseSize2.rx,\r\n              ry = _getEllipseSize2.ry;\r\n\r\n          var _this$env$image = _this.env.image,\r\n              naturalWidth = _this$env$image.naturalWidth,\r\n              naturalHeight = _this$env$image.naturalHeight;\r\n          var cx = constrain(pos.x - _this.grabbedAt.x, naturalWidth - rx);\r\n          var cy = constrain(pos.y - _this.grabbedAt.y, naturalHeight - ry);\r\n\r\n          _this.setSize(cx, cy, rx, ry);\r\n\r\n          _this.emit('update', toSVGTarget(_this.ellipse, _this.env.image));\r\n        } else {\r\n          // Mouse position replaces one of the corner coords, depending\r\n          // on which handle is the grabbed element\r\n          var handleIdx = _this.handles.indexOf(_this.grabbedElem);\r\n\r\n          var oppositeHandle = handleIdx < 2 ? _this.handles[handleIdx + 2] : _this.handles[handleIdx - 2];\r\n          var leftHandle = _this.handles[(handleIdx + 3) % 4];\r\n\r\n          _this.stretchCorners(handleIdx, oppositeHandle, leftHandle, pos);\r\n\r\n          _this.emit('update', toSVGTarget(_this.ellipse, _this.env.image));\r\n        }\r\n      }\r\n    });\r\n\r\n    EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"onMouseUp\", function () {\r\n      _this.grabbedElem = null;\r\n      _this.grabbedAt = null;\r\n    });\r\n\r\n    EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"onScaleChanged\", function (scale) {\r\n      return _this.handles.map(_this.scaleHandle);\r\n    });\r\n\r\n    EditableEllipse_defineProperty(EditableEllipse_assertThisInitialized(_this), \"updateState\", function (annotation) {\r\n      var shape = svgFragmentToShape(annotation);\r\n      var cx = parseFloat(shape.getAttribute('cx'));\r\n      var cy = parseFloat(shape.getAttribute('cy'));\r\n      var rx = parseFloat(shape.getAttribute('rx'));\r\n      var ry = parseFloat(shape.getAttribute('ry'));\r\n\r\n      _this.setSize(cx, cy, rx, ry);\r\n    });\r\n\r\n    _this.svg.addEventListener('mousemove', _this.onMouseMove);\r\n\r\n    _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\r\n    // \r\n    // <g>\r\n    //   <path class=\"a9s-selection mask\"... />\r\n    //   <g> <-- return this node as .element\r\n    //     <ellipse class=\"a9s-outer\" ... />\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //   </g> \r\n    // </g>\r\n    // 'g' for the editable ellipse compound shape\r\n\r\n\r\n    _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    _this.ellipse = drawEmbeddedSVG(_annotation);\r\n\r\n    _this.ellipse.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.ellipse));\r\n\r\n    _this.mask = new EllipseMask(env.image, _this.ellipse);\r\n\r\n    _this.containerGroup.appendChild(_this.mask.element); // The 'element' = ellipse + handles\r\n\r\n\r\n    _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n\r\n    _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\r\n\r\n    _this.elementGroup.appendChild(_this.ellipse);\r\n\r\n    var _getEllipseSize3 = getEllipseSize(_this.ellipse),\r\n        _cx = _getEllipseSize3.cx,\r\n        _cy = _getEllipseSize3.cy,\r\n        _rx = _getEllipseSize3.rx,\r\n        _ry = _getEllipseSize3.ry;\r\n\r\n    _this.handles = [[_cx, _cy - _ry], [_cx + _rx, _cy], [_cx, _cy + _ry], [_cx - _rx, _cy]].map(function (t) {\r\n      var _t = EditableEllipse_slicedToArray(t, 2),\r\n          x = _t[0],\r\n          y = _t[1];\r\n\r\n      var handle = _this.drawHandle(x, y);\r\n\r\n      handle.addEventListener('mousedown', _this.onGrab(handle));\r\n\r\n      _this.elementGroup.appendChild(handle);\r\n\r\n      return handle;\r\n    });\r\n\r\n    _this.containerGroup.appendChild(_this.elementGroup);\r\n\r\n    g.appendChild(_this.containerGroup);\r\n    format(_this.ellipse, _annotation, config.formatter); // The grabbed element (handle or entire group), if any\r\n\r\n    _this.grabbedElem = null; // Mouse xy offset inside the shape, if mouse pressed\r\n\r\n    _this.grabbedAt = null;\r\n    return _this;\r\n  }\r\n\r\n  EditableEllipse_createClass(EditableEllipse, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.elementGroup;\r\n    }\r\n  }, {\r\n    key: \"destroy\",\r\n    value: function destroy() {\r\n      this.containerGroup.parentNode.removeChild(this.containerGroup);\r\n\r\n      EditableEllipse_get(EditableEllipse_getPrototypeOf(EditableEllipse.prototype), \"destroy\", this).call(this);\r\n    }\r\n  }]);\r\n\r\n  return EditableEllipse;\r\n}(EditableShape);\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/ellipse/RubberbandEllipseTool.js\r\nfunction RubberbandEllipseTool_typeof(obj) { \"@babel/helpers - typeof\"; return RubberbandEllipseTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, RubberbandEllipseTool_typeof(obj); }\r\n\r\nfunction RubberbandEllipseTool_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandEllipseTool_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandEllipseTool_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandEllipseTool_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandEllipseTool_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandEllipseTool_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) RubberbandEllipseTool_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction RubberbandEllipseTool_setPrototypeOf(o, p) { RubberbandEllipseTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return RubberbandEllipseTool_setPrototypeOf(o, p); }\r\n\r\nfunction RubberbandEllipseTool_createSuper(Derived) { var hasNativeReflectConstruct = RubberbandEllipseTool_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = RubberbandEllipseTool_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = RubberbandEllipseTool_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return RubberbandEllipseTool_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction RubberbandEllipseTool_possibleConstructorReturn(self, call) { if (call && (RubberbandEllipseTool_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return RubberbandEllipseTool_assertThisInitialized(self); }\r\n\r\nfunction RubberbandEllipseTool_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction RubberbandEllipseTool_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction RubberbandEllipseTool_getPrototypeOf(o) { RubberbandEllipseTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return RubberbandEllipseTool_getPrototypeOf(o); }\r\n\r\nfunction RubberbandEllipseTool_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n/**\r\n * A rubberband selector for ellipse selections.\r\n */\r\n\r\nvar RubberbandEllipseTool = /*#__PURE__*/function (_Tool) {\r\n  RubberbandEllipseTool_inherits(RubberbandEllipseTool, _Tool);\r\n\r\n  var _super = RubberbandEllipseTool_createSuper(RubberbandEllipseTool);\r\n\r\n  function RubberbandEllipseTool(g, config, env) {\r\n    var _this;\r\n\r\n    RubberbandEllipseTool_classCallCheck(this, RubberbandEllipseTool);\r\n\r\n    _this = _super.call(this, g, config, env);\r\n\r\n    RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\r\n      _this.attachListeners({\r\n        mouseMove: _this.onMouseMove,\r\n        mouseUp: _this.onMouseUp\r\n      });\r\n\r\n      _this.rubberband = new RubberbandEllipse(x, y, _this.g, _this.env);\r\n    });\r\n\r\n    RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"stop\", function () {\r\n      if (_this.rubberband) {\r\n        _this.rubberband.destroy();\r\n\r\n        _this.rubberband = null;\r\n      }\r\n    });\r\n\r\n    RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\r\n      return _this.rubberband.dragTo(x, y);\r\n    });\r\n\r\n    RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"onMouseUp\", function () {\r\n      _this.detachListeners();\r\n\r\n      _this.started = false;\r\n\r\n      var _this$rubberband$getB = _this.rubberband.getBoundingClientRect(),\r\n          width = _this$rubberband$getB.width,\r\n          height = _this$rubberband$getB.height;\r\n\r\n      var minWidth = _this.config.minSelectionWidth || 4;\r\n      var minHeight = _this.config.minSelectionHeight || 4;\r\n\r\n      if (width >= minWidth && height >= minHeight) {\r\n        // Emit the SVG shape with selection attached    \r\n        var element = _this.rubberband.element;\r\n        element.annotation = _this.rubberband.toSelection(); // Emit the completed shape...\r\n\r\n        _this.emit('complete', element);\r\n      } else {\r\n        _this.emit('cancel');\r\n      }\r\n\r\n      _this.stop();\r\n    });\r\n\r\n    RubberbandEllipseTool_defineProperty(RubberbandEllipseTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\r\n      return new EditableEllipse(annotation, _this.g, _this.config, _this.env);\r\n    });\r\n\r\n    _this.rubberband = null;\r\n    return _this;\r\n  }\r\n\r\n  RubberbandEllipseTool_createClass(RubberbandEllipseTool, [{\r\n    key: \"isDrawing\",\r\n    get: function get() {\r\n      return this.rubberband != null;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandEllipseTool;\r\n}(Tool);\r\n\r\n\r\nRubberbandEllipseTool.identifier = 'ellipse';\r\n\r\nRubberbandEllipseTool.supports = function (annotation) {\r\n  var _selector$value;\r\n\r\n  var selector = annotation.selector('SvgSelector');\r\n  if (selector) return (_selector$value = selector.value) === null || _selector$value === void 0 ? void 0 : _selector$value.match(/^<svg.*<ellipse/g);\r\n};\r\n;// CONCATENATED MODULE: ./src/freehand/RubberbandFreehand.js\r\nfunction RubberbandFreehand_toConsumableArray(arr) { return RubberbandFreehand_arrayWithoutHoles(arr) || RubberbandFreehand_iterableToArray(arr) || RubberbandFreehand_unsupportedIterableToArray(arr) || RubberbandFreehand_nonIterableSpread(); }\r\n\r\nfunction RubberbandFreehand_nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction RubberbandFreehand_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return RubberbandFreehand_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return RubberbandFreehand_arrayLikeToArray(o, minLen); }\r\n\r\nfunction RubberbandFreehand_iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\r\n\r\nfunction RubberbandFreehand_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return RubberbandFreehand_arrayLikeToArray(arr); }\r\n\r\nfunction RubberbandFreehand_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction RubberbandFreehand_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandFreehand_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandFreehand_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandFreehand_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandFreehand_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandFreehand_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n // TODO optional: mask to dim the outside area\r\n//import Mask from './FreehandMask';\r\n\r\n/**\r\n * A 'rubberband' selection tool for creating freehand drawing by\r\n * clicking and dragging.\r\n */\r\n\r\nvar RubberbandFreehand = /*#__PURE__*/function () {\r\n  function RubberbandFreehand(anchor, g, env) {\r\n    var _this = this;\r\n\r\n    RubberbandFreehand_classCallCheck(this, RubberbandFreehand);\r\n\r\n    RubberbandFreehand_defineProperty(this, \"setPoints\", function (points) {\r\n      var str = points.map(function (pt) {\r\n        return \"L\".concat(pt[0], \" \").concat(pt[1]);\r\n      }).join(' ');\r\n      str = 'M' + str.substring(1);\r\n\r\n      _this.outer.setAttribute('d', str);\r\n\r\n      _this.inner.setAttribute('d', str);\r\n    });\r\n\r\n    RubberbandFreehand_defineProperty(this, \"getBoundingClientRect\", function () {\r\n      return _this.outer.getBoundingClientRect();\r\n    });\r\n\r\n    RubberbandFreehand_defineProperty(this, \"dragTo\", function (xy) {\r\n      // Make visible\r\n      _this.group.style.display = null; //TODO optional: edge smoothing\r\n\r\n      _this.addPoint(xy); // TODO optional: mask to dim the outside area\r\n      // this.mask.redraw();\r\n\r\n    });\r\n\r\n    RubberbandFreehand_defineProperty(this, \"addPoint\", function (xy) {\r\n      _this.points = [].concat(RubberbandFreehand_toConsumableArray(_this.points), [xy]);\r\n\r\n      _this.setPoints(_this.points); // TODO optional: mask to dim the outside area\r\n      // this.mask.redraw();\r\n\r\n    });\r\n\r\n    RubberbandFreehand_defineProperty(this, \"destroy\", function () {\r\n      _this.group.parentNode.removeChild(_this.group);\r\n\r\n      _this.freehand = null;\r\n      _this.group = null;\r\n    });\r\n\r\n    RubberbandFreehand_defineProperty(this, \"toSelection\", function () {\r\n      return new Selection(toSVGTarget(_this.group, _this.env.image));\r\n    });\r\n\r\n    this.points = [anchor];\r\n    this.env = env;\r\n    this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    this.freehand = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    this.freehand.setAttribute('class', 'a9s-selection');\r\n    this.outer = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\r\n    this.outer.setAttribute('class', 'a9s-outer');\r\n    this.inner = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\r\n    this.inner.setAttribute('class', 'a9s-inner');\r\n    this.setPoints(this.points); // TODO optional: mask to dim the outside area\r\n    // this.mask = new Mask(env.image, this.inner);\r\n\r\n    this.freehand.appendChild(this.outer);\r\n    this.freehand.appendChild(this.inner); // Additionally, selection remains hidden until \r\n    // the user actually moves the mouse\r\n\r\n    this.group.style.display = 'none'; // TODO optional: mask to dim the outside area\r\n    // this.group.appendChild(this.mask.element);\r\n\r\n    this.group.appendChild(this.freehand);\r\n    g.appendChild(this.group);\r\n  }\r\n\r\n  RubberbandFreehand_createClass(RubberbandFreehand, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.freehand;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandFreehand;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/freehand/EditableFreehand.js\r\nfunction EditableFreehand_typeof(obj) { \"@babel/helpers - typeof\"; return EditableFreehand_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, EditableFreehand_typeof(obj); }\r\n\r\nfunction EditableFreehand_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction EditableFreehand_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction EditableFreehand_createClass(Constructor, protoProps, staticProps) { if (protoProps) EditableFreehand_defineProperties(Constructor.prototype, protoProps); if (staticProps) EditableFreehand_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction EditableFreehand_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) EditableFreehand_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction EditableFreehand_setPrototypeOf(o, p) { EditableFreehand_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return EditableFreehand_setPrototypeOf(o, p); }\r\n\r\nfunction EditableFreehand_createSuper(Derived) { var hasNativeReflectConstruct = EditableFreehand_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = EditableFreehand_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = EditableFreehand_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return EditableFreehand_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction EditableFreehand_possibleConstructorReturn(self, call) { if (call && (EditableFreehand_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return EditableFreehand_assertThisInitialized(self); }\r\n\r\nfunction EditableFreehand_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction EditableFreehand_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction EditableFreehand_get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { EditableFreehand_get = Reflect.get.bind(); } else { EditableFreehand_get = function _get(target, property, receiver) { var base = EditableFreehand_superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return EditableFreehand_get.apply(this, arguments); }\r\n\r\nfunction EditableFreehand_superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = EditableFreehand_getPrototypeOf(object); if (object === null) break; } return object; }\r\n\r\nfunction EditableFreehand_getPrototypeOf(o) { EditableFreehand_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return EditableFreehand_getPrototypeOf(o); }\r\n\r\nfunction EditableFreehand_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n // TODO optional: mask to dim the outside area\r\n//import Mask from './FreehandMask';\r\n\r\nvar getPoints = function getPoints(shape) {\r\n  var pointList = shape.getAttribute('d').split('L');\r\n  var points = [];\r\n\r\n  if (pointList.length > 0) {\r\n    var point = pointList[0].substring(1).trim().split(' ');\r\n    points.push({\r\n      x: parseFloat(point[0]),\r\n      y: parseFloat(point[1])\r\n    });\r\n\r\n    for (var i = 1; i < pointList.length; i++) {\r\n      var point = pointList[i].trim().split(' ');\r\n      points.push({\r\n        x: parseFloat(point[0]),\r\n        y: parseFloat(point[1])\r\n      });\r\n    }\r\n  }\r\n\r\n  return points;\r\n};\r\n\r\nvar getBBox = function getBBox(shape) {\r\n  return shape.querySelector('.a9s-inner').getBBox();\r\n};\r\n/**\r\n * An editable freehand drawing.\r\n */\r\n\r\n\r\nvar EditableFreehand = /*#__PURE__*/function (_EditableShape) {\r\n  EditableFreehand_inherits(EditableFreehand, _EditableShape);\r\n\r\n  var _super = EditableFreehand_createSuper(EditableFreehand);\r\n\r\n  function EditableFreehand(_annotation, g, config, env) {\r\n    var _thisSuper, _this;\r\n\r\n    EditableFreehand_classCallCheck(this, EditableFreehand);\r\n\r\n    _this = _super.call(this, _annotation, g, config, env);\r\n\r\n    EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"setPoints\", function (points) {\r\n      // Not using .toFixed(1) because that will ALWAYS\r\n      // return one decimal, e.g. \"15.0\" (when we want \"15\")\r\n      var round = function round(num) {\r\n        return Math.round(10 * num) / 10;\r\n      };\r\n\r\n      var str = points.map(function (pt) {\r\n        return \"L\".concat(round(pt.x), \" \").concat(round(pt.y));\r\n      }).join(' ');\r\n      str = 'M' + str.substring(1);\r\n\r\n      var inner = _this.shape.querySelector('.a9s-inner');\r\n\r\n      inner.setAttribute('d', str);\r\n\r\n      var outer = _this.shape.querySelector('.a9s-outer');\r\n\r\n      outer.setAttribute('d', str);\r\n\r\n      var _outer$getBBox = outer.getBBox(),\r\n          x = _outer$getBBox.x,\r\n          y = _outer$getBBox.y,\r\n          width = _outer$getBBox.width,\r\n          height = _outer$getBBox.height; // TODO optional: mask to dim the outside area\r\n      // this.mask.redraw();\r\n      // TODO optional: handles to stretch the shape\r\n\r\n      /*    const [ topleft, topright, bottomright, bottomleft] = this.handles;\r\n      \r\n          this.setHandleXY(topleft, x, y);\r\n          this.setHandleXY(topright, x + width, y);\r\n          this.setHandleXY(bottomright, x + width, y + height);\r\n          this.setHandleXY(bottomleft, x, y + height);*/\r\n\r\n\r\n      setFormatterElSize(_this.elementGroup, x, y, width, height);\r\n    });\r\n\r\n    EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\r\n      return function (evt) {\r\n        _this.grabbedElem = grabbedElem;\r\n\r\n        var pos = _this.getSVGPoint(evt);\r\n\r\n        _this.grabbedAt = {\r\n          x: pos.x,\r\n          y: pos.y\r\n        };\r\n      };\r\n    });\r\n\r\n    EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\r\n      var constrain = function constrain(coord, delta, max) {\r\n        return coord + delta < 0 ? -coord : coord + delta > max ? max - coord : delta;\r\n      };\r\n\r\n      if (_this.grabbedElem) {\r\n        var pos = _this.getSVGPoint(evt);\r\n\r\n        var _getBBox = getBBox(_this.shape),\r\n            x = _getBBox.x,\r\n            y = _getBBox.y,\r\n            width = _getBBox.width,\r\n            height = _getBBox.height;\r\n\r\n        if (_this.grabbedElem === _this.shape) {\r\n          var _this$env$image = _this.env.image,\r\n              naturalWidth = _this$env$image.naturalWidth,\r\n              naturalHeight = _this$env$image.naturalHeight;\r\n          var dx = constrain(x, pos.x - _this.grabbedAt.x, naturalWidth - width);\r\n          var dy = constrain(y, pos.y - _this.grabbedAt.y, naturalHeight - height);\r\n\r\n          var inner = _this.shape.querySelector('.a9s-inner');\r\n\r\n          var updatedPoints = getPoints(inner).map(function (pt) {\r\n            return {\r\n              x: pt.x + dx,\r\n              y: pt.y + dy\r\n            };\r\n          });\r\n          _this.grabbedAt = pos;\r\n\r\n          _this.setPoints(updatedPoints);\r\n\r\n          _this.emit('update', toSVGTarget(_this.shape, _this.env.image));\r\n        } // TODO optional: handles to stretch the shape\r\n\r\n        /* else {\r\n          const handleIdx = this.handles.indexOf(this.grabbedElem);\r\n          const oppositeHandle = handleIdx < 2 ? \r\n            this.handles[handleIdx + 2] : this.handles[handleIdx - 2];\r\n           this.stretchCorners(handleIdx, oppositeHandle, pos);\r\n           this.emit('update', toSVGTarget(this.shape, this.env.image));\r\n        }*/\r\n\r\n      }\r\n    });\r\n\r\n    EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"onMouseUp\", function (evt) {\r\n      _this.grabbedElem = null;\r\n      _this.grabbedAt = null;\r\n    });\r\n\r\n    EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"updateState\", function (annotation) {\r\n      var points = getPoints(svgFragmentToShape(annotation));\r\n\r\n      _this.setPoints(points);\r\n    });\r\n\r\n    EditableFreehand_defineProperty(EditableFreehand_assertThisInitialized(_this), \"destroy\", function () {\r\n      _this.containerGroup.parentNode.removeChild(_this.containerGroup);\r\n\r\n      EditableFreehand_get((_thisSuper = EditableFreehand_assertThisInitialized(_this), EditableFreehand_getPrototypeOf(EditableFreehand.prototype)), \"destroy\", _thisSuper).call(_thisSuper);\r\n    });\r\n\r\n    _this.svg.addEventListener('mousemove', _this.onMouseMove);\r\n\r\n    _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\r\n    // \r\n    // <g>\r\n    //   <path class=\"a9s-selection mask\"... />\r\n    //   <g> <-- return this node as .element\r\n    //     <polygon class=\"a9s-outer\" ... />\r\n    //     <polygon class=\"a9s-inner\" ... />\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     ...\r\n    //   </g> \r\n    // </g>\r\n    // 'g' for the editable free drawing compound shape\r\n\r\n\r\n    _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    _this.shape = drawEmbeddedSVG(_annotation); // TODO optional: mask to dim the outside area\r\n    // this.mask = new Mask(env.image, this.shape.querySelector('.a9s-inner'));\r\n    // this.containerGroup.appendChild(this.mask.element);\r\n\r\n    _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n\r\n    _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\r\n\r\n    _this.elementGroup.appendChild(_this.shape);\r\n\r\n    _this.containerGroup.appendChild(_this.elementGroup);\r\n\r\n    g.appendChild(_this.containerGroup);\r\n    format(_this.shape, _annotation, config.formatter);\r\n\r\n    _this.shape.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.shape));\r\n\r\n    var _getBBox2 = getBBox(_this.shape),\r\n        _x = _getBBox2.x,\r\n        _y = _getBBox2.y,\r\n        _width = _getBBox2.width,\r\n        _height = _getBBox2.height; // TODO optional: handles to stretch the shape\r\n\r\n    /*    this.handles = [\r\n          [ x, y ], \r\n          [ x + width, y ], \r\n          [ x + width, y + height ], \r\n          [ x, y + height ]\r\n        ].map(t => { \r\n          const [ x, y ] = t;\r\n          const handle = this.drawHandle(x, y);\r\n    \r\n          handle.addEventListener('mousedown', this.onGrab(handle));\r\n          this.elementGroup.appendChild(handle);\r\n    \r\n          return handle;\r\n        });*/\r\n    // The grabbed element (handle or entire shape), if any\r\n\r\n\r\n    _this.grabbedElem = null; // Mouse grab point\r\n\r\n    _this.grabbedAt = null;\r\n    return _this;\r\n  }\r\n\r\n  EditableFreehand_createClass(EditableFreehand, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.elementGroup;\r\n    }\r\n  }]);\r\n\r\n  return EditableFreehand;\r\n}(EditableShape);\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/freehand/RubberbandFreehandTool.js\r\nfunction RubberbandFreehandTool_typeof(obj) { \"@babel/helpers - typeof\"; return RubberbandFreehandTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, RubberbandFreehandTool_typeof(obj); }\r\n\r\nfunction RubberbandFreehandTool_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandFreehandTool_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandFreehandTool_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandFreehandTool_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandFreehandTool_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandFreehandTool_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) RubberbandFreehandTool_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction RubberbandFreehandTool_setPrototypeOf(o, p) { RubberbandFreehandTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return RubberbandFreehandTool_setPrototypeOf(o, p); }\r\n\r\nfunction RubberbandFreehandTool_createSuper(Derived) { var hasNativeReflectConstruct = RubberbandFreehandTool_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = RubberbandFreehandTool_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = RubberbandFreehandTool_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return RubberbandFreehandTool_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction RubberbandFreehandTool_possibleConstructorReturn(self, call) { if (call && (RubberbandFreehandTool_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return RubberbandFreehandTool_assertThisInitialized(self); }\r\n\r\nfunction RubberbandFreehandTool_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction RubberbandFreehandTool_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction RubberbandFreehandTool_getPrototypeOf(o) { RubberbandFreehandTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return RubberbandFreehandTool_getPrototypeOf(o); }\r\n\r\nfunction RubberbandFreehandTool_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n/**\r\n * A rubberband selector for freehand fragments.\r\n */\r\n\r\nvar RubberbandFreehandTool = /*#__PURE__*/function (_Tool) {\r\n  RubberbandFreehandTool_inherits(RubberbandFreehandTool, _Tool);\r\n\r\n  var _super = RubberbandFreehandTool_createSuper(RubberbandFreehandTool);\r\n\r\n  function RubberbandFreehandTool(g, config, env) {\r\n    var _this;\r\n\r\n    RubberbandFreehandTool_classCallCheck(this, RubberbandFreehandTool);\r\n\r\n    _this = _super.call(this, g, config, env);\r\n\r\n    RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\r\n      _this._isDrawing = true;\r\n\r\n      _this.attachListeners({\r\n        mouseMove: _this.onMouseMove,\r\n        mouseUp: _this.onMouseUp,\r\n        dblClick: _this.onDblClick\r\n      });\r\n\r\n      _this.rubberband = new RubberbandFreehand([x, y], _this.g, _this.env);\r\n    });\r\n\r\n    RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"stop\", function () {\r\n      _this.detachListeners();\r\n\r\n      _this._isDrawing = false;\r\n\r\n      if (_this.rubberband) {\r\n        _this.rubberband.destroy();\r\n\r\n        _this.rubberband = null;\r\n      }\r\n    });\r\n\r\n    RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\r\n      return _this.rubberband.dragTo([x, y]);\r\n    });\r\n\r\n    RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"onMouseUp\", function (x, y) {\r\n      _this.onDblClick(x, y);\r\n    });\r\n\r\n    RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"onDblClick\", function (x, y) {\r\n      _this._isDrawing = false;\r\n\r\n      _this.rubberband.addPoint([x, y]);\r\n\r\n      _this.detachListeners();\r\n\r\n      var _this$rubberband$getB = _this.rubberband.getBoundingClientRect(),\r\n          width = _this$rubberband$getB.width,\r\n          height = _this$rubberband$getB.height;\r\n\r\n      var minWidth = _this.config.minSelectionWidth || 4;\r\n      var minHeight = _this.config.minSelectionHeight || 4;\r\n\r\n      if (width >= minWidth || height >= minHeight) {\r\n        var shape = _this.rubberband.element;\r\n        shape.annotation = _this.rubberband.toSelection();\r\n\r\n        _this.emit('complete', shape);\r\n      } else {\r\n        _this.emit('cancel');\r\n      }\r\n\r\n      _this.stop();\r\n    });\r\n\r\n    RubberbandFreehandTool_defineProperty(RubberbandFreehandTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\r\n      return new EditableFreehand(annotation, _this.g, _this.config, _this.env);\r\n    });\r\n\r\n    _this._isDrawing = false;\r\n    return _this;\r\n  }\r\n\r\n  RubberbandFreehandTool_createClass(RubberbandFreehandTool, [{\r\n    key: \"isDrawing\",\r\n    get: function get() {\r\n      return this._isDrawing;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandFreehandTool;\r\n}(Tool);\r\n\r\n\r\nRubberbandFreehandTool.identifier = 'freehand';\r\n\r\nRubberbandFreehandTool.supports = function (annotation) {\r\n  var selector = annotation.selector('SvgSelector');\r\n  if (selector) return selector.value.match(/^<svg.*<path*/g) && !selector.value.toUpperCase().includes('Z');\r\n};\r\n;// CONCATENATED MODULE: ./node_modules/@recogito/annotorious/src/tools/polygon/PolygonMask.js\r\nfunction PolygonMask_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction PolygonMask_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction PolygonMask_createClass(Constructor, protoProps, staticProps) { if (protoProps) PolygonMask_defineProperties(Constructor.prototype, protoProps); if (staticProps) PolygonMask_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction PolygonMask_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\nvar PolygonMask = /*#__PURE__*/function () {\r\n  function PolygonMask(imageDimensions, polygon) {\r\n    var _this = this;\r\n\r\n    PolygonMask_classCallCheck(this, PolygonMask);\r\n\r\n    PolygonMask_defineProperty(this, \"redraw\", function () {\r\n      _this.mask.setAttribute('d', \"M0 0 h\".concat(_this.w, \" v\").concat(_this.h, \" h-\").concat(_this.w, \" z M\").concat(_this.polygon.getAttribute('points'), \" z\"));\r\n    });\r\n\r\n    PolygonMask_defineProperty(this, \"destroy\", function () {\r\n      return _this.mask.parentNode.removeChild(_this.mask);\r\n    });\r\n\r\n    this.w = imageDimensions.naturalWidth;\r\n    this.h = imageDimensions.naturalHeight;\r\n    this.polygon = polygon;\r\n    this.mask = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\r\n    this.mask.setAttribute('fill-rule', 'evenodd');\r\n    this.mask.setAttribute('class', 'a9s-selection-mask');\r\n    this.mask.setAttribute('d', \"M0 0 h\".concat(this.w, \" v\").concat(this.h, \" h-\").concat(this.w, \" z M\").concat(this.polygon.getAttribute('points'), \" z\"));\r\n  }\r\n\r\n  PolygonMask_createClass(PolygonMask, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.mask;\r\n    }\r\n  }]);\r\n\r\n  return PolygonMask;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/multipolygon/RubberbandMultipolygon.js\r\nfunction RubberbandMultipolygon_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\r\n\r\nfunction RubberbandMultipolygon_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? RubberbandMultipolygon_ownKeys(Object(source), !0).forEach(function (key) { RubberbandMultipolygon_defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : RubberbandMultipolygon_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\r\n\r\nfunction RubberbandMultipolygon_toConsumableArray(arr) { return RubberbandMultipolygon_arrayWithoutHoles(arr) || RubberbandMultipolygon_iterableToArray(arr) || RubberbandMultipolygon_unsupportedIterableToArray(arr) || RubberbandMultipolygon_nonIterableSpread(); }\r\n\r\nfunction RubberbandMultipolygon_nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction RubberbandMultipolygon_iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\r\n\r\nfunction RubberbandMultipolygon_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return RubberbandMultipolygon_arrayLikeToArray(arr); }\r\n\r\nfunction RubberbandMultipolygon_createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = RubberbandMultipolygon_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\r\n\r\nfunction RubberbandMultipolygon_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return RubberbandMultipolygon_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return RubberbandMultipolygon_arrayLikeToArray(o, minLen); }\r\n\r\nfunction RubberbandMultipolygon_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction RubberbandMultipolygon_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandMultipolygon_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandMultipolygon_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandMultipolygon_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandMultipolygon_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandMultipolygon_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n // TODO optional: mask to dim the outside area\r\n//import Mask from './multipolygonMask';\r\n\r\n/**\r\n * A 'rubberband' selection tool for creating multipolygon drawing by\r\n * clicking and dragging.\r\n */\r\n\r\nvar RubberbandMultipolygon = /*#__PURE__*/function () {\r\n  function RubberbandMultipolygon(anchor, g, env) {\r\n    var _this = this;\r\n\r\n    RubberbandMultipolygon_classCallCheck(this, RubberbandMultipolygon);\r\n\r\n    RubberbandMultipolygon_defineProperty(this, \"setPoints\", function (points) {\r\n      var attr = \"\";\r\n\r\n      var _iterator = RubberbandMultipolygon_createForOfIteratorHelper(points),\r\n          _step;\r\n\r\n      try {\r\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\r\n          var ps = _step.value;\r\n          var attr2 = \"\";\r\n\r\n          if (ps.length > 0) {\r\n            var _iterator2 = RubberbandMultipolygon_createForOfIteratorHelper(ps),\r\n                _step2;\r\n\r\n            try {\r\n              for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\r\n                var p = _step2.value;\r\n\r\n                if (p) {\r\n                  if (attr2 === \"\") {\r\n                    attr2 += \"M\".concat(p[0], \",\").concat(p[1]);\r\n                  } else {\r\n                    attr2 += \" L\".concat(p[0], \",\").concat(p[1]);\r\n                  }\r\n                }\r\n              }\r\n            } catch (err) {\r\n              _iterator2.e(err);\r\n            } finally {\r\n              _iterator2.f();\r\n            }\r\n\r\n            ;\r\n            attr += attr2;\r\n          }\r\n        }\r\n      } catch (err) {\r\n        _iterator.e(err);\r\n      } finally {\r\n        _iterator.f();\r\n      }\r\n\r\n      attr += \" Z\";\r\n\r\n      _this.outer.setAttribute('d', attr);\r\n\r\n      _this.inner.setAttribute('d', attr);\r\n    });\r\n\r\n    RubberbandMultipolygon_defineProperty(this, \"getBoundingClientRect\", function () {\r\n      return _this.outer.getBoundingClientRect();\r\n    });\r\n\r\n    RubberbandMultipolygon_defineProperty(this, \"dragTo\", function (xy) {\r\n      // Make visible\r\n      _this.group.style.display = null;\r\n\r\n      var head = _this.points[_this.points.length - 1].slice(0, _this.points[_this.points.length - 1].length - 1);\r\n\r\n      var headRest = _this.points.slice(0, -1);\r\n\r\n      var rubberband = [].concat(RubberbandMultipolygon_toConsumableArray(head), [xy, head[0]]);\r\n      headRest.push(rubberband);\r\n\r\n      _this.setPoints(headRest);\r\n\r\n      _this.mask.redraw();\r\n    });\r\n\r\n    RubberbandMultipolygon_defineProperty(this, \"addPoint\", function (xy) {\r\n      // Don't add a new point if distance < 2 pixels\r\n      if (_this.points[_this.points.length - 1].length > 0) {\r\n        var head = _this.points[_this.points.length - 1].slice(0, _this.points[_this.points.length - 1].length - 1);\r\n\r\n        var lastCorner = head[head.length - 1];\r\n        var dist = Math.pow(xy[0] - lastCorner[0], 2) + Math.pow(xy[1] - lastCorner[1], 2);\r\n\r\n        if (dist > 4) {\r\n          _this.points[_this.points.length - 1] = [].concat(RubberbandMultipolygon_toConsumableArray(head), [xy, head[0]]);\r\n\r\n          _this.setPoints(_this.points);\r\n\r\n          _this.mask.redraw();\r\n        }\r\n      } else {\r\n        _this.points[_this.points.length - 1] = [xy, xy];\r\n\r\n        _this.setPoints(_this.points);\r\n      }\r\n    });\r\n\r\n    RubberbandMultipolygon_defineProperty(this, \"undo\", function () {\r\n      if (_this.points[_this.points.length - 1].length > 2) {\r\n        _this.points[_this.points.length - 1].pop();\r\n      } else {\r\n        if (_this.points.length > 1) {\r\n          _this.points.pop();\r\n        }\r\n      }\r\n    });\r\n\r\n    RubberbandMultipolygon_defineProperty(this, \"newPart\", function () {\r\n      _this.points.push([]);\r\n    });\r\n\r\n    RubberbandMultipolygon_defineProperty(this, \"destroy\", function () {\r\n      _this.group.parentNode.removeChild(_this.group);\r\n\r\n      _this.multipolygon = null;\r\n      _this.group = null;\r\n    });\r\n\r\n    RubberbandMultipolygon_defineProperty(this, \"toSelection\", function () {\r\n      return new Selection(RubberbandMultipolygon_objectSpread(RubberbandMultipolygon_objectSpread({}, toSVGTarget(_this.group, _this.env.image)), {}, {\r\n        renderedVia: {\r\n          name: 'multipolygon'\r\n        }\r\n      }));\r\n    });\r\n\r\n    this.points = [];\r\n    this.points.push([anchor, anchor]);\r\n    this.env = env;\r\n    this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    this.multipolygon = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    this.multipolygon.setAttribute('class', 'a9s-selection');\r\n    this.outer = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\r\n    this.outer.setAttribute('class', 'a9s-outer');\r\n    this.inner = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\r\n    this.inner.setAttribute('class', 'a9s-inner');\r\n    this.setPoints(this.points);\r\n    this.mask = new PolygonMask(env.image, this.inner); // TODO optional: mask to dim the outside area\r\n    // this.mask = new Mask(env.image, this.inner);\r\n\r\n    this.multipolygon.appendChild(this.outer);\r\n    this.multipolygon.appendChild(this.inner); // Additionally, selection remains hidden until \r\n    // the user actually moves the mouse\r\n\r\n    this.group.style.display = 'none'; // TODO optional: mask to dim the outside area\r\n    // this.group.appendChild(this.mask.element);\r\n\r\n    this.group.appendChild(this.mask.element);\r\n    this.group.appendChild(this.multipolygon);\r\n    g.appendChild(this.group);\r\n  }\r\n\r\n  RubberbandMultipolygon_createClass(RubberbandMultipolygon, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.multipolygon;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandMultipolygon;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/multipolygon/EditableMultipolygon.js\r\nfunction EditableMultipolygon_typeof(obj) { \"@babel/helpers - typeof\"; return EditableMultipolygon_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, EditableMultipolygon_typeof(obj); }\r\n\r\nfunction EditableMultipolygon_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\r\n\r\nfunction EditableMultipolygon_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? EditableMultipolygon_ownKeys(Object(source), !0).forEach(function (key) { EditableMultipolygon_defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : EditableMultipolygon_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\r\n\r\nfunction EditableMultipolygon_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction EditableMultipolygon_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction EditableMultipolygon_createClass(Constructor, protoProps, staticProps) { if (protoProps) EditableMultipolygon_defineProperties(Constructor.prototype, protoProps); if (staticProps) EditableMultipolygon_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction EditableMultipolygon_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) EditableMultipolygon_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction EditableMultipolygon_setPrototypeOf(o, p) { EditableMultipolygon_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return EditableMultipolygon_setPrototypeOf(o, p); }\r\n\r\nfunction EditableMultipolygon_createSuper(Derived) { var hasNativeReflectConstruct = EditableMultipolygon_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = EditableMultipolygon_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = EditableMultipolygon_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return EditableMultipolygon_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction EditableMultipolygon_possibleConstructorReturn(self, call) { if (call && (EditableMultipolygon_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return EditableMultipolygon_assertThisInitialized(self); }\r\n\r\nfunction EditableMultipolygon_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction EditableMultipolygon_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction EditableMultipolygon_get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { EditableMultipolygon_get = Reflect.get.bind(); } else { EditableMultipolygon_get = function _get(target, property, receiver) { var base = EditableMultipolygon_superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return EditableMultipolygon_get.apply(this, arguments); }\r\n\r\nfunction EditableMultipolygon_superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = EditableMultipolygon_getPrototypeOf(object); if (object === null) break; } return object; }\r\n\r\nfunction EditableMultipolygon_getPrototypeOf(o) { EditableMultipolygon_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return EditableMultipolygon_getPrototypeOf(o); }\r\n\r\nfunction EditableMultipolygon_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\nfunction EditableMultipolygon_createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = EditableMultipolygon_unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\r\n\r\nfunction EditableMultipolygon_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return EditableMultipolygon_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EditableMultipolygon_arrayLikeToArray(o, minLen); }\r\n\r\nfunction EditableMultipolygon_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\n\r\n\r\n\r\n // TODO optional: mask to dim the outside area\r\n//import Mask from './MultipolygonMask';\r\n\r\nvar EditableMultipolygon_getPoints = function getPoints(shape) {\r\n  // Could just be Array.from(shape.querySelector('.inner').points) but...\r\n  // IE11 :-(\r\n  var pointLists = getPointsFromPathValue(shape.querySelector('.a9s-inner').attributes.d.nodeValue);\r\n  var pointArray = [];\r\n\r\n  var _iterator = EditableMultipolygon_createForOfIteratorHelper(pointLists),\r\n      _step;\r\n\r\n  try {\r\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\r\n      var pointList = _step.value;\r\n      var points = [];\r\n\r\n      var _iterator2 = EditableMultipolygon_createForOfIteratorHelper(pointList),\r\n          _step2;\r\n\r\n      try {\r\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\r\n          var point = _step2.value;\r\n          var p = {\r\n            x: parseFloat(point[0]),\r\n            y: parseFloat(point[1])\r\n          };\r\n          points.push(p);\r\n        }\r\n      } catch (err) {\r\n        _iterator2.e(err);\r\n      } finally {\r\n        _iterator2.f();\r\n      }\r\n\r\n      pointArray.push(points);\r\n    }\r\n  } catch (err) {\r\n    _iterator.e(err);\r\n  } finally {\r\n    _iterator.f();\r\n  }\r\n\r\n  return pointArray;\r\n};\r\n\r\nvar getPointsFromPathValue = function getPointsFromPathValue(polygon) {\r\n  var results = polygon.split('M');\r\n  var allcoords = [];\r\n  results.forEach(function (result, index) {\r\n    if (result.length > 0) {\r\n      var coords = [];\r\n      result = result.replace(/ Z/g, \"Z\");\r\n      result = result.replace(/Z /g, \"Z\");\r\n      result = result.replace(/Z/g, \"\");\r\n      result = result.replace(/L /g, \"L\");\r\n      result = result.replace(/ L/g, \"L\");\r\n      var coordsString = result.split(\"L\");\r\n      coordsString.forEach(function (coord, index) {\r\n        coords.push([parseFloat(coord.split(\",\")[0]).toFixed(2).toString(), parseFloat(coord.split(\",\")[1]).toFixed(2).toString()]);\r\n      });\r\n\r\n      if (coords[0] !== coords[coords.length - 1]) {\r\n        coords.push(coords[0]);\r\n      }\r\n\r\n      allcoords.push(coords);\r\n    }\r\n  });\r\n  return allcoords;\r\n};\r\n\r\nvar EditableMultipolygon_getBBox = function getBBox(shape) {\r\n  return shape.querySelector('.a9s-inner').getBBox();\r\n};\r\n\r\nvar svgFragmentToPoints = function svgFragmentToPoints(annotation) {\r\n  var svgShape = svgFragmentToShape(annotation);\r\n  var polygon = svgShape.getAttribute('d');\r\n  var allcoords = getPointsFromPathValue(polygon);\r\n  return allcoords; //svgShape.getAttribute('d')\r\n  //  .split(' ') // Split x/y tuples\r\n  //  .map(xy => xy.split(',').map(str => parseFloat(str.trim())));\r\n};\r\n\r\nvar EditableMultipolygon_drawEmbeddedSVG = function drawEmbeddedSVG(annotation) {\r\n  var shape = svgFragmentToShape(annotation); // Hack\r\n\r\n  svgFragmentToPoints(annotation); // Because we're nitpicky, we don't just draw the shape,\r\n  // but duplicate it, so we can have inner and an outer lines\r\n\r\n  var g = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n  var inner = shape.cloneNode(true);\r\n  inner.setAttribute('class', 'a9s-inner');\r\n  var outer = shape.cloneNode(true);\r\n  outer.setAttribute('class', 'a9s-outer');\r\n  g.appendChild(outer);\r\n  g.appendChild(inner);\r\n  return g;\r\n};\r\n/**\r\n * An editable multipolygon drawing.\r\n */\r\n\r\n\r\nvar EditableMultipolygon = /*#__PURE__*/function (_EditableShape) {\r\n  EditableMultipolygon_inherits(EditableMultipolygon, _EditableShape);\r\n\r\n  var _super = EditableMultipolygon_createSuper(EditableMultipolygon);\r\n\r\n  function EditableMultipolygon(_annotation, g, config, env) {\r\n    var _thisSuper, _this;\r\n\r\n    EditableMultipolygon_classCallCheck(this, EditableMultipolygon);\r\n\r\n    _this = _super.call(this, _annotation, g, config, env);\r\n\r\n    EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"setPoints\", function (points) {\r\n      var round = function round(num) {\r\n        return Math.round(10 * num) / 10;\r\n      };\r\n\r\n      var str = \"\";\r\n\r\n      var _iterator3 = EditableMultipolygon_createForOfIteratorHelper(points),\r\n          _step3;\r\n\r\n      try {\r\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\r\n          var pointList = _step3.value;\r\n          str += \"M\";\r\n          var first = true;\r\n\r\n          var _iterator4 = EditableMultipolygon_createForOfIteratorHelper(pointList),\r\n              _step4;\r\n\r\n          try {\r\n            for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\r\n              var point = _step4.value;\r\n\r\n              if (first) {\r\n                first = false;\r\n                str += point.x.toString() + \",\" + point.y.toString();\r\n              } else {\r\n                str += \" L\" + round(point.x).toString() + \",\" + round(point.y).toString();\r\n              }\r\n            }\r\n          } catch (err) {\r\n            _iterator4.e(err);\r\n          } finally {\r\n            _iterator4.f();\r\n          }\r\n\r\n          str += \" Z\";\r\n        }\r\n      } catch (err) {\r\n        _iterator3.e(err);\r\n      } finally {\r\n        _iterator3.f();\r\n      }\r\n\r\n      var inner = _this.shape.querySelector('.a9s-inner');\r\n\r\n      inner.setAttribute('d', str);\r\n\r\n      var outer = _this.shape.querySelector('.a9s-outer');\r\n\r\n      outer.setAttribute('d', str); // this.mask.redraw();\r\n\r\n      var _outer$getBBox = outer.getBBox(),\r\n          x = _outer$getBBox.x,\r\n          y = _outer$getBBox.y,\r\n          width = _outer$getBBox.width,\r\n          height = _outer$getBBox.height;\r\n\r\n      setFormatterElSize(_this.elementGroup, x, y, width, height);\r\n    });\r\n\r\n    EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\r\n      return function (evt) {\r\n        _this.grabbedElem = grabbedElem;\r\n\r\n        var pos = _this.getSVGPoint(evt);\r\n\r\n        _this.grabbedAt = {\r\n          x: pos.x,\r\n          y: pos.y\r\n        };\r\n      };\r\n    });\r\n\r\n    EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\r\n      if (_this.grabbedElem) {\r\n        (function () {\r\n          var pos = _this.getSVGPoint(evt);\r\n\r\n          if (_this.grabbedElem === _this.shape) {\r\n            (function () {\r\n              var dx = pos.x - _this.grabbedAt.x;\r\n              var dy = pos.y - _this.grabbedAt.y;\r\n              var pointList = EditableMultipolygon_getPoints(_this.shape);\r\n              var updatedPoints = [];\r\n\r\n              var _iterator5 = EditableMultipolygon_createForOfIteratorHelper(pointList),\r\n                  _step5;\r\n\r\n              try {\r\n                for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\r\n                  var points = _step5.value;\r\n                  updatedPoints.push(points.map(function (pt) {\r\n                    return {\r\n                      x: pt.x + dx,\r\n                      y: pt.y + dy\r\n                    };\r\n                  }));\r\n                }\r\n              } catch (err) {\r\n                _iterator5.e(err);\r\n              } finally {\r\n                _iterator5.f();\r\n              }\r\n\r\n              _this.grabbedAt = pos;\r\n\r\n              _this.setPoints(updatedPoints);\r\n\r\n              var i = 0;\r\n\r\n              for (var _i = 0, _updatedPoints = updatedPoints; _i < _updatedPoints.length; _i++) {\r\n                var updatedPointsList = _updatedPoints[_i];\r\n                updatedPointsList.forEach(function (pt, idx) {\r\n                  if (_this.handles[i][idx] !== undefined) _this.setHandleXY(_this.handles[i][idx], pt.x, pt.y);\r\n                });\r\n                i += 1;\r\n              }\r\n\r\n              _this.emit('update', EditableMultipolygon_objectSpread(EditableMultipolygon_objectSpread({}, toSVGTarget(_this.shape, _this.env.image)), {}, {\r\n                renderedVia: {\r\n                  name: 'multipolygon'\r\n                }\r\n              }));\r\n            })();\r\n          } else {\r\n            (function () {\r\n              var handleIdx = -1;\r\n              var pointListIDX = 0;\r\n              var found = false;\r\n\r\n              var _iterator6 = EditableMultipolygon_createForOfIteratorHelper(_this.handles),\r\n                  _step6;\r\n\r\n              try {\r\n                for (_iterator6.s(); !(_step6 = _iterator6.n()).done;) {\r\n                  var handle = _step6.value;\r\n\r\n                  if (handle.indexOf(_this.grabbedElem) > 0) {\r\n                    handleIdx = handle.indexOf(_this.grabbedElem);\r\n                    found = true;\r\n                  } else {\r\n                    if (!found) {\r\n                      pointListIDX += 1;\r\n                    }\r\n                  }\r\n                }\r\n              } catch (err) {\r\n                _iterator6.e(err);\r\n              } finally {\r\n                _iterator6.f();\r\n              }\r\n\r\n              var pointList = EditableMultipolygon_getPoints(_this.shape);\r\n              var updatedPoints = [];\r\n              var updatedPointsIDX = 0;\r\n\r\n              var _iterator7 = EditableMultipolygon_createForOfIteratorHelper(pointList),\r\n                  _step7;\r\n\r\n              try {\r\n                for (_iterator7.s(); !(_step7 = _iterator7.n()).done;) {\r\n                  var points = _step7.value;\r\n\r\n                  if (updatedPointsIDX === pointListIDX) {\r\n                    (function () {\r\n                      var newPoints = [];\r\n                      points.forEach(function (value, i) {\r\n                        if (i === handleIdx) {\r\n                          newPoints.push(pos);\r\n                        } else {\r\n                          newPoints.push(value);\r\n                        }\r\n                      });\r\n                      updatedPoints.push(newPoints);\r\n                    })();\r\n                  } else {\r\n                    updatedPoints.push(points);\r\n                  }\r\n\r\n                  updatedPointsIDX += 1;\r\n                }\r\n              } catch (err) {\r\n                _iterator7.e(err);\r\n              } finally {\r\n                _iterator7.f();\r\n              }\r\n\r\n              _this.setPoints(updatedPoints);\r\n\r\n              updatedPointsIDX = 0;\r\n\r\n              var _iterator8 = EditableMultipolygon_createForOfIteratorHelper(_this.handles),\r\n                  _step8;\r\n\r\n              try {\r\n                for (_iterator8.s(); !(_step8 = _iterator8.n()).done;) {\r\n                  var _handle = _step8.value;\r\n\r\n                  if (updatedPointsIDX === pointListIDX) {\r\n                    _this.setHandleXY(_handle[handleIdx], pos.x, pos.y);\r\n                  }\r\n\r\n                  updatedPointsIDX += 1;\r\n                }\r\n              } catch (err) {\r\n                _iterator8.e(err);\r\n              } finally {\r\n                _iterator8.f();\r\n              }\r\n\r\n              _this.emit('update', EditableMultipolygon_objectSpread(EditableMultipolygon_objectSpread({}, toSVGTarget(_this.shape, _this.env.image)), {}, {\r\n                renderedVia: {\r\n                  name: 'multipolygon'\r\n                }\r\n              }));\r\n            })();\r\n          }\r\n        })();\r\n      }\r\n    });\r\n\r\n    EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"onMouseUp\", function (evt) {\r\n      _this.grabbedElem = null;\r\n      _this.grabbedAt = null;\r\n    });\r\n\r\n    EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"updateState\", function (annotation) {\r\n      var points = EditableMultipolygon_getPoints(svgFragmentToShape(annotation));\r\n\r\n      _this.setPoints(points);\r\n    });\r\n\r\n    EditableMultipolygon_defineProperty(EditableMultipolygon_assertThisInitialized(_this), \"destroy\", function () {\r\n      _this.containerGroup.parentNode.removeChild(_this.containerGroup);\r\n\r\n      EditableMultipolygon_get((_thisSuper = EditableMultipolygon_assertThisInitialized(_this), EditableMultipolygon_getPrototypeOf(EditableMultipolygon.prototype)), \"destroy\", _thisSuper).call(_thisSuper);\r\n    });\r\n\r\n    _this.svg.addEventListener('mousemove', _this.onMouseMove);\r\n\r\n    _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\r\n    // \r\n    // <g>\r\n    //   <path class=\"a9s-selection mask\"... />\r\n    //   <g> <-- return this node as .element\r\n    //     <polygon class=\"a9s-outer\" ... />\r\n    //     <polygon class=\"a9s-inner\" ... />\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     ...\r\n    //   </g> \r\n    // </g>\r\n    // 'g' for the editable free drawing compound shape\r\n\r\n\r\n    _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    _this.shape = EditableMultipolygon_drawEmbeddedSVG(_annotation); // TODO optional: mask to dim the outside area\r\n    // this.mask = new Mask(env.image, this.shape.querySelector('.a9s-inner'));\r\n    // this.containerGroup.appendChild(this.mask.element);\r\n\r\n    _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n\r\n    _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\r\n\r\n    _this.elementGroup.appendChild(_this.shape);\r\n\r\n    var _pointList = EditableMultipolygon_getPoints(_this.shape);\r\n\r\n    _this.handles = [];\r\n\r\n    var _iterator9 = EditableMultipolygon_createForOfIteratorHelper(_pointList),\r\n        _step9;\r\n\r\n    try {\r\n      for (_iterator9.s(); !(_step9 = _iterator9.n()).done;) {\r\n        var points = _step9.value;\r\n\r\n        _this.handles.push(points.map(function (pt) {\r\n          var handle = _this.drawHandle(pt.x, pt.y);\r\n\r\n          handle.addEventListener('mousedown', _this.onGrab(handle));\r\n\r\n          _this.elementGroup.appendChild(handle);\r\n\r\n          return handle;\r\n        }));\r\n      }\r\n    } catch (err) {\r\n      _iterator9.e(err);\r\n    } finally {\r\n      _iterator9.f();\r\n    }\r\n\r\n    _this.containerGroup.appendChild(_this.elementGroup);\r\n\r\n    g.appendChild(_this.containerGroup);\r\n    format(_this.shape, _annotation, config.formatter);\r\n\r\n    _this.shape.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.shape));\r\n\r\n    var _getBBox = EditableMultipolygon_getBBox(_this.shape),\r\n        _x = _getBBox.x,\r\n        _y = _getBBox.y,\r\n        _width = _getBBox.width,\r\n        _height = _getBBox.height; // TODO optional: handles to stretch the shape\r\n\r\n    /*    this.handles = [\r\n          [ x, y ], \r\n          [ x + width, y ], \r\n          [ x + width, y + height ], \r\n          [ x, y + height ]\r\n        ].map(t => { \r\n          const [ x, y ] = t;\r\n          const handle = this.drawHandle(x, y);\r\n    \r\n          handle.addEventListener('mousedown', this.onGrab(handle));\r\n          this.elementGroup.appendChild(handle);\r\n    \r\n          return handle;\r\n        });*/\r\n    // The grabbed element (handle or entire shape), if any\r\n\r\n\r\n    _this.grabbedElem = null; // Mouse grab point\r\n\r\n    _this.grabbedAt = null;\r\n    return _this;\r\n  }\r\n\r\n  EditableMultipolygon_createClass(EditableMultipolygon, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.elementGroup;\r\n    }\r\n  }]);\r\n\r\n  return EditableMultipolygon;\r\n}(EditableShape);\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/multipolygon/RubberbandMultipolygonTool.js\r\nfunction RubberbandMultipolygonTool_typeof(obj) { \"@babel/helpers - typeof\"; return RubberbandMultipolygonTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, RubberbandMultipolygonTool_typeof(obj); }\r\n\r\nfunction RubberbandMultipolygonTool_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandMultipolygonTool_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandMultipolygonTool_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandMultipolygonTool_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandMultipolygonTool_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandMultipolygonTool_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) RubberbandMultipolygonTool_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction RubberbandMultipolygonTool_setPrototypeOf(o, p) { RubberbandMultipolygonTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return RubberbandMultipolygonTool_setPrototypeOf(o, p); }\r\n\r\nfunction RubberbandMultipolygonTool_createSuper(Derived) { var hasNativeReflectConstruct = RubberbandMultipolygonTool_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = RubberbandMultipolygonTool_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = RubberbandMultipolygonTool_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return RubberbandMultipolygonTool_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction RubberbandMultipolygonTool_possibleConstructorReturn(self, call) { if (call && (RubberbandMultipolygonTool_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return RubberbandMultipolygonTool_assertThisInitialized(self); }\r\n\r\nfunction RubberbandMultipolygonTool_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction RubberbandMultipolygonTool_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction RubberbandMultipolygonTool_getPrototypeOf(o) { RubberbandMultipolygonTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return RubberbandMultipolygonTool_getPrototypeOf(o); }\r\n\r\nfunction RubberbandMultipolygonTool_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n/**\r\n * A rubberband selector for Multipolygon fragments.\r\n */\r\n\r\nvar RubberbandMultipolygonTool = /*#__PURE__*/function (_Tool) {\r\n  RubberbandMultipolygonTool_inherits(RubberbandMultipolygonTool, _Tool);\r\n\r\n  var _super = RubberbandMultipolygonTool_createSuper(RubberbandMultipolygonTool);\r\n\r\n  function RubberbandMultipolygonTool(g, config, env) {\r\n    var _this;\r\n\r\n    RubberbandMultipolygonTool_classCallCheck(this, RubberbandMultipolygonTool);\r\n\r\n    _this = _super.call(this, g, config, env);\r\n\r\n    RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\r\n      _this._isDrawing = true;\r\n\r\n      _this.attachListeners({\r\n        mouseMove: _this.onMouseMove,\r\n        mouseUp: _this.onMouseUp,\r\n        dblClick: _this.onDblClick\r\n      });\r\n\r\n      _this.rubberband = new RubberbandMultipolygon([x, y], _this.g, _this.env);\r\n    });\r\n\r\n    RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"stop\", function () {\r\n      _this.detachListeners();\r\n\r\n      _this._isDrawing = false;\r\n\r\n      if (_this.rubberband) {\r\n        _this.rubberband.destroy();\r\n\r\n        _this.rubberband = null;\r\n      }\r\n    });\r\n\r\n    RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"undo\", function () {\r\n      if (_this.rubberband) {\r\n        _this.rubberband.undo();\r\n      }\r\n    });\r\n\r\n    RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"newPart\", function () {\r\n      if (_this.rubberband) {\r\n        _this.rubberband.newPart();\r\n      }\r\n    });\r\n\r\n    RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\r\n      return _this.rubberband.dragTo([x, y]);\r\n    });\r\n\r\n    RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"onMouseUp\", function (x, y, evt) {\r\n      if (evt.altKey) {\r\n        _this.onDblClick(evt);\r\n      } else if (evt.ctrlKey) {\r\n        _this.rubberband.undo();\r\n      } else {\r\n        var _this$rubberband$getB = _this.rubberband.getBoundingClientRect(),\r\n            width = _this$rubberband$getB.width,\r\n            height = _this$rubberband$getB.height;\r\n\r\n        var minWidth = _this.config.minSelectionWidth || 4;\r\n        var minHeight = _this.config.minSelectionHeight || 4;\r\n\r\n        if (width >= minWidth || height >= minHeight) {\r\n          _this.rubberband.addPoint([x, y]);\r\n        } else {\r\n          _this.emit('cancel');\r\n\r\n          _this.stop();\r\n        }\r\n      }\r\n    });\r\n\r\n    RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"onDblClick\", function (x, y) {\r\n      _this._isDrawing = false;\r\n\r\n      _this.rubberband.addPoint([x, y]);\r\n\r\n      var shape = _this.rubberband.element;\r\n      shape.annotation = _this.rubberband.toSelection();\r\n\r\n      _this.emit('complete', shape);\r\n\r\n      _this.stop();\r\n    });\r\n\r\n    RubberbandMultipolygonTool_defineProperty(RubberbandMultipolygonTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\r\n      return new EditableMultipolygon(annotation, _this.g, _this.config, _this.env);\r\n    });\r\n\r\n    _this._isDrawing = false;\r\n    document.addEventListener('keydown', function (evt) {\r\n      if (evt.key == \"z\" && evt.ctrlKey) {\r\n        _this.undo();\r\n      }\r\n\r\n      if (evt.key == 'n') {\r\n        _this.newPart();\r\n      }\r\n    });\r\n    return _this;\r\n  }\r\n\r\n  RubberbandMultipolygonTool_createClass(RubberbandMultipolygonTool, [{\r\n    key: \"isDrawing\",\r\n    get: function get() {\r\n      return this._isDrawing;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandMultipolygonTool;\r\n}(Tool);\r\n\r\n\r\nRubberbandMultipolygonTool.identifier = 'multipolygon';\r\n\r\nRubberbandMultipolygonTool.supports = function (annotation) {\r\n  return false;\r\n};\r\n;// CONCATENATED MODULE: ./src/line/LineMask.js\r\nfunction LineMask_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction LineMask_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction LineMask_createClass(Constructor, protoProps, staticProps) { if (protoProps) LineMask_defineProperties(Constructor.prototype, protoProps); if (staticProps) LineMask_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction LineMask_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\nvar LineMask = /*#__PURE__*/function () {\r\n  function LineMask(imageDimensions, line) {\r\n    var _this = this;\r\n\r\n    LineMask_classCallCheck(this, LineMask);\r\n\r\n    LineMask_defineProperty(this, \"redraw\", function () {\r\n      _this.mask.setAttribute('d', \"M0 0 h\".concat(_this.w, \" v\").concat(_this.h, \" h-\").concat(_this.w, \" z M\").concat(_this.line.getAttribute('x1'), \" \").concat(_this.line.getAttribute('y1'), \" \").concat(_this.line.getAttribute('x2'), \" \").concat(_this.line.getAttribute('y2'), \"z\"));\r\n    });\r\n\r\n    LineMask_defineProperty(this, \"destroy\", function () {\r\n      return _this.mask.parentNode.removeChild(_this.mask);\r\n    });\r\n\r\n    this.w = imageDimensions.naturalWidth;\r\n    this.h = imageDimensions.naturalHeight;\r\n    this.line = line;\r\n    this.mask = document.createElementNS(SVG_SVG_NAMESPACE, 'path');\r\n    this.mask.setAttribute('fill-rule', 'evenodd');\r\n    this.mask.setAttribute('class', 'a9s-selection-mask');\r\n    this.mask.setAttribute('d', \"M0 0 h\".concat(this.w, \" v\").concat(this.h, \" h-\").concat(this.w, \" z M\").concat(this.line.getAttribute('x1'), \" \").concat(this.line.getAttribute('y1'), \" z\"));\r\n  }\r\n\r\n  LineMask_createClass(LineMask, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.mask;\r\n    }\r\n  }]);\r\n\r\n  return LineMask;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/line/RubberbandLine.js\r\nfunction RubberbandLine_ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\r\n\r\nfunction RubberbandLine_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? RubberbandLine_ownKeys(Object(source), !0).forEach(function (key) { RubberbandLine_defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : RubberbandLine_ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\r\n\r\nfunction RubberbandLine_toConsumableArray(arr) { return RubberbandLine_arrayWithoutHoles(arr) || RubberbandLine_iterableToArray(arr) || RubberbandLine_unsupportedIterableToArray(arr) || RubberbandLine_nonIterableSpread(); }\r\n\r\nfunction RubberbandLine_nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction RubberbandLine_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return RubberbandLine_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return RubberbandLine_arrayLikeToArray(o, minLen); }\r\n\r\nfunction RubberbandLine_iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\r\n\r\nfunction RubberbandLine_arrayWithoutHoles(arr) { if (Array.isArray(arr)) return RubberbandLine_arrayLikeToArray(arr); }\r\n\r\nfunction RubberbandLine_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction RubberbandLine_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandLine_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandLine_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandLine_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandLine_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandLine_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * A 'rubberband' selection tool for creating Line drawing by\r\n * clicking and dragging.\r\n */\r\n\r\nvar RubberbandLine = /*#__PURE__*/function () {\r\n  function RubberbandLine(anchor, g, env) {\r\n    var _this = this;\r\n\r\n    RubberbandLine_classCallCheck(this, RubberbandLine);\r\n\r\n    RubberbandLine_defineProperty(this, \"setPoints\", function (points) {\r\n      var attr = points; // set attribute for line svg element for outer and inner\r\n      // example: <line x1=\"0\" y1=\"80\" x2=\"100\" y2=\"20\" stroke=\"black\" />\r\n\r\n      _this.outer.setAttribute('x1', attr[0]);\r\n\r\n      _this.inner.setAttribute('x1', attr[0]);\r\n\r\n      _this.outer.setAttribute('y1', attr[1]);\r\n\r\n      _this.inner.setAttribute('y1', attr[1]);\r\n\r\n      if (attr.length > 2) {\r\n        _this.outer.setAttribute('x2', attr[2]);\r\n\r\n        _this.inner.setAttribute('x2', attr[2]);\r\n\r\n        _this.outer.setAttribute('y2', attr[3]);\r\n\r\n        _this.inner.setAttribute('y2', attr[3]);\r\n      }\r\n    });\r\n\r\n    RubberbandLine_defineProperty(this, \"getBoundingClientRect\", function () {\r\n      return _this.outer.getBoundingClientRect();\r\n    });\r\n\r\n    RubberbandLine_defineProperty(this, \"dragTo\", function (xy) {\r\n      // Make visible\r\n      _this.group.style.display = null;\r\n      _this.mousepos = xy; //console.log(xy);\r\n\r\n      var rubberband = [].concat(RubberbandLine_toConsumableArray(_this.points), [xy[0], xy[1]]);\r\n\r\n      _this.setPoints(rubberband);\r\n\r\n      _this.mask.redraw();\r\n    });\r\n\r\n    RubberbandLine_defineProperty(this, \"addPoint\", function (xy) {\r\n      // Don't add a new point if distance < 2 pixels\r\n      if (_this.points.length <= 2) {\r\n        _this.points[2] = xy[0];\r\n        _this.points[3] = xy[1];\r\n\r\n        _this.setPoints(_this.points);\r\n      }\r\n    });\r\n\r\n    RubberbandLine_defineProperty(this, \"undo\", function () {\r\n      if (_this.points[_this.points.length - 1].length > 2) {\r\n        _this.points[_this.points.length - 1].pop();\r\n      } else {\r\n        if (_this.points.length > 1) {\r\n          _this.points.pop();\r\n        }\r\n      }\r\n    });\r\n\r\n    RubberbandLine_defineProperty(this, \"newPart\", function () {\r\n      _this.points.push([]);\r\n    });\r\n\r\n    RubberbandLine_defineProperty(this, \"destroy\", function () {\r\n      _this.group.parentNode.removeChild(_this.group);\r\n\r\n      _this.Line = null;\r\n      _this.group = null;\r\n    });\r\n\r\n    RubberbandLine_defineProperty(this, \"toSelection\", function () {\r\n      return new Selection(RubberbandLine_objectSpread(RubberbandLine_objectSpread({}, toSVGTarget(_this.group, _this.env.image)), {}, {\r\n        renderedVia: {\r\n          name: 'line'\r\n        }\r\n      }));\r\n    });\r\n\r\n    this.points = anchor; //this.points.push([ anchor, anchor ])\r\n\r\n    this.env = env;\r\n    this.group = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    this.Line = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    this.Line.setAttribute('class', 'a9s-selection');\r\n    this.outer = document.createElementNS(SVG_SVG_NAMESPACE, 'line');\r\n    this.outer.setAttribute('class', 'a9s-outer');\r\n    this.inner = document.createElementNS(SVG_SVG_NAMESPACE, 'line');\r\n    this.inner.setAttribute('class', 'a9s-inner');\r\n    this.setPoints(this.points);\r\n    this.mask = new LineMask(env.image, this.inner); // TODO optional: mask to dim the outside area\r\n    // this.mask = new Mask(env.image, this.inner);\r\n\r\n    this.Line.appendChild(this.outer);\r\n    this.Line.appendChild(this.inner); // Additionally, selection remains hidden until \r\n    // the user actually moves the mouse\r\n\r\n    this.group.style.display = 'none'; // TODO optional: mask to dim the outside area\r\n    // this.group.appendChild(this.mask.element);\r\n\r\n    this.group.appendChild(this.mask.element);\r\n    this.group.appendChild(this.Line);\r\n    g.appendChild(this.group);\r\n  }\r\n\r\n  RubberbandLine_createClass(RubberbandLine, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.Line;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandLine;\r\n}();\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/line/EditableLine.js\r\nfunction EditableLine_typeof(obj) { \"@babel/helpers - typeof\"; return EditableLine_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, EditableLine_typeof(obj); }\r\n\r\nfunction EditableLine_slicedToArray(arr, i) { return EditableLine_arrayWithHoles(arr) || EditableLine_iterableToArrayLimit(arr, i) || EditableLine_unsupportedIterableToArray(arr, i) || EditableLine_nonIterableRest(); }\r\n\r\nfunction EditableLine_nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\r\n\r\nfunction EditableLine_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return EditableLine_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return EditableLine_arrayLikeToArray(o, minLen); }\r\n\r\nfunction EditableLine_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\r\n\r\nfunction EditableLine_iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\r\n\r\nfunction EditableLine_arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\r\n\r\nfunction EditableLine_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction EditableLine_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction EditableLine_createClass(Constructor, protoProps, staticProps) { if (protoProps) EditableLine_defineProperties(Constructor.prototype, protoProps); if (staticProps) EditableLine_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction EditableLine_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) EditableLine_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction EditableLine_setPrototypeOf(o, p) { EditableLine_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return EditableLine_setPrototypeOf(o, p); }\r\n\r\nfunction EditableLine_createSuper(Derived) { var hasNativeReflectConstruct = EditableLine_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = EditableLine_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = EditableLine_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return EditableLine_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction EditableLine_possibleConstructorReturn(self, call) { if (call && (EditableLine_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return EditableLine_assertThisInitialized(self); }\r\n\r\nfunction EditableLine_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction EditableLine_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction EditableLine_get() { if (typeof Reflect !== \"undefined\" && Reflect.get) { EditableLine_get = Reflect.get.bind(); } else { EditableLine_get = function _get(target, property, receiver) { var base = EditableLine_superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(arguments.length < 3 ? target : receiver); } return desc.value; }; } return EditableLine_get.apply(this, arguments); }\r\n\r\nfunction EditableLine_superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = EditableLine_getPrototypeOf(object); if (object === null) break; } return object; }\r\n\r\nfunction EditableLine_getPrototypeOf(o) { EditableLine_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return EditableLine_getPrototypeOf(o); }\r\n\r\nfunction EditableLine_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar EditableLine_getPoints = function getPoints(shape) {\r\n  // Could just be Array.from(shape.querySelector('.inner').points) but...\r\n  // IE11 :-(\r\n  var innerElement = shape.querySelector('.a9s-inner');\r\n  var points = [[innerElement.x1.baseVal, innerElement.y1.baseVal], [innerElement.x2.baseVal, innerElement.y2.baseVal]];\r\n  return points;\r\n};\r\n\r\nvar EditableLine_getBBox = function getBBox(shape) {\r\n  return shape.querySelector('.a9s-inner').getBBox();\r\n};\r\n/**\r\n * An editable line shape.\r\n */\r\n\r\n\r\nvar EditableLine = /*#__PURE__*/function (_EditableShape) {\r\n  EditableLine_inherits(EditableLine, _EditableShape);\r\n\r\n  var _super = EditableLine_createSuper(EditableLine);\r\n\r\n  function EditableLine(_annotation, g, config, env) {\r\n    var _thisSuper, _this;\r\n\r\n    EditableLine_classCallCheck(this, EditableLine);\r\n\r\n    _this = _super.call(this, _annotation, g, config, env);\r\n\r\n    EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"onScaleChanged\", function () {\r\n      return _this.handles.map(_this.scaleHandle);\r\n    });\r\n\r\n    EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"setPoints\", function (points) {\r\n      // Not using .toFixed(1) because that will ALWAYS\r\n      // return one decimal, e.g. \"15.0\" (when we want \"15\")\r\n      var round = function round(num) {\r\n        return Math.round(10 * num) / 10;\r\n      };\r\n\r\n      var x1 = points[0].x;\r\n      var y1 = points[0].y;\r\n      var x2 = points[1].x;\r\n      var y2 = points[1].y;\r\n\r\n      var inner = _this.shape.querySelector('.a9s-inner');\r\n\r\n      inner.setAttribute('x1', x1);\r\n      inner.setAttribute('y1', y1);\r\n      inner.setAttribute('x2', x2);\r\n      inner.setAttribute('y2', y2);\r\n\r\n      var outer = _this.shape.querySelector('.a9s-outer');\r\n\r\n      outer.setAttribute('x1', x1);\r\n      outer.setAttribute('y1', y1);\r\n      outer.setAttribute('x2', x2);\r\n      outer.setAttribute('y2', y2);\r\n\r\n      _this.mask.redraw();\r\n\r\n      var _outer$getBBox = outer.getBBox(),\r\n          x = _outer$getBBox.x,\r\n          y = _outer$getBBox.y,\r\n          width = _outer$getBBox.width,\r\n          height = _outer$getBBox.height;\r\n\r\n      setFormatterElSize(_this.elementGroup, x, y, width, height);\r\n    });\r\n\r\n    EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"onGrab\", function (grabbedElem) {\r\n      return function (evt) {\r\n        if (evt.button !== 0) return; // left click\r\n\r\n        _this.grabbedElem = grabbedElem;\r\n        _this.grabbedAt = _this.getSVGPoint(evt);\r\n      };\r\n    });\r\n\r\n    EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"onMouseMove\", function (evt) {\r\n      var constrain = function constrain(coord, delta, max) {\r\n        return coord + delta < 0 ? -coord : coord + delta > max ? max - coord : delta;\r\n      };\r\n\r\n      if (_this.grabbedElem) {\r\n        var pos = _this.getSVGPoint(evt);\r\n\r\n        if (_this.grabbedElem === _this.shape) {\r\n          var _getBBox = EditableLine_getBBox(_this.shape),\r\n              x = _getBBox.x,\r\n              y = _getBBox.y,\r\n              width = _getBBox.width,\r\n              height = _getBBox.height;\r\n\r\n          var _this$env$image = _this.env.image,\r\n              naturalWidth = _this$env$image.naturalWidth,\r\n              naturalHeight = _this$env$image.naturalHeight;\r\n          var dx = constrain(x, pos.x - _this.grabbedAt.x, naturalWidth - width);\r\n          var dy = constrain(y, pos.y - _this.grabbedAt.y, naturalHeight - height);\r\n          var updatedPoints = EditableLine_getPoints(_this.shape).map(function (pt) {\r\n            return {\r\n              x: pt[0].value + dx,\r\n              y: pt[1].value + dy\r\n            };\r\n          });\r\n          _this.grabbedAt = pos;\r\n\r\n          _this.setPoints(updatedPoints);\r\n\r\n          updatedPoints.forEach(function (pt, idx) {\r\n            return _this.setHandleXY(_this.handles[idx], pt.x, pt.y);\r\n          });\r\n\r\n          _this.emit('update', toSVGTarget(_this.shape, _this.env.image));\r\n        } else {\r\n          var handleIdx = _this.handles.indexOf(_this.grabbedElem);\r\n\r\n          var _updatedPoints = EditableLine_getPoints(_this.shape).map(function (pt, idx) {\r\n            return idx === handleIdx ? pos : {\r\n              'x': pt[0].value,\r\n              'y': pt[1].value\r\n            };\r\n          });\r\n\r\n          _this.setPoints(_updatedPoints);\r\n\r\n          _this.setHandleXY(_this.handles[handleIdx], pos.x, pos.y);\r\n\r\n          _this.emit('update', toSVGTarget(_this.shape, _this.env.image));\r\n        }\r\n      }\r\n    });\r\n\r\n    EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"onMouseUp\", function (evt) {\r\n      _this.grabbedElem = null;\r\n      _this.grabbedAt = null;\r\n    });\r\n\r\n    EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"updateState\", function (annotation) {\r\n      var points = svgFragmentToShape(annotation).getAttribute('points').split(' ') // Split x/y tuples\r\n      .map(function (xy) {\r\n        var _xy$split$map = xy.split(',').map(function (str) {\r\n          return parseFloat(str.trim());\r\n        }),\r\n            _xy$split$map2 = EditableLine_slicedToArray(_xy$split$map, 2),\r\n            x = _xy$split$map2[0],\r\n            y = _xy$split$map2[1];\r\n\r\n        return {\r\n          x: x,\r\n          y: y\r\n        };\r\n      });\r\n\r\n      _this.setPoints(points);\r\n\r\n      points.forEach(function (pt, idx) {\r\n        return _this.setHandleXY(_this.handles[idx], pt.x, pt.y);\r\n      });\r\n    });\r\n\r\n    EditableLine_defineProperty(EditableLine_assertThisInitialized(_this), \"destroy\", function () {\r\n      _this.containerGroup.parentNode.removeChild(_this.containerGroup);\r\n\r\n      EditableLine_get((_thisSuper = EditableLine_assertThisInitialized(_this), EditableLine_getPrototypeOf(EditableLine.prototype)), \"destroy\", _thisSuper).call(_thisSuper);\r\n    });\r\n\r\n    _this.svg.addEventListener('mousemove', _this.onMouseMove);\r\n\r\n    _this.svg.addEventListener('mouseup', _this.onMouseUp); // SVG markup for this class looks like this:\r\n    //\r\n    // <g>\r\n    //   <path class=\"a9s-selection mask\"... />\r\n    //   <g> <-- return this node as .element\r\n    //     <line class=\"a9s-outer\" ... />\r\n    //     <line class=\"a9s-inner\" ... />\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     <g class=\"a9s-handle\" ...> ... </g>\r\n    //     ...\r\n    //   </g>\r\n    // </g>\r\n    // 'g' for the editable line shape\r\n\r\n\r\n    _this.containerGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n    _this.shape = drawEmbeddedSVG(_annotation);\r\n\r\n    _this.shape.querySelector('.a9s-inner').addEventListener('mousedown', _this.onGrab(_this.shape));\r\n\r\n    _this.mask = new LineMask(env.image, _this.shape.querySelector('.a9s-inner'));\r\n\r\n    _this.containerGroup.appendChild(_this.mask.element);\r\n\r\n    _this.elementGroup = document.createElementNS(SVG_SVG_NAMESPACE, 'g');\r\n\r\n    _this.elementGroup.setAttribute('class', 'a9s-annotation editable selected');\r\n\r\n    _this.elementGroup.setAttribute('data-id', _annotation.id);\r\n\r\n    _this.elementGroup.appendChild(_this.shape);\r\n\r\n    _this.handles = EditableLine_getPoints(_this.shape).map(function (pt) {\r\n      var handle = _this.drawHandle(pt[0].value, pt[1].value);\r\n\r\n      handle.addEventListener('mousedown', _this.onGrab(handle));\r\n\r\n      _this.elementGroup.appendChild(handle);\r\n\r\n      return handle;\r\n    });\r\n\r\n    _this.containerGroup.appendChild(_this.elementGroup);\r\n\r\n    g.appendChild(_this.containerGroup);\r\n    format(_this.shape, _annotation, config.formatters); // The grabbed element (handle or entire shape), if any\r\n\r\n    _this.grabbedElem = null; // Mouse grab point\r\n\r\n    _this.grabbedAt = null;\r\n    return _this;\r\n  }\r\n\r\n  EditableLine_createClass(EditableLine, [{\r\n    key: \"element\",\r\n    get: function get() {\r\n      return this.elementGroup;\r\n    } // TODO: update this for line svg Attributes, currently not being used\r\n\r\n  }]);\r\n\r\n  return EditableLine;\r\n}(EditableShape);\r\n\r\n\r\n;// CONCATENATED MODULE: ./src/line/RubberbandLineTool.js\r\nfunction RubberbandLineTool_typeof(obj) { \"@babel/helpers - typeof\"; return RubberbandLineTool_typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, RubberbandLineTool_typeof(obj); }\r\n\r\nfunction RubberbandLineTool_classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\r\n\r\nfunction RubberbandLineTool_defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\r\n\r\nfunction RubberbandLineTool_createClass(Constructor, protoProps, staticProps) { if (protoProps) RubberbandLineTool_defineProperties(Constructor.prototype, protoProps); if (staticProps) RubberbandLineTool_defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\r\n\r\nfunction RubberbandLineTool_inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); Object.defineProperty(subClass, \"prototype\", { writable: false }); if (superClass) RubberbandLineTool_setPrototypeOf(subClass, superClass); }\r\n\r\nfunction RubberbandLineTool_setPrototypeOf(o, p) { RubberbandLineTool_setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return RubberbandLineTool_setPrototypeOf(o, p); }\r\n\r\nfunction RubberbandLineTool_createSuper(Derived) { var hasNativeReflectConstruct = RubberbandLineTool_isNativeReflectConstruct(); return function _createSuperInternal() { var Super = RubberbandLineTool_getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = RubberbandLineTool_getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return RubberbandLineTool_possibleConstructorReturn(this, result); }; }\r\n\r\nfunction RubberbandLineTool_possibleConstructorReturn(self, call) { if (call && (RubberbandLineTool_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return RubberbandLineTool_assertThisInitialized(self); }\r\n\r\nfunction RubberbandLineTool_assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\r\n\r\nfunction RubberbandLineTool_isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\r\n\r\nfunction RubberbandLineTool_getPrototypeOf(o) { RubberbandLineTool_getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return RubberbandLineTool_getPrototypeOf(o); }\r\n\r\nfunction RubberbandLineTool_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\r\n\r\n\r\n\r\n\r\n/**\r\n * A rubberband selector for Line fragments.\r\n */\r\n\r\nvar RubberbandLineTool = /*#__PURE__*/function (_Tool) {\r\n  RubberbandLineTool_inherits(RubberbandLineTool, _Tool);\r\n\r\n  var _super = RubberbandLineTool_createSuper(RubberbandLineTool);\r\n\r\n  function RubberbandLineTool(g, config, env) {\r\n    var _this;\r\n\r\n    RubberbandLineTool_classCallCheck(this, RubberbandLineTool);\r\n\r\n    _this = _super.call(this, g, config, env);\r\n\r\n    RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"startDrawing\", function (x, y) {\r\n      _this._isDrawing = true;\r\n\r\n      _this.attachListeners({\r\n        mouseMove: _this.onMouseMove,\r\n        mouseUp: _this.onMouseUp\r\n      });\r\n\r\n      _this.rubberband = new RubberbandLine([x, y], _this.g, _this.env);\r\n    });\r\n\r\n    RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"stop\", function () {\r\n      _this.detachListeners();\r\n\r\n      _this._isDrawing = false;\r\n\r\n      if (_this.rubberband) {\r\n        _this.rubberband.destroy();\r\n\r\n        _this.rubberband = null;\r\n      }\r\n    });\r\n\r\n    RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"undo\", function () {\r\n      if (_this.rubberband) {\r\n        _this.rubberband.undo();\r\n      }\r\n    });\r\n\r\n    RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"newPart\", function () {\r\n      if (_this.rubberband) {\r\n        _this.rubberband.newPart();\r\n      }\r\n    });\r\n\r\n    RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"onMouseMove\", function (x, y) {\r\n      return _this.rubberband.dragTo([x, y]);\r\n    });\r\n\r\n    RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"onMouseUp\", function (x, y, evt) {\r\n      if (evt.altKey) {\r\n        _this.onDblClick(evt);\r\n      } else if (evt.ctrlKey) {\r\n        _this.rubberband.undo();\r\n      } else {\r\n        // TODO: see when this is useful\r\n        // const { width, height } = this.rubberband.getBoundingClientRect();\r\n        // const minWidth = this.config.minSelectionWidth || 4;\r\n        // const minHeight = this.config.minSelectionHeight || 4;\r\n        if (_this.rubberband.points.length == 2) {\r\n          _this.rubberband.addPoint([x, y]); // check if both coordinates are same\r\n\r\n\r\n          if (_this.rubberband.points[0] == _this.rubberband.points[2] && _this.rubberband.points[1] == _this.rubberband.points[3]) {\r\n            _this.emit('cancel');\r\n\r\n            _this.stop();\r\n          } else {\r\n            _this._isDrawing = false;\r\n            var shape = _this.rubberband.element;\r\n            shape.annotation = _this.rubberband.toSelection();\r\n\r\n            _this.emit('complete', shape);\r\n\r\n            _this.stop();\r\n          }\r\n        }\r\n      }\r\n    });\r\n\r\n    RubberbandLineTool_defineProperty(RubberbandLineTool_assertThisInitialized(_this), \"createEditableShape\", function (annotation) {\r\n      return new EditableLine(annotation, _this.g, _this.config, _this.env);\r\n    });\r\n\r\n    _this._isDrawing = false;\r\n    document.addEventListener('keydown', function (evt) {\r\n      if (evt.key == \"z\" && evt.ctrlKey) {\r\n        _this.undo();\r\n      }\r\n\r\n      if (evt.key == 'n') {\r\n        _this.newPart();\r\n      }\r\n    });\r\n    return _this;\r\n  }\r\n\r\n  RubberbandLineTool_createClass(RubberbandLineTool, [{\r\n    key: \"isDrawing\",\r\n    get: function get() {\r\n      return this._isDrawing;\r\n    }\r\n  }]);\r\n\r\n  return RubberbandLineTool;\r\n}(Tool);\r\n\r\n\r\nRubberbandLineTool.identifier = 'line';\r\n\r\nRubberbandLineTool.supports = function (annotation) {\r\n  var _selector$value;\r\n\r\n  var selector = annotation.selector('SvgSelector');\r\n  if (selector) return (_selector$value = selector.value) === null || _selector$value === void 0 ? void 0 : _selector$value.match(/^<svg.*<line/g);\r\n};\r\n;// CONCATENATED MODULE: ./src/index.js\r\n\r\n\r\n\r\n\r\n\r\n\r\nvar ALL_TOOLS = new Set(['point', 'circle', 'ellipse', 'freehand', 'line' // 'multipolygon' // exclude from defaults for now\r\n]);\r\n\r\nvar SelectorPack = function SelectorPack(anno, config) {\r\n  // Add configured tools, or all\r\n  var tools = config !== null && config !== void 0 && config.tools ? config.tools.map(function (t) {\r\n    return t.toLowerCase();\r\n  }) : ALL_TOOLS;\r\n  tools.forEach(function (tool) {\r\n    if (tool === 'point') anno.addDrawingTool(PointTool);\r\n    if (tool === 'circle') anno.addDrawingTool(RubberbandCircleTool);\r\n    if (tool === 'ellipse') anno.addDrawingTool(RubberbandEllipseTool);\r\n    if (tool === 'freehand') anno.addDrawingTool(RubberbandFreehandTool);\r\n    if (tool === 'multipolygon') anno.addDrawingTool(RubberbandMultipolygonTool);\r\n    if (tool === 'line') anno.addDrawingTool(RubberbandLineTool);\r\n  });\r\n};\r\n\r\n/* harmony default export */ const src = (SelectorPack);\r\n})();\r\n\r\n__webpack_exports__ = __webpack_exports__[\"default\"];\r\n/******/ \treturn __webpack_exports__;\r\n/******/ })()\r\n;\r\n});\r\n//# sourceMappingURL=annotorious-selector-pack.js.map"],"mappings":"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"},"metadata":{},"sourceType":"script"}