{"ast":null,"code":"import { mapActions, mapState } from 'vuex';\nexport default {\n  name: 'FindRelatedModal',\n\n  data() {\n    return {\n      allItems: [],\n      related: {\n        items: [],\n        pages: 1,\n        currentPage: 1,\n        pageSize: 12\n      }\n    };\n  },\n\n  computed: { ...mapState({\n      showRelatedModal: 'showRelatedModal',\n      similarSlides: 'similarSlides',\n      similarImage: 'similarImage'\n    })\n  },\n  watch: {\n    similarSlides(newValue, oldValue) {\n      this.related.pages = Math.ceil(newValue.length / this.related.pageSize);\n      this.allItems = newValue;\n      this.handleChangePage(1);\n    }\n\n  },\n  methods: { ...mapActions({\n      findRelatedChangeModalVisible: 'findRelatedChangeModalVisible'\n    }),\n\n    handleChangePage(page) {\n      this.related.currentPage = page;\n      this.related.items = this.allItems.slice((page - 1) * this.related.pageSize, page * this.related.pageSize);\n    },\n\n    getTileData(data, type) {\n      // example: 0c4fd42a/3f0e/4491/a080/f69e25df43ed.svs_files/16/53_46.jpeg\n      let str = data.split('/');\n      let level = str[str.length - 2];\n      let xy = str[str.length - 1].split('.')[0].split('_');\n      let x = xy[0];\n      let y = xy[1];\n\n      switch (type) {\n        case 'level':\n          return level;\n\n        case 'x':\n          return x;\n\n        case 'y':\n          return y;\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAmEA;AACA;EACAA,wBADA;;EAEAC;IACA;MACAC,YADA;MAEAC;QACAC,SADA;QAEAC,QAFA;QAGAC,cAHA;QAIAC;MAJA;IAFA;EASA,CAZA;;EAaAC,YACA;MACAC,oCADA;MAEAC,8BAFA;MAGAC;IAHA;EADA,CAbA;EAoBAC;IACAF;MACA;MACA;MACA;IACA;;EALA,CApBA;EA2BAG,WACA;MACAC;IADA,EADA;;IAIAC;MACA;MACA;IACA,CAPA;;IAQAC;MACA;MACA;MACA;MACA;MACA;MACA;;MAEA;QACA;UACA;;QACA;UACA;;QACA;UACA;MANA;IAQA;;EAxBA;AA3BA","names":["name","data","allItems","related","items","pages","currentPage","pageSize","computed","showRelatedModal","similarSlides","similarImage","watch","methods","findRelatedChangeModalVisible","handleChangePage","getTileData"],"sourceRoot":"src/components","sources":["FindRelatedModal.vue"],"sourcesContent":["<template>\r\n    <div>\r\n    <v-dialog\r\n        v-model=\"showRelatedModal\"\r\n        fullscreen\r\n        hide-overlay\r\n        transition=\"dialog-bottom-transition\"\r\n        scrollable\r\n      >\r\n        <v-card tile >\r\n          <v-toolbar card dark color=\"primary\">\r\n            <v-btn icon dark @click=\"findRelatedChangeModalVisible(false)\">\r\n              <v-icon>close</v-icon>\r\n            </v-btn>\r\n            <v-toolbar-title>{{$t('case.findRelated.title')}}</v-toolbar-title>\r\n            <v-spacer></v-spacer>\r\n          </v-toolbar>\r\n          <v-card-text style=\"text-align: center;\" v-if=\"related.items.length > 0\">\r\n            <v-layout row wrap>\r\n              <v-card style=\"width:200px; margin: 10px;\">\r\n                  <img\r\n                    class=\"white--text\"\r\n                    height=\"200px\"\r\n                    :src=\"`${similarImage}`\"\r\n                  />\r\n                  <v-card-title>\r\n                    <div>\r\n                      <div style=\"padding:0; margin:0; font-weight:bold; font-size:14pt;\">\r\n                        {{$t('case.findRelated.targetImage')}}\r\n                      </div>\r\n                    </div>\r\n                  </v-card-title>\r\n                </v-card>\r\n                <v-card style=\"width:200px; margin: 10px;\" tile v-for=\"item in related.items\" :key=\"item.file_id\">\r\n                  <v-img\r\n                    class=\"white--text\"\r\n                    height=\"200px\"\r\n                    :src=\"`https://app.dpathology.ru/tiles/${item.tile_position}`\"\r\n                  >\r\n                  </v-img>\r\n                  <v-card-title>\r\n                    <div>\r\n                      <div style=\"padding:0; margin:0; font-weight:bold; font-size:12pt;\">\r\n                        {{$t('case.findRelated.caseTitle')}}: <a :href=\"`/cases/${item.case_id}`\" target=\"blank\">{{item.case_title}}</a>\r\n                        {{$t('case.findRelated.fileTitle')}}: <a :href=\"`/cases/${item.case_id}?slideID=${item.file_id}&level=${getTileData(item.tile_position, 'level')}&x=${getTileData(item.tile_position, 'x')}&y=${getTileData(item.tile_position, 'y')}`\" target=\"blank\">{{item.file_title}}</a>\r\n                      </div>\r\n                      <span>{{item.diagnosis}}</span>\r\n                    </div>\r\n                  </v-card-title>\r\n                </v-card>\r\n             \r\n            </v-layout>\r\n            <v-pagination :length=\"related.pages\"\r\n                          :value=\"related.currentPage\"\r\n                          @input=\"handleChangePage\"\r\n                          style=\"margin: 0 auto;\"></v-pagination>\r\n          </v-card-text>\r\n          <v-card-text  style=\"text-align: center;\" v-else>\r\n            <h1>{{$t('case.findRelated.noData')}}</h1>\r\n          </v-card-text>\r\n          <div style=\"flex: 1 1 auto;\"></div>\r\n        </v-card>\r\n      </v-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import { mapActions, mapState } from 'vuex'\r\n    export default {\r\n      name: 'FindRelatedModal',\r\n      data () {\r\n        return {\r\n          allItems: [],\r\n          related: {\r\n            items: [],\r\n            pages: 1,\r\n            currentPage: 1,\r\n            pageSize: 12\r\n          }\r\n        }\r\n      },\r\n      computed: {\r\n        ...mapState({\r\n          showRelatedModal: 'showRelatedModal',\r\n          similarSlides: 'similarSlides',\r\n          similarImage: 'similarImage'\r\n        })\r\n      },\r\n      watch: {\r\n        similarSlides (newValue, oldValue) {\r\n          this.related.pages = Math.ceil(newValue.length / this.related.pageSize)\r\n          this.allItems = newValue\r\n          this.handleChangePage(1)\r\n        }\r\n      },\r\n      methods: {\r\n        ...mapActions({\r\n          findRelatedChangeModalVisible: 'findRelatedChangeModalVisible'\r\n        }),\r\n        handleChangePage (page) {\r\n          this.related.currentPage = page\r\n          this.related.items = this.allItems.slice((page - 1) * this.related.pageSize, page * this.related.pageSize)\r\n        },\r\n        getTileData (data, type) {\r\n              // example: 0c4fd42a/3f0e/4491/a080/f69e25df43ed.svs_files/16/53_46.jpeg\r\n          let str = data.split('/')\r\n          let level = str[str.length - 2]\r\n          let xy = (str[str.length - 1].split('.')[0]).split('_')\r\n          let x = xy[0]\r\n          let y = xy[1]\r\n\r\n          switch (type) {\r\n            case 'level':\r\n              return level\r\n            case 'x':\r\n              return x\r\n            case 'y':\r\n              return y\r\n          }\r\n        }\r\n      }\r\n    }\r\n</script>\r\n<style>\r\n  .v-dialog__content{\r\n    z-index: 9999!important;\r\n  }\r\n</style>\r\n<style lang=\"scss\" scoped>\r\n\r\n</style>\r\n\r\n\r\n\r\n// WEBPACK FOOTER //\r\n// FindRelatedModal.vue?78613422"]},"metadata":{},"sourceType":"module"}