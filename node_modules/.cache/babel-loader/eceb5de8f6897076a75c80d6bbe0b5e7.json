{"ast":null,"code":"\"use strict\";\n\nconst {\n  setupForSimpleEventAccessors\n} = require(\"../helpers/create-event-accessor\");\n\nconst {\n  fireAnEvent\n} = require(\"../helpers/events\");\n\nconst EventTargetImpl = require(\"../events/EventTarget-impl\").implementation;\n\nconst AbortSignal = require(\"../generated/AbortSignal\");\n\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\n\nclass AbortSignalImpl extends EventTargetImpl {\n  constructor(globalObject, args, privateData) {\n    super(globalObject, args, privateData); // make event firing possible\n\n    this._ownerDocument = globalObject.document;\n    this.reason = undefined;\n    this.abortAlgorithms = new Set();\n  }\n\n  get aborted() {\n    return this.reason !== undefined;\n  }\n\n  static abort(globalObject, reason) {\n    const abortSignal = AbortSignal.createImpl(globalObject, []);\n\n    if (reason !== undefined) {\n      abortSignal.reason = reason;\n    } else {\n      abortSignal.reason = DOMException.create(globalObject, [\"The operation was aborted.\", \"AbortError\"]);\n    }\n\n    return abortSignal;\n  }\n\n  _signalAbort(reason) {\n    if (this.aborted) {\n      return;\n    }\n\n    if (reason !== undefined) {\n      this.reason = reason;\n    } else {\n      this.reason = DOMException.create(this._globalObject, [\"The operation was aborted.\", \"AbortError\"]);\n    }\n\n    for (const algorithm of this.abortAlgorithms) {\n      algorithm();\n    }\n\n    this.abortAlgorithms.clear();\n    fireAnEvent(\"abort\", this);\n  }\n\n  _addAlgorithm(algorithm) {\n    if (this.aborted) {\n      return;\n    }\n\n    this.abortAlgorithms.add(algorithm);\n  }\n\n  _removeAlgorithm(algorithm) {\n    this.abortAlgorithms.delete(algorithm);\n  }\n\n}\n\nsetupForSimpleEventAccessors(AbortSignalImpl.prototype, [\"abort\"]);\nmodule.exports = {\n  implementation: AbortSignalImpl\n};","map":{"version":3,"names":["setupForSimpleEventAccessors","require","fireAnEvent","EventTargetImpl","implementation","AbortSignal","DOMException","AbortSignalImpl","constructor","globalObject","args","privateData","_ownerDocument","document","reason","undefined","abortAlgorithms","Set","aborted","abort","abortSignal","createImpl","create","_signalAbort","_globalObject","algorithm","clear","_addAlgorithm","add","_removeAlgorithm","delete","prototype","module","exports"],"sources":["C:/Users/Danil/Desktop/122/node_modules/jsdom/lib/jsdom/living/aborting/AbortSignal-impl.js"],"sourcesContent":["\"use strict\";\n\nconst { setupForSimpleEventAccessors } = require(\"../helpers/create-event-accessor\");\nconst { fireAnEvent } = require(\"../helpers/events\");\nconst EventTargetImpl = require(\"../events/EventTarget-impl\").implementation;\nconst AbortSignal = require(\"../generated/AbortSignal\");\nconst DOMException = require(\"domexception/webidl2js-wrapper\");\n\nclass AbortSignalImpl extends EventTargetImpl {\n  constructor(globalObject, args, privateData) {\n    super(globalObject, args, privateData);\n\n    // make event firing possible\n    this._ownerDocument = globalObject.document;\n\n    this.reason = undefined;\n    this.abortAlgorithms = new Set();\n  }\n\n  get aborted() {\n    return this.reason !== undefined;\n  }\n\n  static abort(globalObject, reason) {\n    const abortSignal = AbortSignal.createImpl(globalObject, []);\n    if (reason !== undefined) {\n      abortSignal.reason = reason;\n    } else {\n      abortSignal.reason = DOMException.create(globalObject, [\"The operation was aborted.\", \"AbortError\"]);\n    }\n    return abortSignal;\n  }\n\n  _signalAbort(reason) {\n    if (this.aborted) {\n      return;\n    }\n\n    if (reason !== undefined) {\n      this.reason = reason;\n    } else {\n      this.reason = DOMException.create(this._globalObject, [\"The operation was aborted.\", \"AbortError\"]);\n    }\n\n    for (const algorithm of this.abortAlgorithms) {\n      algorithm();\n    }\n    this.abortAlgorithms.clear();\n\n    fireAnEvent(\"abort\", this);\n  }\n\n  _addAlgorithm(algorithm) {\n    if (this.aborted) {\n      return;\n    }\n    this.abortAlgorithms.add(algorithm);\n  }\n\n  _removeAlgorithm(algorithm) {\n    this.abortAlgorithms.delete(algorithm);\n  }\n}\n\nsetupForSimpleEventAccessors(AbortSignalImpl.prototype, [\"abort\"]);\n\nmodule.exports = {\n  implementation: AbortSignalImpl\n};\n"],"mappings":"AAAA;;AAEA,MAAM;EAAEA;AAAF,IAAmCC,OAAO,CAAC,kCAAD,CAAhD;;AACA,MAAM;EAAEC;AAAF,IAAkBD,OAAO,CAAC,mBAAD,CAA/B;;AACA,MAAME,eAAe,GAAGF,OAAO,CAAC,4BAAD,CAAP,CAAsCG,cAA9D;;AACA,MAAMC,WAAW,GAAGJ,OAAO,CAAC,0BAAD,CAA3B;;AACA,MAAMK,YAAY,GAAGL,OAAO,CAAC,gCAAD,CAA5B;;AAEA,MAAMM,eAAN,SAA8BJ,eAA9B,CAA8C;EAC5CK,WAAW,CAACC,YAAD,EAAeC,IAAf,EAAqBC,WAArB,EAAkC;IAC3C,MAAMF,YAAN,EAAoBC,IAApB,EAA0BC,WAA1B,EAD2C,CAG3C;;IACA,KAAKC,cAAL,GAAsBH,YAAY,CAACI,QAAnC;IAEA,KAAKC,MAAL,GAAcC,SAAd;IACA,KAAKC,eAAL,GAAuB,IAAIC,GAAJ,EAAvB;EACD;;EAEU,IAAPC,OAAO,GAAG;IACZ,OAAO,KAAKJ,MAAL,KAAgBC,SAAvB;EACD;;EAEW,OAALI,KAAK,CAACV,YAAD,EAAeK,MAAf,EAAuB;IACjC,MAAMM,WAAW,GAAGf,WAAW,CAACgB,UAAZ,CAAuBZ,YAAvB,EAAqC,EAArC,CAApB;;IACA,IAAIK,MAAM,KAAKC,SAAf,EAA0B;MACxBK,WAAW,CAACN,MAAZ,GAAqBA,MAArB;IACD,CAFD,MAEO;MACLM,WAAW,CAACN,MAAZ,GAAqBR,YAAY,CAACgB,MAAb,CAAoBb,YAApB,EAAkC,CAAC,4BAAD,EAA+B,YAA/B,CAAlC,CAArB;IACD;;IACD,OAAOW,WAAP;EACD;;EAEDG,YAAY,CAACT,MAAD,EAAS;IACnB,IAAI,KAAKI,OAAT,EAAkB;MAChB;IACD;;IAED,IAAIJ,MAAM,KAAKC,SAAf,EAA0B;MACxB,KAAKD,MAAL,GAAcA,MAAd;IACD,CAFD,MAEO;MACL,KAAKA,MAAL,GAAcR,YAAY,CAACgB,MAAb,CAAoB,KAAKE,aAAzB,EAAwC,CAAC,4BAAD,EAA+B,YAA/B,CAAxC,CAAd;IACD;;IAED,KAAK,MAAMC,SAAX,IAAwB,KAAKT,eAA7B,EAA8C;MAC5CS,SAAS;IACV;;IACD,KAAKT,eAAL,CAAqBU,KAArB;IAEAxB,WAAW,CAAC,OAAD,EAAU,IAAV,CAAX;EACD;;EAEDyB,aAAa,CAACF,SAAD,EAAY;IACvB,IAAI,KAAKP,OAAT,EAAkB;MAChB;IACD;;IACD,KAAKF,eAAL,CAAqBY,GAArB,CAAyBH,SAAzB;EACD;;EAEDI,gBAAgB,CAACJ,SAAD,EAAY;IAC1B,KAAKT,eAAL,CAAqBc,MAArB,CAA4BL,SAA5B;EACD;;AArD2C;;AAwD9CzB,4BAA4B,CAACO,eAAe,CAACwB,SAAjB,EAA4B,CAAC,OAAD,CAA5B,CAA5B;AAEAC,MAAM,CAACC,OAAP,GAAiB;EACf7B,cAAc,EAAEG;AADD,CAAjB"},"metadata":{},"sourceType":"script"}