{"ast":null,"code":"require(\"core-js/modules/es.error.cause.js\");\n\nrequire(\"core-js/modules/web.dom-exception.stack.js\");\n\nrequire(\"core-js/modules/es.regexp.flags.js\");\n\nrequire(\"core-js/modules/es.typed-array.at.js\");\n\nrequire(\"core-js/modules/esnext.typed-array.find-last.js\");\n\nrequire(\"core-js/modules/esnext.typed-array.find-last-index.js\");\n\n/*! For license information please see annotorious-tilted-box.js.LICENSE.txt */\n!function (e, t) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = t() : \"function\" == typeof define && define.amd ? define([], t) : \"object\" == typeof exports ? exports.Annotorious = t() : (e.Annotorious = e.Annotorious || {}, e.Annotorious.TiltedBox = t());\n}(self, function () {\n  return (() => {\n    var e = {\n      922: e => {\n        \"use strict\";\n\n        e.exports = function (e) {\n          var t = [];\n          return t.toString = function () {\n            return this.map(function (t) {\n              var n = e(t);\n              return t[2] ? \"@media \".concat(t[2], \" {\").concat(n, \"}\") : n;\n            }).join(\"\");\n          }, t.i = function (e, n, r) {\n            \"string\" == typeof e && (e = [[null, e, \"\"]]);\n            var o = {};\n            if (r) for (var i = 0; i < this.length; i++) {\n              var u = this[i][0];\n              null != u && (o[u] = !0);\n            }\n\n            for (var a = 0; a < e.length; a++) {\n              var c = [].concat(e[a]);\n              r && o[c[0]] || (n && (c[2] ? c[2] = \"\".concat(n, \" and \").concat(c[2]) : c[2] = n), t.push(c));\n            }\n          }, t;\n        };\n      },\n      162: e => {\n        \"use strict\";\n\n        function t(e, t) {\n          (null == t || t > e.length) && (t = e.length);\n\n          for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];\n\n          return r;\n        }\n\n        e.exports = function (e) {\n          var n,\n              r,\n              o = (r = 4, function (e) {\n            if (Array.isArray(e)) return e;\n          }(n = e) || function (e, t) {\n            var n = e && (\"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"]);\n\n            if (null != n) {\n              var r,\n                  o,\n                  i = [],\n                  u = !0,\n                  a = !1;\n\n              try {\n                for (n = n.call(e); !(u = (r = n.next()).done) && (i.push(r.value), !t || i.length !== t); u = !0);\n              } catch (e) {\n                a = !0, o = e;\n              } finally {\n                try {\n                  u || null == n.return || n.return();\n                } finally {\n                  if (a) throw o;\n                }\n              }\n\n              return i;\n            }\n          }(n, r) || function (e, n) {\n            if (e) {\n              if (\"string\" == typeof e) return t(e, n);\n              var r = Object.prototype.toString.call(e).slice(8, -1);\n              return \"Object\" === r && e.constructor && (r = e.constructor.name), \"Map\" === r || \"Set\" === r ? Array.from(e) : \"Arguments\" === r || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r) ? t(e, n) : void 0;\n            }\n          }(n, r) || function () {\n            throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n          }()),\n              i = o[1],\n              u = o[3];\n          if (!u) return i;\n\n          if (\"function\" == typeof btoa) {\n            var a = btoa(unescape(encodeURIComponent(JSON.stringify(u)))),\n                c = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(a),\n                s = \"/*# \".concat(c, \" */\"),\n                l = u.sources.map(function (e) {\n              return \"/*# sourceURL=\".concat(u.sourceRoot || \"\").concat(e, \" */\");\n            });\n            return [i].concat(l).concat([s]).join(\"\\n\");\n          }\n\n          return [i].join(\"\\n\");\n        };\n      },\n      94: e => {\n        \"use strict\";\n\n        function t(e) {\n          return t = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n            return typeof e;\n          } : function (e) {\n            return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n          }, t(e);\n        }\n\n        e.exports = function e(n, r) {\n          if (n === r) return !0;\n\n          if (n && r && \"object\" == t(n) && \"object\" == t(r)) {\n            if (n.constructor !== r.constructor) return !1;\n            var o, i, u;\n\n            if (Array.isArray(n)) {\n              if ((o = n.length) != r.length) return !1;\n\n              for (i = o; 0 != i--;) if (!e(n[i], r[i])) return !1;\n\n              return !0;\n            }\n\n            if (n.constructor === RegExp) return n.source === r.source && n.flags === r.flags;\n            if (n.valueOf !== Object.prototype.valueOf) return n.valueOf() === r.valueOf();\n            if (n.toString !== Object.prototype.toString) return n.toString() === r.toString();\n            if ((o = (u = Object.keys(n)).length) !== Object.keys(r).length) return !1;\n\n            for (i = o; 0 != i--;) if (!Object.prototype.hasOwnProperty.call(r, u[i])) return !1;\n\n            for (i = o; 0 != i--;) {\n              var a = u[i];\n              if (!e(n[a], r[a])) return !1;\n            }\n\n            return !0;\n          }\n\n          return n != n && r != r;\n        };\n      },\n      773: e => {\n        function t() {}\n\n        t.prototype = {\n          on: function (e, t, n) {\n            var r = this.e || (this.e = {});\n            return (r[e] || (r[e] = [])).push({\n              fn: t,\n              ctx: n\n            }), this;\n          },\n          once: function (e, t, n) {\n            var r = this;\n\n            function o() {\n              r.off(e, o), t.apply(n, arguments);\n            }\n\n            return o._ = t, this.on(e, o, n);\n          },\n          emit: function (e) {\n            for (var t = [].slice.call(arguments, 1), n = ((this.e || (this.e = {}))[e] || []).slice(), r = 0, o = n.length; r < o; r++) n[r].fn.apply(n[r].ctx, t);\n\n            return this;\n          },\n          off: function (e, t) {\n            var n = this.e || (this.e = {}),\n                r = n[e],\n                o = [];\n            if (r && t) for (var i = 0, u = r.length; i < u; i++) r[i].fn !== t && r[i].fn._ !== t && o.push(r[i]);\n            return o.length ? n[e] = o : delete n[e], this;\n          }\n        }, e.exports = t, e.exports.TinyEmitter = t;\n      },\n      27: (e, t, n) => {\n        \"use strict\";\n\n        n.d(t, {\n          Z: () => a\n        });\n        var r = n(162),\n            o = n.n(r),\n            i = n(922),\n            u = n.n(i)()(o());\n        u.push([e.id, \"g.a9s-annotation.tilted-box .a9s-tilted-box-baseline *,g.a9s-selection.tilted-box .a9s-tilted-box-baseline *{vector-effect:non-scaling-stroke}g.a9s-annotation.tilted-box .a9s-tilted-box-baseline .a9s-inner,g.a9s-selection.tilted-box .a9s-tilted-box-baseline .a9s-inner{stroke-width:3px;stroke:#fff}g.a9s-annotation.tilted-box .a9s-tilted-box-baseline .a9s-outer,g.a9s-selection.tilted-box .a9s-tilted-box-baseline .a9s-outer{stroke-width:5px}g.a9s-annotation.tilted-box .a9s-minor-handle,g.a9s-selection.tilted-box .a9s-minor-handle{stroke:#fff000;fill:#000}g.a9s-annotation.tilted-box .a9s-minor-handle:hover,g.a9s-selection.tilted-box .a9s-minor-handle:hover{stroke:#000;fill:#fff000}\", \"\", {\n          version: 3,\n          sources: [\"webpack://./src/TiltedBoxTool.scss\"],\n          names: [],\n          mappings: \"AAKI,6GACE,gCAAA,CAGF,+HACE,gBAAA,CACA,WAAA,CAGF,+HACE,gBAAA,CAKJ,2FACE,cAAA,CACA,SAAA,CAGF,uGACE,WAAA,CACA,YAAA\",\n          sourcesContent: [\"g.a9s-annotation.tilted-box,\\ng.a9s-selection.tilted-box  {\\n\\n  .a9s-tilted-box-baseline {\\n\\n    * {\\n      vector-effect:non-scaling-stroke;\\n    }\\n\\n    .a9s-inner {\\n      stroke-width:3px;\\n      stroke:#fff;\\n    }\\n\\n    .a9s-outer {\\n      stroke-width:5px;\\n    }\\n\\n  }\\n\\n  .a9s-minor-handle {\\n    stroke:#fff000;\\n    fill:#000;\\n  }\\n\\n  .a9s-minor-handle:hover {\\n    stroke:#000;\\n    fill:#fff000;\\n  }\\n\\n}\\n\"],\n          sourceRoot: \"\"\n        }]);\n        const a = u;\n      },\n      379: (e, t, n) => {\n        \"use strict\";\n\n        var r,\n            o = function () {\n          var e = {};\n          return function (t) {\n            if (void 0 === e[t]) {\n              var n = document.querySelector(t);\n              if (window.HTMLIFrameElement && n instanceof window.HTMLIFrameElement) try {\n                n = n.contentDocument.head;\n              } catch (e) {\n                n = null;\n              }\n              e[t] = n;\n            }\n\n            return e[t];\n          };\n        }(),\n            i = [];\n\n        function u(e) {\n          for (var t = -1, n = 0; n < i.length; n++) if (i[n].identifier === e) {\n            t = n;\n            break;\n          }\n\n          return t;\n        }\n\n        function a(e, t) {\n          for (var n = {}, r = [], o = 0; o < e.length; o++) {\n            var a = e[o],\n                c = t.base ? a[0] + t.base : a[0],\n                s = n[c] || 0,\n                l = \"\".concat(c, \" \").concat(s);\n            n[c] = s + 1;\n            var f = u(l),\n                p = {\n              css: a[1],\n              media: a[2],\n              sourceMap: a[3]\n            };\n            -1 !== f ? (i[f].references++, i[f].updater(p)) : i.push({\n              identifier: l,\n              updater: b(p, t),\n              references: 1\n            }), r.push(l);\n          }\n\n          return r;\n        }\n\n        function c(e) {\n          var t = document.createElement(\"style\"),\n              r = e.attributes || {};\n\n          if (void 0 === r.nonce) {\n            var i = n.nc;\n            i && (r.nonce = i);\n          }\n\n          if (Object.keys(r).forEach(function (e) {\n            t.setAttribute(e, r[e]);\n          }), \"function\" == typeof e.insert) e.insert(t);else {\n            var u = o(e.insert || \"head\");\n            if (!u) throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n            u.appendChild(t);\n          }\n          return t;\n        }\n\n        var s,\n            l = (s = [], function (e, t) {\n          return s[e] = t, s.filter(Boolean).join(\"\\n\");\n        });\n\n        function f(e, t, n, r) {\n          var o = n ? \"\" : r.media ? \"@media \".concat(r.media, \" {\").concat(r.css, \"}\") : r.css;\n          if (e.styleSheet) e.styleSheet.cssText = l(t, o);else {\n            var i = document.createTextNode(o),\n                u = e.childNodes;\n            u[t] && e.removeChild(u[t]), u.length ? e.insertBefore(i, u[t]) : e.appendChild(i);\n          }\n        }\n\n        function p(e, t, n) {\n          var r = n.css,\n              o = n.media,\n              i = n.sourceMap;\n          if (o ? e.setAttribute(\"media\", o) : e.removeAttribute(\"media\"), i && \"undefined\" != typeof btoa && (r += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i)))), \" */\")), e.styleSheet) e.styleSheet.cssText = r;else {\n            for (; e.firstChild;) e.removeChild(e.firstChild);\n\n            e.appendChild(document.createTextNode(r));\n          }\n        }\n\n        var d = null,\n            y = 0;\n\n        function b(e, t) {\n          var n, r, o;\n\n          if (t.singleton) {\n            var i = y++;\n            n = d || (d = c(t)), r = f.bind(null, n, i, !1), o = f.bind(null, n, i, !0);\n          } else n = c(t), r = p.bind(null, n, t), o = function () {\n            !function (e) {\n              if (null === e.parentNode) return !1;\n              e.parentNode.removeChild(e);\n            }(n);\n          };\n\n          return r(e), function (t) {\n            if (t) {\n              if (t.css === e.css && t.media === e.media && t.sourceMap === e.sourceMap) return;\n              r(e = t);\n            } else o();\n          };\n        }\n\n        e.exports = function (e, t) {\n          (t = t || {}).singleton || \"boolean\" == typeof t.singleton || (t.singleton = (void 0 === r && (r = Boolean(window && document && document.all && !window.atob)), r));\n          var n = a(e = e || [], t);\n          return function (e) {\n            if (e = e || [], \"[object Array]\" === Object.prototype.toString.call(e)) {\n              for (var r = 0; r < n.length; r++) {\n                var o = u(n[r]);\n                i[o].references--;\n              }\n\n              for (var c = a(e, t), s = 0; s < n.length; s++) {\n                var l = u(n[s]);\n                0 === i[l].references && (i[l].updater(), i.splice(l, 1));\n              }\n\n              n = c;\n            }\n          };\n        };\n      }\n    },\n        t = {};\n\n    function n(r) {\n      var o = t[r];\n      if (void 0 !== o) return o.exports;\n      var i = t[r] = {\n        id: r,\n        exports: {}\n      };\n      return e[r](i, i.exports, n), i.exports;\n    }\n\n    n.n = e => {\n      var t = e && e.__esModule ? () => e.default : () => e;\n      return n.d(t, {\n        a: t\n      }), t;\n    }, n.d = (e, t) => {\n      for (var r in t) n.o(t, r) && !n.o(e, r) && Object.defineProperty(e, r, {\n        enumerable: !0,\n        get: t[r]\n      });\n    }, n.o = (e, t) => Object.prototype.hasOwnProperty.call(e, t);\n    var r = {};\n    return (() => {\n      \"use strict\";\n\n      n.d(r, {\n        default: () => Xe\n      });\n      var e,\n          t = n(773),\n          o = n.n(t),\n          i = \"http://www.w3.org/2000/svg\",\n          u = new Uint8Array(16);\n\n      function a() {\n        if (!e && !(e = \"undefined\" != typeof crypto && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || \"undefined\" != typeof msCrypto && \"function\" == typeof msCrypto.getRandomValues && msCrypto.getRandomValues.bind(msCrypto))) throw new Error(\"crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported\");\n        return e(u);\n      }\n\n      const c = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,\n            s = function (e) {\n        return \"string\" == typeof e && c.test(e);\n      };\n\n      for (var l = [], f = 0; f < 256; ++f) l.push((f + 256).toString(16).substr(1));\n\n      const p = function (e, t, n) {\n        var r = (e = e || {}).random || (e.rng || a)();\n\n        if (r[6] = 15 & r[6] | 64, r[8] = 63 & r[8] | 128, t) {\n          n = n || 0;\n\n          for (var o = 0; o < 16; ++o) t[n + o] = r[o];\n\n          return t;\n        }\n\n        return function (e) {\n          var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0,\n              n = (l[e[t + 0]] + l[e[t + 1]] + l[e[t + 2]] + l[e[t + 3]] + \"-\" + l[e[t + 4]] + l[e[t + 5]] + \"-\" + l[e[t + 6]] + l[e[t + 7]] + \"-\" + l[e[t + 8]] + l[e[t + 9]] + \"-\" + l[e[t + 10]] + l[e[t + 11]] + l[e[t + 12]] + l[e[t + 13]] + l[e[t + 14]] + l[e[t + 15]]).toLowerCase();\n          if (!s(n)) throw TypeError(\"Stringified UUID is invalid\");\n          return n;\n        }(r);\n      };\n\n      var d = n(94),\n          y = n.n(d);\n\n      function b(e, t) {\n        var n = Object.keys(e);\n\n        if (Object.getOwnPropertySymbols) {\n          var r = Object.getOwnPropertySymbols(e);\n          t && (r = r.filter(function (t) {\n            return Object.getOwnPropertyDescriptor(e, t).enumerable;\n          })), n.push.apply(n, r);\n        }\n\n        return n;\n      }\n\n      function h(e) {\n        for (var t = 1; t < arguments.length; t++) {\n          var n = null != arguments[t] ? arguments[t] : {};\n          t % 2 ? b(Object(n), !0).forEach(function (t) {\n            g(e, t, n[t]);\n          }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : b(Object(n)).forEach(function (t) {\n            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t));\n          });\n        }\n\n        return e;\n      }\n\n      function v(e, t) {\n        for (var n = 0; n < t.length; n++) {\n          var r = t[n];\n          r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n        }\n      }\n\n      function g(e, t, n) {\n        return t in e ? Object.defineProperty(e, t, {\n          value: n,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : e[t] = n, e;\n      }\n\n      var m = function () {\n        function e(t, n) {\n          var r = this;\n          !function (e, t) {\n            if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, e), g(this, \"clone\", function (t, n) {\n            return new e(h(h({}, r.underlying), t), h(h({}, r.opts), n));\n          }), g(this, \"selector\", function (e) {\n            var t = r.underlying.target;\n            if (t.selector) return (Array.isArray(t.selector) ? t.selector : [t.selector]).find(function (t) {\n              return t.type === e;\n            });\n          }), this.underlying = t, this.opts = n;\n        }\n\n        var t, n;\n        return t = e, (n = [{\n          key: \"isEqual\",\n          value: function (e) {\n            return \"Annotation\" === (null == e ? void 0 : e.type) && (this.underlying === e.underlying || !(!this.underlying.id || !e.underlying.id) && y()(this.underlying, e.underlying));\n          }\n        }, {\n          key: \"readOnly\",\n          get: function () {\n            var e;\n            return null === (e = this.opts) || void 0 === e ? void 0 : e.readOnly;\n          }\n        }, {\n          key: \"id\",\n          get: function () {\n            return this.underlying.id;\n          }\n        }, {\n          key: \"type\",\n          get: function () {\n            return this.underlying.type;\n          }\n        }, {\n          key: \"motivation\",\n          get: function () {\n            return this.underlying.motivation;\n          }\n        }, {\n          key: \"body\",\n          get: function () {\n            return this.underlying.body;\n          }\n        }, {\n          key: \"target\",\n          get: function () {\n            return this.underlying.target;\n          }\n        }, {\n          key: \"bodies\",\n          get: function () {\n            return Array.isArray(this.underlying.body) ? this.underlying.body : [this.underlying.body];\n          },\n          set: function (e) {\n            this.underlying.body = e;\n          }\n        }, {\n          key: \"targets\",\n          get: function () {\n            return Array.isArray(this.underlying.target) ? this.underlying.target : [this.underlying.target];\n          }\n        }, {\n          key: \"quote\",\n          get: function () {\n            return this.selector(\"TextQuoteSelector\").exact;\n          }\n        }, {\n          key: \"start\",\n          get: function () {\n            return this.selector(\"TextPositionSelector\").start;\n          }\n        }, {\n          key: \"end\",\n          get: function () {\n            return this.selector(\"TextPositionSelector\").end;\n          }\n        }]) && v(t.prototype, n), e;\n      }();\n\n      function w(e, t) {\n        var n = Object.keys(e);\n\n        if (Object.getOwnPropertySymbols) {\n          var r = Object.getOwnPropertySymbols(e);\n          t && (r = r.filter(function (t) {\n            return Object.getOwnPropertyDescriptor(e, t).enumerable;\n          })), n.push.apply(n, r);\n        }\n\n        return n;\n      }\n\n      function S(e) {\n        for (var t = 1; t < arguments.length; t++) {\n          var n = null != arguments[t] ? arguments[t] : {};\n          t % 2 ? w(Object(n), !0).forEach(function (t) {\n            A(e, t, n[t]);\n          }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : w(Object(n)).forEach(function (t) {\n            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t));\n          });\n        }\n\n        return e;\n      }\n\n      function O(e, t) {\n        for (var n = 0; n < t.length; n++) {\n          var r = t[n];\n          r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n        }\n      }\n\n      function A(e, t, n) {\n        return t in e ? Object.defineProperty(e, t, {\n          value: n,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : e[t] = n, e;\n      }\n\n      g(m, \"create\", function (e) {\n        var t = {\n          \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n          type: \"Annotation\",\n          id: \"#\".concat(p()),\n          body: []\n        };\n        return new m(h(h({}, t), e));\n      });\n\n      var x = function () {\n        function e(t, n) {\n          var r = this;\n          !function (e, t) {\n            if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, e), A(this, \"clone\", function (t) {\n            var n = new e();\n            return n.underlying = JSON.parse(JSON.stringify(r.underlying)), t && (n.underlying = S(S({}, n.underlying), t)), n;\n          }), A(this, \"selector\", function (e) {\n            var t = r.underlying.target;\n            if (t.selector) return (Array.isArray(t.selector) ? t.selector : [t.selector]).find(function (t) {\n              return t.type === e;\n            });\n          }), A(this, \"toAnnotation\", function () {\n            var e = Object.assign({}, r.underlying, {\n              \"@context\": \"http://www.w3.org/ns/anno.jsonld\",\n              type: \"Annotation\",\n              id: \"#\".concat(p())\n            });\n            return new m(e);\n          }), this.underlying = {\n            type: \"Selection\",\n            body: n || [],\n            target: t\n          };\n        }\n\n        var t, n;\n        return t = e, (n = [{\n          key: \"type\",\n          get: function () {\n            return this.underlying.type;\n          }\n        }, {\n          key: \"body\",\n          get: function () {\n            return this.underlying.body;\n          }\n        }, {\n          key: \"target\",\n          get: function () {\n            return this.underlying.target;\n          }\n        }, {\n          key: \"targets\",\n          get: function () {\n            return Array.isArray(this.underlying.target) ? this.underlying.target : [this.underlying.target];\n          }\n        }, {\n          key: \"isEqual\",\n          value: function (e) {\n            return !!e && y()(this.underlying, e.underlying);\n          }\n        }, {\n          key: \"bodies\",\n          get: function () {\n            return Array.isArray(this.underlying.body) ? this.underlying.body : [this.underlying.body];\n          }\n        }, {\n          key: \"quote\",\n          get: function () {\n            return this.selector(\"TextQuoteSelector\").exact;\n          }\n        }, {\n          key: \"isSelection\",\n          get: function () {\n            return !0;\n          }\n        }]) && O(t.prototype, n), e;\n      }();\n\n      function j(e) {\n        return j = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n          return typeof e;\n        } : function (e) {\n          return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n        }, j(e);\n      }\n\n      function E(e, t) {\n        if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n      }\n\n      function P(e, t) {\n        for (var n = 0; n < t.length; n++) {\n          var r = t[n];\n          r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n        }\n      }\n\n      function C(e, t, n) {\n        return t && P(e.prototype, t), n && P(e, n), e;\n      }\n\n      function k(e, t) {\n        if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function\");\n        e.prototype = Object.create(t && t.prototype, {\n          constructor: {\n            value: e,\n            writable: !0,\n            configurable: !0\n          }\n        }), t && R(e, t);\n      }\n\n      function R(e, t) {\n        return R = Object.setPrototypeOf || function (e, t) {\n          return e.__proto__ = t, e;\n        }, R(e, t);\n      }\n\n      function M(e) {\n        var t = function () {\n          if (\"undefined\" == typeof Reflect || !Reflect.construct) return !1;\n          if (Reflect.construct.sham) return !1;\n          if (\"function\" == typeof Proxy) return !0;\n\n          try {\n            return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})), !0;\n          } catch (e) {\n            return !1;\n          }\n        }();\n\n        return function () {\n          var n,\n              r = H(e);\n\n          if (t) {\n            var o = H(this).constructor;\n            n = Reflect.construct(r, arguments, o);\n          } else n = r.apply(this, arguments);\n\n          return _(this, n);\n        };\n      }\n\n      function _(e, t) {\n        if (t && (\"object\" === j(t) || \"function\" == typeof t)) return t;\n        if (void 0 !== t) throw new TypeError(\"Derived constructors may only return object or undefined\");\n        return T(e);\n      }\n\n      function T(e) {\n        if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        return e;\n      }\n\n      function H(e) {\n        return H = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {\n          return e.__proto__ || Object.getPrototypeOf(e);\n        }, H(e);\n      }\n\n      function D(e, t, n) {\n        return t in e ? Object.defineProperty(e, t, {\n          value: n,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : e[t] = n, e;\n      }\n\n      var B = \"An implementation is missing\",\n          N = \"ontouchstart\" in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0,\n          L = function (e) {\n        k(n, e);\n        var t = M(n);\n\n        function n(e, r, o) {\n          var u;\n          E(this, n), D(T(u = t.call(this)), \"enableResponsive\", function () {\n            window.ResizeObserver && (u.resizeObserver = new ResizeObserver(function () {\n              var e = u.svg.getBoundingClientRect(),\n                  t = u.svg.viewBox.baseVal,\n                  n = t.width,\n                  r = t.height;\n              u.scale = Math.max(n / e.width, r / e.height), u.onScaleChanged && u.onScaleChanged(u.scale);\n            }), u.resizeObserver.observe(u.svg.parentNode));\n          }), D(T(u), \"getSVGPoint\", function (e) {\n            var t = u.svg.createSVGPoint();\n\n            if (N) {\n              var n = u.svg.getBoundingClientRect(),\n                  r = e.clientX - n.x,\n                  o = e.clientY - n.y,\n                  i = u.svg.getBoundingClientRect(),\n                  a = i.left,\n                  c = i.top;\n              return t.x = r + a, t.y = o + c, t.matrixTransform(u.g.getScreenCTM().inverse());\n            }\n\n            return t.x = e.offsetX, t.y = e.offsetY, t.matrixTransform(u.g.getCTM().inverse());\n          }), D(T(u), \"drawHandle\", function (e, t) {\n            var n = document.createElementNS(i, \"g\");\n            n.setAttribute(\"class\", \"a9s-handle\");\n\n            var r = document.createElementNS(i, \"g\"),\n                o = function (n) {\n              var r = document.createElementNS(i, \"circle\");\n              return r.setAttribute(\"cx\", e), r.setAttribute(\"cy\", t), r.setAttribute(\"r\", n), r;\n            },\n                a = u.config.handleRadius || 6,\n                c = o(a);\n\n            c.setAttribute(\"class\", \"a9s-handle-inner\");\n            var s = o(a + 1);\n            return s.setAttribute(\"class\", \"a9s-handle-outer\"), r.appendChild(s), r.appendChild(c), n.appendChild(r), n;\n          }), D(T(u), \"setHandleXY\", function (e, t, n) {\n            var r = e.querySelector(\".a9s-handle-inner\");\n            r.setAttribute(\"cx\", t), r.setAttribute(\"cy\", n);\n            var o = e.querySelector(\".a9s-handle-outer\");\n            o.setAttribute(\"cx\", t), o.setAttribute(\"cy\", n);\n          }), D(T(u), \"getHandleXY\", function (e) {\n            var t = e.querySelector(\".a9s-handle-outer\");\n            return {\n              x: parseFloat(t.getAttribute(\"cx\")),\n              y: parseFloat(t.getAttribute(\"cy\"))\n            };\n          }), D(T(u), \"scaleHandle\", function (e) {\n            var t = e.querySelector(\".a9s-handle-inner\"),\n                n = e.querySelector(\".a9s-handle-outer\"),\n                r = u.scale * (u.config.handleRadius || 6);\n            t.setAttribute(\"r\", r), n.setAttribute(\"r\", r);\n          }), u.svg = e.closest(\"svg\"), u.g = e, u.config = r, u.env = o, u.scale = 1;\n          var a = o.image;\n          return (a instanceof Element || a instanceof HTMLDocument) && u.enableResponsive(), u;\n        }\n\n        return C(n, [{\n          key: \"destroy\",\n          value: function () {\n            this.resizeObserver && this.resizeObserver.disconnect(), this.resizeObserver = null;\n          }\n        }]), n;\n      }(o()),\n          q = function (e) {\n        k(n, e);\n        var t = M(n);\n\n        function n(e, r, o) {\n          var i;\n          return E(this, n), D(T(i = t.call(this, e, r, o)), \"attachListeners\", function (e) {\n            var t = e.mouseMove,\n                n = e.mouseUp,\n                r = e.dblClick;\n            t && (i.mouseMove = function (e) {\n              var n = i.getSVGPoint(e),\n                  r = n.x,\n                  o = n.y;\n              i.started || (i.emit(\"startSelection\", {\n                x: r,\n                y: o\n              }), i.started = !0), t(r, o, e);\n            }, i.svg.addEventListener(\"mousemove\", i.mouseMove)), n && (i.mouseUp = function (e) {\n              if (0 === e.button) {\n                var t = i.getSVGPoint(e),\n                    r = t.x,\n                    o = t.y;\n                n(r, o, e);\n              }\n            }, document.addEventListener(\"mouseup\", i.mouseUp)), r && (i.dblClick = function (e) {\n              var t = i.getSVGPoint(e),\n                  n = t.x,\n                  o = t.y;\n              r(n, o, e);\n            }, document.addEventListener(\"dblclick\", i.dblClick));\n          }), D(T(i), \"detachListeners\", function () {\n            i.mouseMove && i.svg.removeEventListener(\"mousemove\", i.mouseMove), i.mouseUp && document.removeEventListener(\"mouseup\", i.mouseUp), i.dblClick && document.removeEventListener(\"dblclick\", i.dblClick);\n          }), D(T(i), \"start\", function (e, t) {\n            var n = i.getSVGPoint(e),\n                r = n.x,\n                o = n.y;\n            i.startDrawing(r, o, t, e);\n          }), D(T(i), \"startDrawing\", function (e) {\n            throw new Error(B);\n          }), D(T(i), \"createEditableShape\", function (e) {\n            throw new Error(B);\n          }), i.started = !1, i;\n        }\n\n        return C(n, [{\n          key: \"isDrawing\",\n          get: function () {\n            throw new Error(B);\n          }\n        }]), n;\n      }(L);\n\n      function U(e) {\n        return U = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n          return typeof e;\n        } : function (e) {\n          return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n        }, U(e);\n      }\n\n      function G(e, t) {\n        for (var n = 0; n < t.length; n++) {\n          var r = t[n];\n          r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n        }\n      }\n\n      function I(e, t) {\n        return I = Object.setPrototypeOf || function (e, t) {\n          return e.__proto__ = t, e;\n        }, I(e, t);\n      }\n\n      function V(e, t) {\n        if (t && (\"object\" === U(t) || \"function\" == typeof t)) return t;\n        if (void 0 !== t) throw new TypeError(\"Derived constructors may only return object or undefined\");\n        return F(e);\n      }\n\n      function F(e) {\n        if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        return e;\n      }\n\n      function z(e) {\n        return z = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {\n          return e.__proto__ || Object.getPrototypeOf(e);\n        }, z(e);\n      }\n\n      q.supports = function (e) {\n        throw new Error(B);\n      };\n\n      var X = \"An implementation is missing\",\n          Y = function (e) {\n        var t = function (e) {\n          Array.from(e.attributes).forEach(function (t) {\n            t.name.startsWith(\"on\") && e.removeAttribute(t.name);\n          });\n        },\n            n = e.getElementsByTagName(\"script\");\n\n        return Array.from(n).reverse().forEach(function (e) {\n          return e.parentNode.removeChild(e);\n        }), t(e), Array.from(e.querySelectorAll(\"*\")).forEach(t), e;\n      },\n          J = function (e) {\n        var t,\n            n,\n            r = e.selector(\"SvgSelector\");\n\n        if (r) {\n          var o = new DOMParser(),\n              u = r.value,\n              a = o.parseFromString(u, \"image/svg+xml\"),\n              c = a.lookupPrefix(i),\n              s = a.lookupNamespaceURI(null);\n          return c || s ? Y(a).firstChild : Y((t = a, n = new XMLSerializer().serializeToString(t.documentElement).replace(\"<svg>\", '<svg xmlns=\"'.concat(i, '\">')), new DOMParser().parseFromString(n, \"image/svg+xml\").documentElement)).firstChild;\n        }\n      },\n          W = function (e, t) {\n        return t ? Math.sqrt(Math.pow(t[0] - e[0], 2) + Math.pow(t[1] - e[1], 2)) : Math.sqrt(Math.pow(e[0], 2) + Math.pow(e[1], 2));\n      },\n          $ = function (e, t) {\n        return [e[0] - t[0], e[1] - t[1]];\n      },\n          Z = function (e, t) {\n        var n = Math.pow(10, t || 0);\n        return [Math.round(e[0] * n) / n, Math.round(e[1] * n) / n];\n      },\n          K = function (e) {\n        var t = Math.max(W(e), 1e-5);\n        return [e[0] / t, e[1] / t];\n      },\n          Q = function (e, t) {\n        var n = e[0] * t[0] + e[1] * t[1];\n        return Math.acos(n);\n      },\n          ee = function (e, t) {\n        return [e[0] + t[0], e[1] + t[1]];\n      },\n          te = function (e, t) {\n        return [t * e[0], t * e[1]];\n      },\n          ne = function (e) {\n        var t = document.createElementNS(i, \"g\"),\n            n = document.createElementNS(i, e);\n        n.setAttribute(\"class\", \"a9s-outer\");\n        var r = document.createElementNS(i, e);\n        return r.setAttribute(\"class\", \"a9s-inner\"), t.appendChild(n), t.appendChild(r), t;\n      },\n          re = function (e, t) {\n        var n = ne(\"line\");\n        return n.setAttribute(\"class\", \"a9s-tilted-box-baseline\"), e && t && ie(n, e, t), n;\n      },\n          oe = function (e) {\n        var t = ne(\"polygon\");\n        return e && ue(t, e), t;\n      },\n          ie = function (e, t, n) {\n        var r = function (e) {\n          e.setAttribute(\"x1\", t[0]), e.setAttribute(\"y1\", t[1]), e.setAttribute(\"x2\", n[0]), e.setAttribute(\"y2\", n[1]);\n        };\n\n        r(e.querySelector(\".a9s-inner\")), r(e.querySelector(\".a9s-outer\"));\n      },\n          ue = function (e, t) {\n        var n = t.map(function (e) {\n          return e.join(\",\");\n        }).join(\" \");\n        e.querySelector(\".a9s-inner\").setAttribute(\"points\", n), e.querySelector(\".a9s-outer\").setAttribute(\"points\", n);\n      },\n          ae = function (e) {\n        return e.querySelector(\".a9s-inner\").getAttribute(\"points\").split(\" \").map(function (e) {\n          return e.split(\",\").map(function (e) {\n            return parseFloat(e);\n          });\n        });\n      },\n          ce = function (e, t) {\n        var n = Math.round(.8 * (t || 6)),\n            r = document.createElementNS(i, \"circle\");\n        return r.setAttribute(\"class\", \"a9s-minor-handle\"), r.setAttribute(\"cx\", e[0]), r.setAttribute(\"cy\", e[1]), r.setAttribute(\"r\", n), r;\n      };\n\n      function se(e) {\n        return se = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n          return typeof e;\n        } : function (e) {\n          return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n        }, se(e);\n      }\n\n      function le(e, t) {\n        var n = Object.keys(e);\n\n        if (Object.getOwnPropertySymbols) {\n          var r = Object.getOwnPropertySymbols(e);\n          t && (r = r.filter(function (t) {\n            return Object.getOwnPropertyDescriptor(e, t).enumerable;\n          })), n.push.apply(n, r);\n        }\n\n        return n;\n      }\n\n      function fe(e) {\n        for (var t = 1; t < arguments.length; t++) {\n          var n = null != arguments[t] ? arguments[t] : {};\n          t % 2 ? le(Object(n), !0).forEach(function (t) {\n            Ae(e, t, n[t]);\n          }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : le(Object(n)).forEach(function (t) {\n            Object.defineProperty(e, t, Object.getOwnPropertyDescriptor(n, t));\n          });\n        }\n\n        return e;\n      }\n\n      function pe(e, t) {\n        return he(e) || function (e, t) {\n          var n = null == e ? null : \"undefined\" != typeof Symbol && e[Symbol.iterator] || e[\"@@iterator\"];\n\n          if (null != n) {\n            var r,\n                o,\n                i = [],\n                u = !0,\n                a = !1;\n\n            try {\n              for (n = n.call(e); !(u = (r = n.next()).done) && (i.push(r.value), !t || i.length !== t); u = !0);\n            } catch (e) {\n              a = !0, o = e;\n            } finally {\n              try {\n                u || null == n.return || n.return();\n              } finally {\n                if (a) throw o;\n              }\n            }\n\n            return i;\n          }\n        }(e, t) || ye(e, t) || de();\n      }\n\n      function de() {\n        throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n      }\n\n      function ye(e, t) {\n        if (e) {\n          if (\"string\" == typeof e) return be(e, t);\n          var n = Object.prototype.toString.call(e).slice(8, -1);\n          return \"Object\" === n && e.constructor && (n = e.constructor.name), \"Map\" === n || \"Set\" === n ? Array.from(e) : \"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? be(e, t) : void 0;\n        }\n      }\n\n      function be(e, t) {\n        (null == t || t > e.length) && (t = e.length);\n\n        for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];\n\n        return r;\n      }\n\n      function he(e) {\n        if (Array.isArray(e)) return e;\n      }\n\n      function ve(e, t) {\n        for (var n = 0; n < t.length; n++) {\n          var r = t[n];\n          r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n        }\n      }\n\n      function ge(e, t, n) {\n        return ge = \"undefined\" != typeof Reflect && Reflect.get ? Reflect.get : function (e, t, n) {\n          var r = function (e, t) {\n            for (; !Object.prototype.hasOwnProperty.call(e, t) && null !== (e = Oe(e)););\n\n            return e;\n          }(e, t);\n\n          if (r) {\n            var o = Object.getOwnPropertyDescriptor(r, t);\n            return o.get ? o.get.call(n) : o.value;\n          }\n        }, ge(e, t, n || e);\n      }\n\n      function me(e, t) {\n        return me = Object.setPrototypeOf || function (e, t) {\n          return e.__proto__ = t, e;\n        }, me(e, t);\n      }\n\n      function we(e, t) {\n        if (t && (\"object\" === se(t) || \"function\" == typeof t)) return t;\n        if (void 0 !== t) throw new TypeError(\"Derived constructors may only return object or undefined\");\n        return Se(e);\n      }\n\n      function Se(e) {\n        if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        return e;\n      }\n\n      function Oe(e) {\n        return Oe = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {\n          return e.__proto__ || Object.getPrototypeOf(e);\n        }, Oe(e);\n      }\n\n      function Ae(e, t, n) {\n        return t in e ? Object.defineProperty(e, t, {\n          value: n,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : e[t] = n, e;\n      }\n\n      var xe = function (e) {\n        !function (e, t) {\n          if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function\");\n          e.prototype = Object.create(t && t.prototype, {\n            constructor: {\n              value: e,\n              writable: !0,\n              configurable: !0\n            }\n          }), t && me(e, t);\n        }(a, e);\n        var t,\n            n,\n            r,\n            o,\n            u = (r = a, o = function () {\n          if (\"undefined\" == typeof Reflect || !Reflect.construct) return !1;\n          if (Reflect.construct.sham) return !1;\n          if (\"function\" == typeof Proxy) return !0;\n\n          try {\n            return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})), !0;\n          } catch (e) {\n            return !1;\n          }\n        }(), function () {\n          var e,\n              t = Oe(r);\n\n          if (o) {\n            var n = Oe(this).constructor;\n            e = Reflect.construct(t, arguments, n);\n          } else e = t.apply(this, arguments);\n\n          return we(this, e);\n        });\n\n        function a(e, t, n, r) {\n          var o;\n          !function (e, t) {\n            if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, a), Ae(Se(o = u.call(this, e, t, n, r)), \"setShape\", function (e) {\n            ue(o.box, e), ie(o.baseline, e[0], e[1]), o.baseEndHandle.setAttribute(\"cx\", e[1][0]), o.baseEndHandle.setAttribute(\"cy\", e[1][1]), o.oppositeHandle.setAttribute(\"cx\", e[2][0]), o.oppositeHandle.setAttribute(\"cy\", e[2][1]), o.setHandleXY(o.pivotHandle, e[0][0], e[0][1]);\n          }), Ae(Se(o), \"setBaseEnd\", function (e) {\n            var t = pe(ae(o.box), 4),\n                n = t[0],\n                r = t[1],\n                i = t[2],\n                u = (t[3], W(r, i)),\n                a = $(e, n),\n                c = K([-a[1], a[0]]),\n                s = function () {\n              var e,\n                  t,\n                  o = Z(K($(r, n)), 5),\n                  u = Z(K($(i, r)), 5);\n              return (e = [-o[1], o[0]])[0] === (t = u)[0] && e[1] === t[1];\n            }() ? te(c, u) : te(c, -u),\n                l = ee(e, s),\n                f = ee(n, s);\n            o.setShape([n, e, l, f]);\n          }), Ae(Se(o), \"setOppositeCorner\", function (e) {\n            var t,\n                n = he(t = ae(o.box)) || function (e) {\n              if (\"undefined\" != typeof Symbol && null != e[Symbol.iterator] || null != e[\"@@iterator\"]) return Array.from(e);\n            }(t) || ye(t) || de(),\n                r = n[0],\n                i = n[1],\n                u = (n.slice(2), $(i, r)),\n                a = K([-u[1], u[0]]),\n                c = $(e, i),\n                s = [a[0] * W(c) * Math.cos(Q(a, K(c))), a[1] * W(c) * Math.cos(Q(a, K(c)))],\n                l = ee(i, s),\n                f = ee(r, s);\n\n            o.setShape([r, i, l, f]);\n          }), Ae(Se(o), \"onScaleChanged\", function (e) {\n            var t = o.pivotHandle.querySelector(\".a9s-handle-inner\"),\n                n = o.pivotHandle.querySelector(\".a9s-handle-outer\"),\n                r = e * (o.config.handleRadius || 6);\n            t.setAttribute(\"r\", r), n.setAttribute(\"r\", r);\n            var i = Math.round(.8 * r);\n            o.baseEndHandle.setAttribute(\"r\", i), o.oppositeHandle.setAttribute(\"r\", i);\n          }), Ae(Se(o), \"onGrab\", function (e) {\n            return function (t) {\n              0 === t.button && (o.grabbedElem = e, o.grabbedAt = o.getSVGPoint(t));\n            };\n          }), Ae(Se(o), \"onMouseMove\", function (e) {\n            var t = function (e, t, n) {\n              return e + t < 0 ? -e : e + t > n ? n - e : t;\n            };\n\n            if (o.grabbedElem) {\n              var n = o.getSVGPoint(e);\n\n              if (o.grabbedElem === o.box || o.grabbedElem === o.pivotHandle) {\n                var r = o.box.querySelector(\".a9s-inner\").getBBox(),\n                    u = r.x,\n                    a = r.y,\n                    c = r.width,\n                    s = r.height,\n                    l = o.env.image,\n                    f = l.naturalWidth,\n                    p = l.naturalHeight,\n                    d = t(u, n.x - o.grabbedAt.x, f - c),\n                    y = t(a, n.y - o.grabbedAt.y, p - s),\n                    b = ae(o.box).map(function (e) {\n                  return [e[0] + d, e[1] + y];\n                });\n                o.setShape(b);\n              } else o.grabbedElem === o.baseEndHandle ? o.setBaseEnd([n.x, n.y]) : o.grabbedElem === o.oppositeHandle && o.setOppositeCorner([n.x, n.y]);\n\n              o.grabbedAt = n, o.emit(\"update\", fe(fe({}, function (e, t) {\n                var n = e.querySelector(\".a9s-inner\").cloneNode(!0);\n                n.removeAttribute(\"class\"), n.removeAttribute(\"xmlns\");\n                var r = n.outerHTML || new XMLSerializer().serializeToString(n);\n                return r = r.replace(' xmlns=\"'.concat(i, '\"'), \"\"), {\n                  source: null == t ? void 0 : t.src,\n                  selector: {\n                    type: \"SvgSelector\",\n                    value: \"<svg>\".concat(r, \"</svg>\")\n                  }\n                };\n              }(o.box, o.env.image)), {}, {\n                renderedVia: {\n                  name: \"annotorious-tilted-box\"\n                }\n              }));\n            }\n          }), Ae(Se(o), \"onMouseUp\", function () {\n            o.grabbedElem = null, o.grabbedAt = null;\n          }), Ae(Se(o), \"updateState\", function (e) {\n            var t = J(e).getAttribute(\"points\").split(\" \").map(function (e) {\n              return e.split(\",\").map(function (e) {\n                return parseFloat(e);\n              });\n            });\n            o.setShape(t);\n          }), o.svg.addEventListener(\"mousemove\", o.onMouseMove), o.svg.addEventListener(\"mouseup\", o.onMouseUp);\n          var c = J(e).getAttribute(\"points\").split(\" \").map(function (e) {\n            return e.split(\",\").map(function (e) {\n              return parseFloat(e);\n            });\n          }),\n              s = pe(c, 4),\n              l = s[0],\n              f = s[1],\n              p = s[2];\n          return s[3], o.containerGroup = document.createElementNS(i, \"g\"), o._element = document.createElementNS(i, \"g\"), o._element.setAttribute(\"class\", \"a9s-annotation tilted-box editable selected\"), o.box = oe(c), o.box.querySelector(\".a9s-inner\").addEventListener(\"mousedown\", o.onGrab(o.box)), o.baseline = re(l, f), o.pivotHandle = o.drawHandle(l[0], l[1]), o.baseEndHandle = ce(f, n.handleRadius), o.oppositeHandle = ce(p, n.handleRadius), [o.pivotHandle, o.baseEndHandle, o.oppositeHandle].map(function (e) {\n            e.addEventListener(\"mousedown\", o.onGrab(e));\n          }), o._element.appendChild(o.box), o._element.appendChild(o.baseline), o._element.appendChild(o.pivotHandle), o._element.appendChild(o.baseEndHandle), o._element.appendChild(o.oppositeHandle), o.containerGroup.appendChild(o._element), t.appendChild(o.containerGroup), o.grabbedElem = null, o.grabbedAt = null, o;\n        }\n\n        return t = a, (n = [{\n          key: \"element\",\n          get: function () {\n            return this._element;\n          }\n        }, {\n          key: \"destroy\",\n          value: function () {\n            this.containerGroup.parentNode.removeChild(this.containerGroup), ge(Oe(a.prototype), \"destroy\", this).call(this);\n          }\n        }]) && ve(t.prototype, n), a;\n      }(function (e) {\n        !function (e, t) {\n          if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function\");\n          e.prototype = Object.create(t && t.prototype, {\n            constructor: {\n              value: e,\n              writable: !0,\n              configurable: !0\n            }\n          }), t && I(e, t);\n        }(u, e);\n        var t,\n            n,\n            r,\n            o,\n            i = (r = u, o = function () {\n          if (\"undefined\" == typeof Reflect || !Reflect.construct) return !1;\n          if (Reflect.construct.sham) return !1;\n          if (\"function\" == typeof Proxy) return !0;\n\n          try {\n            return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})), !0;\n          } catch (e) {\n            return !1;\n          }\n        }(), function () {\n          var e,\n              t = z(r);\n\n          if (o) {\n            var n = z(this).constructor;\n            e = Reflect.construct(t, arguments, n);\n          } else e = t.apply(this, arguments);\n\n          return V(this, e);\n        });\n\n        function u(e, t, n, r) {\n          var o, a, c, s;\n          return function (e, t) {\n            if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, u), s = function (e) {\n            throw new Error(X);\n          }, (c = \"updateState\") in (a = F(o = i.call(this, t, n, r))) ? Object.defineProperty(a, c, {\n            value: s,\n            enumerable: !0,\n            configurable: !0,\n            writable: !0\n          }) : a[c] = s, o.annotation = e, o;\n        }\n\n        return t = u, (n = [{\n          key: \"element\",\n          get: function () {\n            throw new Error(X);\n          }\n        }]) && G(t.prototype, n), u;\n      }(L));\n\n      function je(e) {\n        return je = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n          return typeof e;\n        } : function (e) {\n          return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n        }, je(e);\n      }\n\n      function Ee(e) {\n        return function (e) {\n          if (Array.isArray(e)) return e;\n        }(e) || function (e) {\n          if (\"undefined\" != typeof Symbol && null != e[Symbol.iterator] || null != e[\"@@iterator\"]) return Array.from(e);\n        }(e) || function (e, t) {\n          if (e) {\n            if (\"string\" == typeof e) return Pe(e, t);\n            var n = Object.prototype.toString.call(e).slice(8, -1);\n            return \"Object\" === n && e.constructor && (n = e.constructor.name), \"Map\" === n || \"Set\" === n ? Array.from(e) : \"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? Pe(e, t) : void 0;\n          }\n        }(e) || function () {\n          throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n        }();\n      }\n\n      function Pe(e, t) {\n        (null == t || t > e.length) && (t = e.length);\n\n        for (var n = 0, r = new Array(t); n < t; n++) r[n] = e[n];\n\n        return r;\n      }\n\n      function Ce(e, t) {\n        for (var n = 0; n < t.length; n++) {\n          var r = t[n];\n          r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n        }\n      }\n\n      function ke(e, t) {\n        return ke = Object.setPrototypeOf || function (e, t) {\n          return e.__proto__ = t, e;\n        }, ke(e, t);\n      }\n\n      function Re(e, t) {\n        if (t && (\"object\" === je(t) || \"function\" == typeof t)) return t;\n        if (void 0 !== t) throw new TypeError(\"Derived constructors may only return object or undefined\");\n        return Me(e);\n      }\n\n      function Me(e) {\n        if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        return e;\n      }\n\n      function _e(e) {\n        return _e = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {\n          return e.__proto__ || Object.getPrototypeOf(e);\n        }, _e(e);\n      }\n\n      function Te(e, t, n) {\n        return t in e ? Object.defineProperty(e, t, {\n          value: n,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : e[t] = n, e;\n      }\n\n      var He = function (e) {\n        !function (e, t) {\n          if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function\");\n          e.prototype = Object.create(t && t.prototype, {\n            constructor: {\n              value: e,\n              writable: !0,\n              configurable: !0\n            }\n          }), t && ke(e, t);\n        }(a, e);\n        var t,\n            n,\n            r,\n            o,\n            u = (r = a, o = function () {\n          if (\"undefined\" == typeof Reflect || !Reflect.construct) return !1;\n          if (Reflect.construct.sham) return !1;\n          if (\"function\" == typeof Proxy) return !0;\n\n          try {\n            return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})), !0;\n          } catch (e) {\n            return !1;\n          }\n        }(), function () {\n          var e,\n              t = _e(r);\n\n          if (o) {\n            var n = _e(this).constructor;\n\n            e = Reflect.construct(t, arguments, n);\n          } else e = t.apply(this, arguments);\n\n          return Re(this, e);\n        });\n\n        function a(e, t, n, r) {\n          var o;\n          !function (e, t) {\n            if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, a), Te(Me(o = u.call(this, t, n, r)), \"scalePivot\", function (e) {\n            var t = o.pivot.querySelector(\".a9s-handle-inner\"),\n                n = o.pivot.querySelector(\".a9s-handle-outer\"),\n                r = e * (o.config.handleRadius || 6);\n            t.setAttribute(\"r\", r), n.setAttribute(\"r\", r);\n          }), Te(Me(o), \"setPoints\", function (e) {\n            o.points = e;\n            var t = Ee(e),\n                n = t[0],\n                r = t[1];\n            t.slice(2), ie(o.baseline, n, r), ue(o.tiltedbox, e), o.setHandleXY(o.pivot, n[0], n[1]);\n          }), Te(Me(o), \"setBaseEnd\", function (e, t) {\n            var n = o.points[0],\n                r = [e, t];\n            o.setPoints([n, r, r, n]);\n          }), Te(Me(o), \"extrude\", function (e, t) {\n            var n = Ee(o.points),\n                r = n[0],\n                i = n[1],\n                u = (n.slice(2), $(i, r)),\n                a = K([-u[1], u[0]]),\n                c = $([e, t], i),\n                s = [a[0] * W(c) * Math.cos(Q(a, K(c))), a[1] * W(c) * Math.cos(Q(a, K(c)))],\n                l = ee(i, s),\n                f = ee(r, s);\n            o.setPoints([r, i, l, f]);\n          }), Te(Me(o), \"toSelection\", function (e) {\n            var t = o.tiltedbox.querySelector(\".a9s-inner\").getAttribute(\"points\");\n            return new x({\n              source: e,\n              selector: {\n                type: \"SvgSelector\",\n                value: '<svg><polygon points=\"'.concat(t, '\" /></svg>')\n              },\n              renderedVia: {\n                name: \"annotorious-tilted-box\"\n              }\n            });\n          }), Te(Me(o), \"destroy\", function () {\n            o.group.parentNode.removeChild(o.group), o.element = null, o.group = null;\n          }), o.points = e;\n          var c = Ee(e);\n          return c[0], c[1], c.slice(2), o.group = document.createElementNS(i, \"g\"), o.element = document.createElementNS(i, \"g\"), o.element.setAttribute(\"class\", \"a9s-selection tilted-box\"), o.baseline = re(), o.tiltedbox = oe(), o.pivot = o.drawHandle(0, 0), o.setPoints(e), o.element.style.pointerEvents = \"none\", o.element.appendChild(o.tiltedbox), o.element.appendChild(o.baseline), o.element.appendChild(o.pivot), o.group.appendChild(o.element), t.appendChild(o.group), o;\n        }\n\n        return t = a, (n = [{\n          key: \"isCollapsed\",\n          get: function () {\n            var e = (this.points, {\n              w: 100,\n              h: 100\n            });\n            return e.w * e.h < 9;\n          }\n        }]) && Ce(t.prototype, n), a;\n      }(L),\n          De = n(379),\n          Be = n.n(De),\n          Ne = n(27);\n\n      function Le(e) {\n        return Le = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (e) {\n          return typeof e;\n        } : function (e) {\n          return e && \"function\" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? \"symbol\" : typeof e;\n        }, Le(e);\n      }\n\n      function qe(e, t) {\n        for (var n = 0; n < t.length; n++) {\n          var r = t[n];\n          r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n        }\n      }\n\n      function Ue(e, t) {\n        return Ue = Object.setPrototypeOf || function (e, t) {\n          return e.__proto__ = t, e;\n        }, Ue(e, t);\n      }\n\n      function Ge(e, t) {\n        if (t && (\"object\" === Le(t) || \"function\" == typeof t)) return t;\n        if (void 0 !== t) throw new TypeError(\"Derived constructors may only return object or undefined\");\n        return Ie(e);\n      }\n\n      function Ie(e) {\n        if (void 0 === e) throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n        return e;\n      }\n\n      function Ve(e) {\n        return Ve = Object.setPrototypeOf ? Object.getPrototypeOf : function (e) {\n          return e.__proto__ || Object.getPrototypeOf(e);\n        }, Ve(e);\n      }\n\n      function Fe(e, t, n) {\n        return t in e ? Object.defineProperty(e, t, {\n          value: n,\n          enumerable: !0,\n          configurable: !0,\n          writable: !0\n        }) : e[t] = n, e;\n      }\n\n      Be()(Ne.Z, {\n        insert: \"head\",\n        singleton: !1\n      }), Ne.Z.locals;\n\n      var ze = function (e) {\n        !function (e, t) {\n          if (\"function\" != typeof t && null !== t) throw new TypeError(\"Super expression must either be null or a function\");\n          e.prototype = Object.create(t && t.prototype, {\n            constructor: {\n              value: e,\n              writable: !0,\n              configurable: !0\n            }\n          }), t && Ue(e, t);\n        }(u, e);\n        var t,\n            n,\n            r,\n            o,\n            i = (r = u, o = function () {\n          if (\"undefined\" == typeof Reflect || !Reflect.construct) return !1;\n          if (Reflect.construct.sham) return !1;\n          if (\"function\" == typeof Proxy) return !0;\n\n          try {\n            return Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})), !0;\n          } catch (e) {\n            return !1;\n          }\n        }(), function () {\n          var e,\n              t = Ve(r);\n\n          if (o) {\n            var n = Ve(this).constructor;\n            e = Reflect.construct(t, arguments, n);\n          } else e = t.apply(this, arguments);\n\n          return Ge(this, e);\n        });\n\n        function u(e, t, n) {\n          var r;\n          return function (e, t) {\n            if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, u), Fe(Ie(r = i.call(this, e, t, n)), \"onScaleChanged\", function (e) {\n            var t;\n            return null === (t = r.rubberbandShape) || void 0 === t ? void 0 : t.scalePivot(e);\n          }), Fe(Ie(r), \"startDrawing\", function (e, t, n) {\n            r.attachListeners({\n              mouseMove: r.onMouseMove,\n              mouseUp: r.onMouseUp\n            }), r.drawingState = \"BASELINE\", r.rubberbandShape = new He([[e, t], [e, t], [e, t], [e, t]], r.g, r.config, r.env);\n          }), Fe(Ie(r), \"onMouseMove\", function (e, t) {\n            \"BASELINE\" === r.drawingState ? r.rubberbandShape.setBaseEnd(e, t) : \"EXTRUDE\" === r.drawingState && r.rubberbandShape.extrude(e, t);\n          }), Fe(Ie(r), \"onMouseUp\", function () {\n            if (\"BASELINE\" === r.drawingState) r.rubberbandShape.isCollapsed ? (r.emit(\"cancel\"), r.stop()) : r.drawingState = \"EXTRUDE\";else if (\"EXTRUDE\" === r.drawingState) {\n              var e = r.rubberbandShape.element;\n              e.annotation = r.rubberbandShape.toSelection(r.env.image.src), r.emit(\"complete\", e), r.stop();\n            }\n          }), Fe(Ie(r), \"stop\", function () {\n            r.detachListeners(), r.drawingState = null, r.rubberbandShape && (r.rubberbandShape.destroy(), r.rubberbandShape = null);\n          }), Fe(Ie(r), \"createEditableShape\", function (e) {\n            return new xe(e, r.g, r.config, r.env);\n          }), r.drawingState = null, r.rubberbandShape = null, r;\n        }\n\n        return t = u, (n = [{\n          key: \"isDrawing\",\n          get: function () {\n            return null != this.drawingState;\n          }\n        }]) && qe(t.prototype, n), u;\n      }(q);\n\n      ze.identifier = \"annotorious-tilted-box\", ze.supports = function (e) {\n        return !1;\n      };\n\n      const Xe = function (e) {\n        e.addDrawingTool(ze);\n      };\n    })(), r.default;\n  })();\n});","map":{"version":3,"mappings":"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","names":["root","factory","exports","module","define","amd","Annotorious","TiltedBox","self","cssWithMappingToString","list","toString","this","map","item","content","concat","join","i","modules","mediaQuery","dedupe","alreadyImportedModules","length","id","_i","push","_arrayLikeToArray","arr","len","arr2","Array","_item","isArray","_arrayWithHoles","Symbol","iterator","_s","_e","_arr","_n","_d","call","next","done","value","err","return","_iterableToArrayLimit","o","minLen","n","Object","prototype","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","equal","a","b","t","keys","RegExp","flags","valueOf","hasOwnProperty","key","E","on","callback","ctx","e","fn","once","listener","off","apply","arguments","_","emit","evtArr","evts","liveEvents","TinyEmitter","___CSS_LOADER_EXPORT___","version","names","mappings","sourcesContent","memo","getTarget","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","stylesInDom","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","index","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","attributes","nonce","forEach","setAttribute","insert","Error","appendChild","textStore","replaceText","replacement","filter","Boolean","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","firstChild","singleton","singletonCounter","update","styleIndex","bind","parentNode","removeStyleElement","newObj","all","atob","lastIdentifiers","newList","newLastIdentifiers","_index","splice","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","__esModule","default","d","definition","defineProperty","enumerable","get","prop","getRandomValues","SVG_NAMESPACE","rnds8","Uint8Array","rng","crypto","msCrypto","s","uuid","REGEX","byteToHex","substr","p","buf","offset","rnds","random","toLowerCase","validate","WebAnnotation","annotation","opts","opt_props","opt_opts","r","underlying","selector","find","type","other","equals","readOnly","motivation","body","bodies","exact","start","end","stub","args","Selection","cloned","parse","assign","O","IMPLEMENTATION_MISSING","isTouch","navigator","maxTouchPoints","msMaxTouchPoints","ToolLike","k","g","config","env","u","ResizeObserver","resizeObserver","svgBounds","svg","getBoundingClientRect","viewBox","baseVal","width","height","scale","Math","max","onScaleChanged","observe","pt","createSVGPoint","bbox","x","evt","clientX","y","clientY","left","top","matrixTransform","getScreenCTM","inverse","offsetX","offsetY","getCTM","containerGroup","createElementNS","group","drawCircle","c","radius","handleRadius","inner","outer","handle","parseFloat","getAttribute","closest","image","Element","HTMLDocument","enableResponsive","disconnect","EventEmitter","Tool","mouseMove","mouseUp","dblClick","getSVGPoint","started","addEventListener","button","removeEventListener","startOnSingleClick","startDrawing","supports","sanitize","cleanEl","el","attr","startsWith","scripts","doc","getElementsByTagName","reverse","querySelectorAll","svgFragmentToShape","originalDoc","namespaced","parser","DOMParser","parseFromString","isPrefixDeclared","lookupPrefix","isDefaultNamespaceSVG","lookupNamespaceURI","XMLSerializer","serializeToString","documentElement","replace","xy1","xy2","sqrt","pow","vec","terminal","starting","round","decimalPlaces","factor","normalize","l","xy","angleBetween","dotProduct","acos","add","mult","elem","createBaseline","optA","optB","setBaseline","createBox","optPoints","setBoxPoints","to","setCoords","line","points","getBoxPoints","split","num","createMinorHandle","EditableTiltedBox","box","baseline","baseEndHandle","oppositeHandle","setHandleXY","pivotHandle","currentC","Geom2D","updatedBase","updatedNorm","updatedHeight","isClockwise","setShape","normal","toMouse","f","cos","minorRadius","grabbedElem","grabbedAt","constrain","coord","delta","pos","getBBox","naturalWidth","naturalHeight","dx","dy","updatedPoints","setBaseEnd","setOppositeCorner","shape","cloneNode","serialized","outerHTML","src","toSVGTarget","renderedVia","onMouseMove","onMouseUp","_element","onGrab","drawHandle","ge","ve","EditableShape","pivot","tiltedbox","setPoints","pointerX","pointerY","element","pointerEvents","w","h","Ce","Be","Ne","TiltedBoxTool","rubberbandShape","scalePivot","attachListeners","drawingState","RubberbandTiltedBox","extrude","isCollapsed","stop","toSelection","detachListeners","destroy","anno","addDrawingTool"],"sourceRoot":"","sources":["webpack://Annotorious.TiltedBox/webpack/universalModuleDefinition","webpack://Annotorious.TiltedBox/node_modules/css-loader/dist/runtime/api.js","webpack://Annotorious.TiltedBox/node_modules/css-loader/dist/runtime/cssWithMappingToString.js","webpack://Annotorious.TiltedBox/node_modules/fast-deep-equal/index.js","webpack://Annotorious.TiltedBox/node_modules/tiny-emitter/index.js","webpack://Annotorious.TiltedBox/src/TiltedBoxTool.scss","webpack://Annotorious.TiltedBox/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://Annotorious.TiltedBox/webpack/bootstrap","webpack://Annotorious.TiltedBox/webpack/runtime/compat get default export","webpack://Annotorious.TiltedBox/webpack/runtime/define property getters","webpack://Annotorious.TiltedBox/webpack/runtime/hasOwnProperty shorthand","webpack://Annotorious.TiltedBox/node_modules/uuid/dist/esm-browser/rng.js","webpack://Annotorious.TiltedBox/node_modules/@recogito/annotorious/src/util/SVG.js","webpack://Annotorious.TiltedBox/node_modules/uuid/dist/esm-browser/regex.js","webpack://Annotorious.TiltedBox/node_modules/uuid/dist/esm-browser/validate.js","webpack://Annotorious.TiltedBox/node_modules/uuid/dist/esm-browser/stringify.js","webpack://Annotorious.TiltedBox/node_modules/uuid/dist/esm-browser/v4.js","webpack://Annotorious.TiltedBox/node_modules/@recogito/recogito-client-core/src/WebAnnotation.js","webpack://Annotorious.TiltedBox/node_modules/@recogito/recogito-client-core/src/Selection.js","webpack://Annotorious.TiltedBox/node_modules/@recogito/annotorious/src/tools/Tool.js","webpack://Annotorious.TiltedBox/node_modules/@recogito/annotorious/src/util/Touch.js","webpack://Annotorious.TiltedBox/node_modules/@recogito/annotorious/src/tools/EditableShape.js","webpack://Annotorious.TiltedBox/node_modules/@recogito/annotorious/src/selectors/EmbeddedSVG.js","webpack://Annotorious.TiltedBox/src/Geom2D.js","webpack://Annotorious.TiltedBox/src/TiltedBox.js","webpack://Annotorious.TiltedBox/src/EditableTiltedBox.js","webpack://Annotorious.TiltedBox/src/RubberbandTiltedBox.js","webpack://Annotorious.TiltedBox/src/TiltedBoxTool.scss?7cce","webpack://Annotorious.TiltedBox/src/TiltedBoxTool.js","webpack://Annotorious.TiltedBox/src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Annotorious\"] = factory();\n\telse\n\t\troot[\"Annotorious\"] = root[\"Annotorious\"] || {}, root[\"Annotorious\"][\"TiltedBox\"] = factory();\n})(self, function() {\nreturn ","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === \"string\") {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, \"\"]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]); if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nmodule.exports = function cssWithMappingToString(item) {\n  var _item = _slicedToArray(item, 4),\n      content = _item[1],\n      cssMapping = _item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    // eslint-disable-next-line no-undef\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","function E () {\n  // Keep this empty so it's easier to inherit from\n  // (via https://github.com/lipsmack from https://github.com/scottcorgan/tiny-emitter/issues/3)\n}\n\nE.prototype = {\n  on: function (name, callback, ctx) {\n    var e = this.e || (this.e = {});\n\n    (e[name] || (e[name] = [])).push({\n      fn: callback,\n      ctx: ctx\n    });\n\n    return this;\n  },\n\n  once: function (name, callback, ctx) {\n    var self = this;\n    function listener () {\n      self.off(name, listener);\n      callback.apply(ctx, arguments);\n    };\n\n    listener._ = callback\n    return this.on(name, listener, ctx);\n  },\n\n  emit: function (name) {\n    var data = [].slice.call(arguments, 1);\n    var evtArr = ((this.e || (this.e = {}))[name] || []).slice();\n    var i = 0;\n    var len = evtArr.length;\n\n    for (i; i < len; i++) {\n      evtArr[i].fn.apply(evtArr[i].ctx, data);\n    }\n\n    return this;\n  },\n\n  off: function (name, callback) {\n    var e = this.e || (this.e = {});\n    var evts = e[name];\n    var liveEvents = [];\n\n    if (evts && callback) {\n      for (var i = 0, len = evts.length; i < len; i++) {\n        if (evts[i].fn !== callback && evts[i].fn._ !== callback)\n          liveEvents.push(evts[i]);\n      }\n    }\n\n    // Remove event from queue to prevent memory leak\n    // Suggested by https://github.com/lazd\n    // Ref: https://github.com/scottcorgan/tiny-emitter/commit/c6ebfaa9bc973b33d110a84a307742b7cf94c953#commitcomment-5024910\n\n    (liveEvents.length)\n      ? e[name] = liveEvents\n      : delete e[name];\n\n    return this;\n  }\n};\n\nmodule.exports = E;\nmodule.exports.TinyEmitter = E;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"g.a9s-annotation.tilted-box .a9s-tilted-box-baseline *,g.a9s-selection.tilted-box .a9s-tilted-box-baseline *{vector-effect:non-scaling-stroke}g.a9s-annotation.tilted-box .a9s-tilted-box-baseline .a9s-inner,g.a9s-selection.tilted-box .a9s-tilted-box-baseline .a9s-inner{stroke-width:3px;stroke:#fff}g.a9s-annotation.tilted-box .a9s-tilted-box-baseline .a9s-outer,g.a9s-selection.tilted-box .a9s-tilted-box-baseline .a9s-outer{stroke-width:5px}g.a9s-annotation.tilted-box .a9s-minor-handle,g.a9s-selection.tilted-box .a9s-minor-handle{stroke:#fff000;fill:#000}g.a9s-annotation.tilted-box .a9s-minor-handle:hover,g.a9s-selection.tilted-box .a9s-minor-handle:hover{stroke:#000;fill:#fff000}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/TiltedBoxTool.scss\"],\"names\":[],\"mappings\":\"AAKI,6GACE,gCAAA,CAGF,+HACE,gBAAA,CACA,WAAA,CAGF,+HACE,gBAAA,CAKJ,2FACE,cAAA,CACA,SAAA,CAGF,uGACE,WAAA,CACA,YAAA\",\"sourcesContent\":[\"g.a9s-annotation.tilted-box,\\ng.a9s-selection.tilted-box  {\\n\\n  .a9s-tilted-box-baseline {\\n\\n    * {\\n      vector-effect:non-scaling-stroke;\\n    }\\n\\n    .a9s-inner {\\n      stroke-width:3px;\\n      stroke:#fff;\\n    }\\n\\n    .a9s-outer {\\n      stroke-width:5px;\\n    }\\n\\n  }\\n\\n  .a9s-minor-handle {\\n    stroke:#fff000;\\n    fill:#000;\\n  }\\n\\n  .a9s-minor-handle:hover {\\n    stroke:#000;\\n    fill:#fff000;\\n  }\\n\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","export const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n\nconst getClassNames = el => {\n  const attr = el.getAttribute('class');\n  return attr ? new Set(attr.split(' ')) : new Set();\n}\n\n// IE11 doesn't support adding/removing classes to SVG elements except \n// via .setAttribute\nexport const addClass = (el, className) => {\n  const classNames = getClassNames(el);\n  classNames.add(className);\n  el.setAttribute('class', Array.from(classNames).join(' '));\n}\n\nexport const removeClass = (el, className) => {\n  const classNames = getClassNames(el);\n  classNames.delete(className);\n\n  if (classNames.size === 0)\n    el.removeAttribute('class');\n  else\n    el.setAttribute('class', Array.from(classNames).join(' '));\n}\n\nexport const hasClass = (el, className) =>\n  getClassNames(el).has(className);","export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;","import REGEX from './regex.js';\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && REGEX.test(uuid);\n}\n\nexport default validate;","import validate from './validate.js';\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nexport default stringify;","import rng from './rng.js';\nimport stringify from './stringify.js';\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return stringify(rnds);\n}\n\nexport default v4;","import { v4 as uuid } from 'uuid';\nimport equals from 'fast-deep-equal';\n\nexport default class WebAnnotation {\n\n  constructor(annotation, opts) {\n    this.underlying = annotation;\n    this.opts = opts;\n  }\n\n  /** For convenience - creates an empty web annotation **/\n  static create = args => {\n    const stub = {\n      '@context': 'http://www.w3.org/ns/anno.jsonld',\n      'type': 'Annotation',\n      'id': `#${uuid()}`,\n      'body': []\n    };\n\n    return new WebAnnotation({ ...stub, ...args });\n  }\n\n  /** Creates a copy of this annotation **/\n  clone = (opt_props, opt_opts) => {\n    return new WebAnnotation({ ...this.underlying, ...opt_props}, { ...this.opts, ...opt_opts });\n  }\n\n  /** An equality check based on the underlying object **/\n  isEqual(other) {\n    if (other?.type !== 'Annotation') {\n      return false;\n    } else if (this.underlying === other.underlying) {\n      return true;\n    } else if (!this.underlying.id || !other.underlying.id) {\n      return false;\n    } else {\n      return equals(this.underlying, other.underlying);\n    }\n  }\n\n  get readOnly() {\n    return this.opts?.readOnly;\n  }\n\n  /*************************************/ \n  /* Getters to forward properties of  */\n  /* the underlying annotation         */\n  /*************************************/\n\n  get id() {\n    return this.underlying.id; \n  }\n\n  get type() {\n    return this.underlying.type;\n  }\n\n  get motivation() {\n    return this.underlying.motivation;\n  }\n\n  get body() {\n    return this.underlying.body;\n  }\n\n  get target() {\n    return this.underlying.target;\n  }\n\n  /** Same as .body, but guaranteed to return an array **/\n  get bodies() {\n    return (Array.isArray(this.underlying.body)) ?\n      this.underlying.body : [ this.underlying.body ];\n  }\n\n  /** Only bodies are meant to be mutated by the application **/\n  set bodies(bodies) {\n    this.underlying.body = bodies;\n  }\n\n  /** Same as .target, but guaranteed to return an array **/\n  get targets() {\n    return (Array.isArray(this.underlying.target)) ?\n      this.underlying.target : [ this.underlying.target ];\n  }\n  \n  /*****************************************/ \n  /* Various access helpers and shorthands */\n  /*****************************************/\n\n  /** Selector of the given type **/\n  selector = type => {\n    const { target } = this.underlying;\n\n    if (target.selector) {\n      // Normalize to array\n      const selectors = Array.isArray(target.selector) ?\n        target.selector : [ target.selector ];\n\n      return selectors.find(s => s.type === type);\n    }\n  }\n\n  /** Shorthand for the 'exact' field of the TextQuoteSelector **/\n  get quote() {\n    return this.selector('TextQuoteSelector').exact;\n  }\n\n  /** Shorthand for the 'start' field of the TextPositionSelector **/\n  get start() {\n    return this.selector('TextPositionSelector').start;\n  }\n\n  /** Shorthand for the 'end' field of the TextPositionSelector **/\n  get end() {\n    return this.selector('TextPositionSelector').end;\n  }\n  \n}\n","import WebAnnotation from './WebAnnotation';\nimport { v4 as uuid } from 'uuid';\nimport equals from 'fast-deep-equal';\n\n/**\n * An \"annotation in draft mode\". Really the same\n * data structure, but as a separate class so we can\n * tell things apart properly.\n */\nexport default class Selection {\n\n  constructor(target, body) {\n    this.underlying = {\n      type: 'Selection',\n      body: body || [],\n      target\n    }\n  }\n\n  /** Creates a copy of this selection **/\n  clone = opt_props => {\n    // Deep-clone\n    const cloned = new Selection();\n    cloned.underlying = JSON.parse(JSON.stringify(this.underlying));  \n\n    if (opt_props)\n      cloned.underlying = { ...cloned.underlying, ...opt_props };\n\n    return cloned;\n  }\n\n  get type() {\n    return this.underlying.type;\n  }\n\n  get body() {\n    return this.underlying.body;\n  }\n\n  get target() {\n    return this.underlying.target;\n  }\n\n  get targets() {\n    return (Array.isArray(this.underlying.target)) ?\n      this.underlying.target : [ this.underlying.target ];\n  }\n\n  /** For consistency with WebAnnotation **/\n  isEqual(other) {\n    if (!other) {\n      return false;\n    } else {\n      return equals(this.underlying, other.underlying);\n    }\n  }\n  \n  get bodies() {\n    return (Array.isArray(this.underlying.body)) ?\n      this.underlying.body : [ this.underlying.body ];\n  }\n\n  selector = type => {\n    const { target } = this.underlying;\n\n    if (target.selector) {\n      // Normalize to array\n      const selectors = Array.isArray(target.selector) ?\n        target.selector : [ target.selector ];\n\n      return selectors.find(s => s.type === type);\n    }\n  }\n\n  /** Shorthand for the 'exact' field of the TextQuoteSelector **/\n  get quote() {\n    return this.selector('TextQuoteSelector').exact;\n  }\n\n  /*******************************************/ \n  /* Selection-specific properties & methods */\n  /*******************************************/\n\n  get isSelection() {\n    return true;\n  }\n\n  toAnnotation = () => {\n    const a = Object.assign({}, this.underlying, {\n      '@context': 'http://www.w3.org/ns/anno.jsonld',\n      'type': 'Annotation',\n      'id': `#${uuid()}`\n    });\n\n    return new WebAnnotation(a);\n  }\n\n}","import EventEmitter from 'tiny-emitter';\nimport { isTouchDevice } from '../util/Touch';\nimport { SVG_NAMESPACE } from '../util/SVG';\n\nconst IMPLEMENTATION_MISSING = \"An implementation is missing\";\n\nconst isTouch = isTouchDevice();\n\n/**\n * A commmon base class for Tools and EditableShapes\n */\nexport class ToolLike extends EventEmitter {\n\n  constructor(g, config, env) {\n    super();\n\n    this.svg = g.closest('svg');\n\n    this.g = g;\n    this.config = config;\n    this.env = env;\n\n    // Default image scale\n    this.scale = 1;\n\n    // Bit of a hack. If we are dealing with a 'real' image, we enable\n    // reponsive mode. OpenSeadragon handles scaling in a different way,\n    // so we don't need responsive mode.\n    const { image } = env;\n    if (image instanceof Element || image instanceof HTMLDocument)\n      this.enableResponsive();\n  }\n\n  /**\n   * Implementations MAY extend this (calling super),\n   * to destroy SVG elements, mask, etc.\n   */\n  destroy() {\n    if (this.resizeObserver)\n      this.resizeObserver.disconnect();\n\n    this.resizeObserver = null;\n  }\n\n  enableResponsive = () => {\n    if (window.ResizeObserver) {\n      this.resizeObserver = new ResizeObserver(() => {\n        const svgBounds = this.svg.getBoundingClientRect();\n        const { width, height } = this.svg.viewBox.baseVal;\n\n        this.scale = Math.max(\n          width / svgBounds.width,\n          height / svgBounds.height\n        );\n\n        if (this.onScaleChanged)\n          this.onScaleChanged(this.scale);\n      });\n\n      this.resizeObserver.observe(this.svg.parentNode);\n    }\n  }\n\n  getSVGPoint = evt => {\n    const pt = this.svg.createSVGPoint();\n\n    if (isTouch) {\n      const bbox = this.svg.getBoundingClientRect();\n\n      const x = evt.clientX - bbox.x;\n      const y = evt.clientY - bbox.y;\n\n      const { left, top } = this.svg.getBoundingClientRect();\n      pt.x = x + left;\n      pt.y = y + top;\n\n      return pt.matrixTransform(this.g.getScreenCTM().inverse());\n    } else {\n      pt.x = evt.offsetX;\n      pt.y = evt.offsetY;\n\n      return pt.matrixTransform(this.g.getCTM().inverse());\n    }\n  }\n\n  /*********************************/\n  /*  Helpers for drawing handles  */\n  /*********************************/\n\n  drawHandle = (x, y) => {\n    const containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n    containerGroup.setAttribute('class', 'a9s-handle');\n\n    const group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    const drawCircle = r => {\n      const c = document.createElementNS(SVG_NAMESPACE, 'circle');\n      c.setAttribute('cx', x);\n      c.setAttribute('cy', y);\n      c.setAttribute('r', r);\n      return c;\n    }\n\n    const radius = this.config.handleRadius || 6;\n\n    const inner = drawCircle(radius);\n    inner.setAttribute('class', 'a9s-handle-inner')\n\n    const outer = drawCircle(radius + 1);\n    outer.setAttribute('class', 'a9s-handle-outer')\n\n    group.appendChild(outer);\n    group.appendChild(inner);\n\n    containerGroup.appendChild(group);\n    return containerGroup;\n  }\n\n  setHandleXY = (handle, x, y) => {\n    const inner = handle.querySelector('.a9s-handle-inner');\n    inner.setAttribute('cx', x);\n    inner.setAttribute('cy', y);\n\n    const outer = handle.querySelector('.a9s-handle-outer');\n    outer.setAttribute('cx', x);\n    outer.setAttribute('cy', y);\n  }\n\n  getHandleXY = handle => {\n    const outer = handle.querySelector('.a9s-handle-outer');\n    return {\n      x: parseFloat(outer.getAttribute('cx')),\n      y: parseFloat(outer.getAttribute('cy'))\n    }\n  }\n\n  scaleHandle = handle => {\n    const inner = handle.querySelector('.a9s-handle-inner');\n    const outer = handle.querySelector('.a9s-handle-outer');\n\n    const radius = this.scale * (this.config.handleRadius || 6);\n\n    inner.setAttribute('r', radius);\n    outer.setAttribute('r', radius);\n  }\n\n}\n\n/**\n * Base class that adds some convenience stuff for tool plugins.\n */\nexport default class Tool extends ToolLike {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n\n    // We'll keep a flag set to false until\n    // the user has started moving, so we can\n    // fire the startSelection event\n    this.started = false;\n  }\n\n  attachListeners = ({ mouseMove, mouseUp, dblClick }) => {\n    // Handle SVG conversion on behalf of tool implementations\n    if (mouseMove) {\n      this.mouseMove = evt => {\n        const { x , y } = this.getSVGPoint(evt);\n\n        if (!this.started) {\n          this.emit('startSelection', { x, y });\n          this.started = true;\n        }\n\n        mouseMove(x, y, evt);\n      }\n\n      // Mouse move goes on SVG element\n      this.svg.addEventListener('mousemove', this.mouseMove);\n    }\n\n    if (mouseUp) {\n      this.mouseUp = evt => {\n        if (evt.button !== 0) return;  // left click\n        const { x , y } = this.getSVGPoint(evt);\n        mouseUp(x, y, evt);\n      }\n\n      // Mouse up goes on doc, so we capture events outside, too\n      document.addEventListener('mouseup', this.mouseUp);\n    }\n\n    if (dblClick) {\n      this.dblClick = evt => {\n        const { x , y } = this.getSVGPoint(evt);\n        dblClick(x, y, evt);\n      }\n\n      document.addEventListener('dblclick', this.dblClick);\n    }\n\n  }\n\n  detachListeners = () => {\n    if (this.mouseMove)\n      this.svg.removeEventListener('mousemove', this.mouseMove);\n\n    if (this.mouseUp)\n      document.removeEventListener('mouseup', this.mouseUp);\n\n    if (this.dblClick)\n      document.removeEventListener('dblclick', this.dblClick);\n  }\n\n  /**\n   * If startOnSingleClick is true, the tool starts on single click\n   * as well as drag. If false, starting strictly requires drag!\n   */\n  start = (evt, startOnSingleClick) => {\n    // Handle SVG conversion on behalf of tool implementations\n    const { x , y } = this.getSVGPoint(evt);\n    this.startDrawing(x, y, startOnSingleClick, evt);\n  }\n\n  /**\n   * Tool implementations MUST override these\n   */\n\n  get isDrawing() {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  startDrawing = evt => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  createEditableShape = annotation => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n}\n\n// In addition, Tool implementations need to implement the following static methods\n\n// Tool.identifier = '...'\n\nTool.supports = annotation => {\n  throw new Error(IMPLEMENTATION_MISSING);\n}\n\n// Just some convenience shortcuts to client-core, for quicker\n// importing in plugins. (In a way, the intention is to make the\n// Tool class serve as a kind of mini-SDK).\nexport { default as Selection } from '@recogito/recogito-client-core/src/Selection';\nexport { default as WebAnnotation } from '@recogito/recogito-client-core/src/WebAnnotation';\n","const SIM_EVENTS = {\n  touchstart: 'mousedown',\n  touchmove: 'mousemove',\n  touchend: 'mouseup'\n}\n\nexport const isTouchDevice = () =>\n  'ontouchstart' in window ||\n    navigator.maxTouchPoints > 0 ||\n      navigator.msMaxTouchPoints > 0;\n\nexport const enableTouchTranslation = el => {\n\n  let pressAndHoldTrigger = null;\n\n  const simulateEvent = (type, e) => new MouseEvent(type, {\n    screenX: e.screenX,\n    screenY: e.screenY,\n    clientX: e.clientX,\n    clientY: e.clientY,\n    pageX: e.pageX,\n    pageY: e.pageY,\n    bubbles: true\n  });\n\n  const touchHandler = evt => {\n    const touch = evt.changedTouches[0];\n    const simulatedEvent = simulateEvent(SIM_EVENTS[evt.type], touch);\n\n    touch.target.dispatchEvent(simulatedEvent);\n    evt.preventDefault();\n\n    if (evt.type === 'touchstart' || evt.type === 'touchmove') {\n      pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\n\n      pressAndHoldTrigger = setTimeout(() => {\n        const simulatedEvent = simulateEvent('dblclick', touch);\n        touch.target.dispatchEvent(simulatedEvent);\n      }, 800);\n    }\n\n    if (evt.type === 'touchend')\n      pressAndHoldTrigger && clearTimeout(pressAndHoldTrigger);\n  }\n\n  el.addEventListener('touchstart', touchHandler, true);\n  el.addEventListener('touchmove', touchHandler, true);\n  el.addEventListener('touchend', touchHandler, true);\n  el.addEventListener('touchcancel', touchHandler, true);\n\n}","import { ToolLike } from './Tool';\n\nconst IMPLEMENTATION_MISSING = \"An implementation is missing\";\n\nexport default class EditableShape extends ToolLike {\n\n  constructor(annotation, g, config, env) {\n    super(g, config, env);\n\n    this.annotation = annotation;\n  }\n  \n  /**\n   * Implementations MUST override this method!\n   * \n   * Must return the 'g' element with the a9s-annotation class.\n   */\n  get element() {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n  /**\n   * Implementations MUST override this method!\n   * \n   * The annotation argument MUST be used to update\n   * the current state of the shape. It MUST NOT\n   * be stored as 'this.annotation'! 'this.annotation'\n   * MUST remain the original annotation at the time\n   * this EditableShape was created, because we will\n   * need it again in case the user cancels editing.\n   * \n   * Thinking of it in React terms, 'this.annotation'\n   * has the same purpose as props.annotation, whereas\n   * this method affects state.\n   */\n  updateState = annotation => {\n    throw new Error(IMPLEMENTATION_MISSING);\n  }\n\n}\n","import { SVG_NAMESPACE } from '../util/SVG';\n\n/** Helper that forces an un-namespaced node to SVG **/\nconst insertSVGNamespace = originalDoc => {\n  // Serialize and parse for the namespace to take effect on every node\n  const serializer = new XMLSerializer();\n  const str = serializer.serializeToString(originalDoc.documentElement);\n\n  // Doesn't seem that there's a clean cross-browser way for this...\n  const namespaced = str.replace('<svg>', `<svg xmlns=\"${SVG_NAMESPACE}\">`);\n\n  const parser = new DOMParser();\n  const namespacedDoc = parser.parseFromString(namespaced, \"image/svg+xml\");\n  return namespacedDoc.documentElement;\n}\n\nconst sanitize = doc => {\n  // Cf. https://github.com/mattkrick/sanitize-svg#readme  \n  // for the basic approach\n  const cleanEl = el => {\n    Array.from(el.attributes).forEach(attr => {\n      if (attr.name.startsWith('on'))\n        el.removeAttribute(attr.name)\n    });\n  }\n\n  // Remove script tags\n  const scripts = doc.getElementsByTagName('script');\n  Array.from(scripts).reverse().forEach(el =>\n    el.parentNode.removeChild(el));\n\n  // Remove on... attributes\n  cleanEl(doc);\n  Array.from(doc.querySelectorAll('*')).forEach(cleanEl);\n\n  return doc;\n}\n\nexport const svgFragmentToShape = annotation => {\n  const selector = annotation.selector('SvgSelector');\n  if (selector) {\n    const parser = new DOMParser();\n\n    // Parse the XML document, assuming SVG\n    const { value } = selector;\n    const doc = parser.parseFromString(value, \"image/svg+xml\");\n\n    // SVG needs a namespace declaration - check if it's set or insert if not\n    const isPrefixDeclared = doc.lookupPrefix(SVG_NAMESPACE); // SVG declared via prefix\n    const isDefaultNamespaceSVG = doc.lookupNamespaceURI(null); // SVG declared as default namespace\n\n    if (isPrefixDeclared || isDefaultNamespaceSVG) {\n      return sanitize(doc).firstChild;\n    } else {\n      return sanitize(insertSVGNamespace(doc)).firstChild;\n    }\n  }\n}\n\nexport const drawEmbeddedSVG = annotation => {\n  const shape = svgFragmentToShape(annotation);\n\n  // Because we're nitpicky, we don't just draw the shape,\n  // but duplicate it, so we can have inner and an outer lines\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n  const inner = shape.cloneNode(true);\n  inner.setAttribute('class', 'a9s-inner');\n\n  const outer = shape.cloneNode(true);\n  outer.setAttribute('class', 'a9s-outer');\n\n  g.appendChild(outer);\n  g.appendChild(inner);\n\n  return g;\n}\n\nexport const toSVGTarget = (shape, image) => {\n  const inner = shape.querySelector('.a9s-inner').cloneNode(true);\n  inner.removeAttribute('class');\n  inner.removeAttribute('xmlns');\n\n  let serialized = inner.outerHTML || new XMLSerializer().serializeToString(inner);\n  serialized = serialized.replace(` xmlns=\"${SVG_NAMESPACE}\"`, '');\n\n  return {\n    source: image?.src,\n    selector: {\n      type: \"SvgSelector\",\n      value: `<svg>${serialized}</svg>`\n    }\n  }\n}\n\nexport const svgArea = annotation => {\n  const shape = svgFragmentToShape(annotation);\n  const nodeName = shape.nodeName.toLowerCase();\n\n  if (nodeName === 'polygon') \n    return polygonArea(shape);\n  else if (nodeName === 'circle')\n    return circleArea(shape);\n  else if (nodeName === 'ellipse')\n    return ellipseArea(shape);\n  else if (nodeName == 'path')\n    return pathArea(shape);\n  else\n    throw `Unsupported SVG shape type: ${nodeName}`;\n}\n\nconst polygonArea = polygon => {\n  const points = polygon.getAttribute('points')\n    .split(' ') // Split x/y tuples\n    .map(xy => xy.split(',').map(str => parseFloat(str.trim())));\n\n  let area = 0;\n  let j = points.length - 1;\n\n  for (let i=0; i < points.length; i++) {\n    area += (points[j][0] + points[i][0]) * (points[j][1] - points[i][1]);\n    j = i;\n  }\n\n  return Math.abs(0.5 * area);\n}\n\nconst circleArea = circle => {\n  const r = circle.getAttribute('r');\n  return r * r * Math.PI;\n}\n\nconst ellipseArea = ellipse => {\n  const rx = ellipse.getAttribute('rx');\n  const ry = ellipse.getAttribute('ry');\n  return rx * ry * Math.PI;\n}\n\nconst pathArea = path => {\n  const pointList = path.getAttribute('d').split('L');\n  let area = 0;\n\n  if(pointList.length > 1) {\n    var point = pointList[pointList.length - 1].trim().split(' ');\n    let lastX = parseFloat(point[0]);\n    let lastY = parseFloat(point[1]);\n\n    point = pointList[0].substring(1).trim().split(' ');\n    let x = parseFloat(point[0]);\n    let y = parseFloat(point[1]);\n    area += (lastX + x) * (lastY - y);\n    lastX = x;\n    lastY = y;\n\n    for (let i = 1; i < pointList.length; i++) {\n      point = pointList[i].trim().split(' ');\n      x = parseFloat(point[0]);\n      y = parseFloat(point[1]);\n      area += (lastX + x) * (lastY - y);\n      lastX = x;\n      lastY = y;\n    }\n  }\n\n  return Math.abs(0.5 * area);\n}","/** Computes the length of a vector **/\nexport const len = (xy1, xy2) => \n  xy2 ? \n    // Treat input as two vectors and compute length of result vector\n    Math.sqrt(Math.pow(xy2[0] - xy1[0], 2) + Math.pow(xy2[1] - xy1[1], 2)) :\n\n    // Treat input as a vector\n    Math.sqrt(Math.pow(xy1[0], 2) + Math.pow(xy1[1], 2));\n\n/** Returns the vector between two points **/\nexport const vec = (terminal, starting) => \n  [ terminal[0] - starting[0], terminal[1] - starting [1] ];\n\n/** Rounds the vector coordinates to the given decimal placs **/\nexport const round = (vec, decimalPlaces) => {\n  const factor = Math.pow(10, decimalPlaces || 0);\n  return [\n    Math.round(vec[0] * factor) / factor,\n    Math.round(vec[1] * factor) / factor\n  ];\n}\n/** Returns true if the vectors are equal **/\nexport const eq = (xy1, xy2) => \n  xy1[0] === xy2[0] && xy1[1] === xy2[1];\n\n/** Normalizes a vector to length = 1 **/\nexport const normalize = xy => {\n  var l = Math.max(len(xy), 0.00001); // Prevent div by zero\n  return [ xy[0] / l, xy[1] / l ];\n}\n\n/** Computes the angle between two vectors **/\nexport const angleBetween = (a, b) => {\n  const dotProduct = a[0] * b[0] + a[1] * b[1];\n  return Math.acos(dotProduct);\n}\n\nexport const angleOf = xy =>\n  Math.atan2(xy[1], xy[0]);\n\n/** Adds two vectors */\nexport const add = (a, b) =>\n  [ a[0] + b[0], a[1] + b[1]  ];\n\nexport const mult = (vec, factor) =>\n  [ factor * vec[0], factor * vec[1] ];\n","import { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\n\n/** Common to all SVG shapes: draw group with inner + outer **/\nconst createElement = elem => {\n  const g = document.createElementNS(SVG_NAMESPACE, 'g');\n\n  const outer = document.createElementNS(SVG_NAMESPACE, elem);\n  outer.setAttribute('class', 'a9s-outer');\n\n  const inner =  document.createElementNS(SVG_NAMESPACE, elem);\n  inner.setAttribute('class', 'a9s-inner');\n\n  g.appendChild(outer);\n  g.appendChild(inner);\n\n  return g;\n}\n\nexport const createBaseline = (optA, optB) => {\n  const g = createElement('line');\n  g.setAttribute('class', 'a9s-tilted-box-baseline');\n\n  if (optA && optB) \n    setBaseline(g, optA, optB);\n\n  return g;\n}\n\nexport const createBox = optPoints => {\n  const g = createElement('polygon');\n  \n  if (optPoints)\n    setBoxPoints(g, optPoints);\n\n  return g;\n}\n\nexport const setBaseline = (g, from, to) => {\n\n  const setCoords = line => {\n    line.setAttribute('x1', from[0]);\n    line.setAttribute('y1', from[1]);\n    line.setAttribute('x2', to[0]);\n    line.setAttribute('y2', to[1]);  \n  }\n\n  const inner = g.querySelector('.a9s-inner');\n  setCoords(inner);\n\n  const outer = g.querySelector('.a9s-outer');\n  setCoords(outer);\n}\n\nexport const setBoxPoints = (g, points) => {\n  const attr = points.map(xy => xy.join(',')).join(' ');\n\n  const inner = g.querySelector('.a9s-inner');\n  inner.setAttribute('points', attr);\n\n  const outer = g.querySelector('.a9s-outer');\n  outer.setAttribute('points', attr);\n}\n\nexport const getBoxPoints = g =>\n  g.querySelector('.a9s-inner').getAttribute('points')\n    .split(' ')\n    .map(t => t.split(',').map(num => parseFloat(num)));\n\nexport const createMinorHandle = (xy, handleRadius) => {\n  // Make this 80% smaller than the configured handle radius\n  const radius = Math.round((handleRadius || 6) * 0.8);\n\n  const c = document.createElementNS(SVG_NAMESPACE, 'circle');\n  c.setAttribute('class', 'a9s-minor-handle');\n  c.setAttribute('cx', xy[0]);\n  c.setAttribute('cy', xy[1]);\n  c.setAttribute('r', radius);\n  return c;\n}","import EditableShape from '@recogito/annotorious/src/tools/EditableShape';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\nimport { svgFragmentToShape, toSVGTarget } from '@recogito/annotorious/src/selectors';\n\nimport * as Geom2D from './Geom2D';\nimport {\n  createBaseline,\n  createBox,\n  createMinorHandle,\n  getBoxPoints,\n  setBaseline,\n  setBoxPoints\n} from './TiltedBox';\n\nconst getBBox = shape =>\n  shape.querySelector('.a9s-inner').getBBox();\n\nexport default class EditableTiltedBox extends EditableShape {\n\n  constructor(annotation, g, config, env) {\n    super(annotation, g, config, env);\n\n    this.svg.addEventListener('mousemove', this.onMouseMove);\n    this.svg.addEventListener('mouseup', this.onMouseUp);\n\n    const points = svgFragmentToShape(annotation)\n      .getAttribute('points')\n      .split(' ')\n      .map(t => t.split(',').map(num => parseFloat(num)));\n\n    // Shorthand\n    const [ a, b, c, _ ] = points;\n\n    // 'g' for the compound shape (and mask -  in the future)\n    this.containerGroup = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    // The 'element' (baseline, box, handles)\n    this._element = document.createElementNS(SVG_NAMESPACE, 'g');\n    this._element.setAttribute('class', 'a9s-annotation tilted-box editable selected');\n\n    this.box = createBox(points);\n    this.box.querySelector('.a9s-inner')\n      .addEventListener('mousedown', this.onGrab(this.box));\n\n    this.baseline = createBaseline(a, b); \n    \n    this.pivotHandle = this.drawHandle(a[0], a[1]);\n    this.baseEndHandle = createMinorHandle(b, config.handleRadius);\n    this.oppositeHandle = createMinorHandle(c, config.handleRadius);\n\n    [this.pivotHandle, this.baseEndHandle, this.oppositeHandle].map(elem => {\n      elem.addEventListener('mousedown', this.onGrab(elem));\n    });\n\n    this._element.appendChild(this.box);\n    this._element.appendChild(this.baseline);\n    this._element.appendChild(this.pivotHandle);\n    this._element.appendChild(this.baseEndHandle);\n    this._element.appendChild(this.oppositeHandle);\n\n    this.containerGroup.appendChild(this._element);\n\n    g.appendChild(this.containerGroup);\n\n    // The grabbed element (handle or entire group), if any\n    this.grabbedElem = null;\n\n    // Mouse grab point\n    this.grabbedAt = null;\n  }\n\n  setShape = points => {\n    setBoxPoints(this.box, points);\n    setBaseline(this.baseline, points[0], points[1]);\n\n    this.baseEndHandle.setAttribute('cx', points[1][0]);\n    this.baseEndHandle.setAttribute('cy', points[1][1]);\n\n    this.oppositeHandle.setAttribute('cx', points[2][0]);\n    this.oppositeHandle.setAttribute('cy', points[2][1]);\n\n    this.setHandleXY(this.pivotHandle, points[0][0], points[0][1]);\n  }\n\n  setBaseEnd = xy => {\n    const [ a, b, currentC, _ ] = getBoxPoints(this.box);\n\n    const isClockwise = () => {\n      const base = Geom2D.round(Geom2D.normalize(Geom2D.vec(b, a)), 5);\n      const height = Geom2D.round(Geom2D.normalize(Geom2D.vec(currentC, b)), 5);\n  \n      return Geom2D.eq([ -base[1], base[0] ], height);\n    }\n\n    // Current box height\n    const height = Geom2D.len(b, currentC);\n    \n    const updatedBase = Geom2D.vec(xy, a);\n    const updatedNorm = Geom2D.normalize([ -updatedBase[1], updatedBase[0] ]);\n    const updatedHeight = isClockwise() ? Geom2D.mult(updatedNorm, height) : Geom2D.mult(updatedNorm, -height);\n\n    const c = Geom2D.add(xy, updatedHeight)\n    const d = Geom2D.add(a, updatedHeight);\n\n    this.setShape([ a, xy, c, d ]);\n  }\n\n  setOppositeCorner = xy => {\n    const [ a, b, ..._ ] = getBoxPoints(this.box);\n\n    // Baseline normal (len = 1)\n    const baseline = Geom2D.vec(b, a);\n    const normal = Geom2D.normalize([ - baseline[1], baseline[0] ]);\n\n    // Vector baseline end -> mouse\n    const toMouse = Geom2D.vec(xy, b);\n\n    // Projection of toMouse onto normal\n    const f = [\n      normal[0] * Geom2D.len(toMouse) * Math.cos(Geom2D.angleBetween(normal, Geom2D.normalize(toMouse))),\n      normal[1] * Geom2D.len(toMouse) * Math.cos(Geom2D.angleBetween(normal, Geom2D.normalize(toMouse)))\n    ];\n\n    const c = Geom2D.add(b, f);\n    const d = Geom2D.add(a, f);\n\n    this.setShape([ a, b, c, d ]);\n  }\n\n  onScaleChanged = scale => {\n    // Pivot\n    const inner = this.pivotHandle.querySelector('.a9s-handle-inner');\n    const outer = this.pivotHandle.querySelector('.a9s-handle-outer');\n\n    const radius = scale * (this.config.handleRadius || 6);\n\n    inner.setAttribute('r', radius);\n    outer.setAttribute('r', radius);\n\n    // Minor handles\n    const minorRadius = Math.round(0.8 * radius);\n    this.baseEndHandle.setAttribute('r', minorRadius);\n    this.oppositeHandle.setAttribute('r', minorRadius);\n  }\n\n  onGrab = grabbedElem => evt => {\n    if (evt.button !== 0) return;  // left click\n    this.grabbedElem = grabbedElem;\n    this.grabbedAt = this.getSVGPoint(evt);\n  }\n\n  onMouseMove = evt => {\n    const constrain = (coord, delta, max) =>\n      coord + delta < 0 ? -coord : (coord + delta > max ? max - coord : delta);\n\n    if (this.grabbedElem) {\n      const pos = this.getSVGPoint(evt);\n\n      if (this.grabbedElem === this.box || this.grabbedElem === this.pivotHandle) {\n        const { x, y, width, height } = getBBox(this.box);\n\n        const { naturalWidth, naturalHeight } = this.env.image;\n\n        const dx = constrain(x, pos.x - this.grabbedAt.x, naturalWidth - width);\n        const dy = constrain(y, pos.y - this.grabbedAt.y, naturalHeight - height);\n\n        const updatedPoints = getBoxPoints(this.box).map(pt => [ pt[0] + dx, pt[1] + dy ]);\n\n        this.setShape(updatedPoints);        \n      } else if (this.grabbedElem === this.baseEndHandle) {\n        this.setBaseEnd([ pos.x, pos.y ]);\n      } else if (this.grabbedElem === this.oppositeHandle) {\n        this.setOppositeCorner([ pos.x, pos.y ]);\n      }\n\n      this.grabbedAt = pos;\n\n      this.emit('update', {\n        ...toSVGTarget(this.box, this.env.image),\n        renderedVia: {\n          name: 'annotorious-tilted-box'\n        }\n      });\n    }\n  }\n\n  onMouseUp = () => {\n    this.grabbedElem = null;\n    this.grabbedAt = null;\n  }\n\n  get element() {\n    return this._element;\n  }\n\n  updateState = annotation => {\n    const points = svgFragmentToShape(annotation)\n      .getAttribute('points')\n      .split(' ')\n      .map(t => t.split(',').map(num => parseFloat(num)));\n    \n    this.setShape(points);\n  }\n\n  destroy() {\n    this.containerGroup.parentNode.removeChild(this.containerGroup);\n    super.destroy();\n  }\n\n}","import { Selection, ToolLike } from '@recogito/annotorious/src/tools/Tool';\nimport { SVG_NAMESPACE } from '@recogito/annotorious/src/util/SVG';\n\nimport * as Geom2D from './Geom2D';\nimport { \n  createBaseline, \n  createBox,\n  setBaseline,\n  setBoxPoints\n} from './TiltedBox';\n\nconst polygonBounds = points => {\n  return { w: 100, h: 100 };\n}\n\nexport default class TiltedBox extends ToolLike {\n\n  constructor(points, g, config, env) {\n    super(g, config, env);\n\n    this.points = points;\n\n    const [ a, b, ..._ ] = points;\n\n    this.group = document.createElementNS(SVG_NAMESPACE, 'g');\n\n    this.element = document.createElementNS(SVG_NAMESPACE, 'g');\n    this.element.setAttribute('class', 'a9s-selection tilted-box');\n    \n    this.baseline = createBaseline();\n    this.tiltedbox = createBox();\n\n    this.pivot = this.drawHandle(0, 0);\n\n    this.setPoints(points);\n\n    // We make the selection transparent to \n    // pointer events because it would interfere with the \n    // rendered annotations' mouseleave/enter events\n    this.element.style.pointerEvents = 'none';\n\n    this.element.appendChild(this.tiltedbox);\n    this.element.appendChild(this.baseline);\n    this.element.appendChild(this.pivot);\n\n    this.group.appendChild(this.element);\n\n    g.appendChild(this.group);\n  }\n  \n  scalePivot = scale => {\n    const inner = this.pivot.querySelector('.a9s-handle-inner');\n    const outer = this.pivot.querySelector('.a9s-handle-outer');\n\n    const radius = scale * (this.config.handleRadius || 6);\n\n    inner.setAttribute('r', radius);\n    outer.setAttribute('r', radius);\n  }\n\n  get isCollapsed() {\n    const { w, h } = polygonBounds(this.points);\n    return w * h < 9;\n  }\n\n  setPoints = points => {\n    this.points = points; \n\n    const [ a, b, ..._ ] = points;\n\n    setBaseline(this.baseline, a, b);\n    setBoxPoints(this.tiltedbox, points);\n\n    this.setHandleXY(this.pivot, a[0], a[1]);\n  } \n  \n  setBaseEnd = (x, y) => {\n    const a = this.points[0];\n    const b = [ x, y ];\n    this.setPoints([ a, b, b, a ]);\n  }\n\n  extrude = (pointerX, pointerY) => {\n    const [ a, b, ..._] = this.points;\n\n    // Baseline normal (len = 1)\n    const baseline = Geom2D.vec(b, a);\n    const normal = Geom2D.normalize([ - baseline[1], baseline[0] ]);\n\n    // Vector baseline end -> mouse\n    const toMouse = Geom2D.vec([ pointerX, pointerY ], b);\n\n    // Projection of toMouse onto normal\n    const f = [\n      normal[0] * Geom2D.len(toMouse) * Math.cos(Geom2D.angleBetween(normal, Geom2D.normalize(toMouse))),\n      normal[1] * Geom2D.len(toMouse) * Math.cos(Geom2D.angleBetween(normal, Geom2D.normalize(toMouse)))\n    ];\n\n    const c = Geom2D.add(b, f);\n    const d = Geom2D.add(a, f);\n\n    this.setPoints([ a, b, c, d ]);\n  }\n\n  toSelection = source => {\n    const points = this.tiltedbox.querySelector('.a9s-inner').getAttribute('points');\n \n    return new Selection({ \n      source,\n      selector: {\n        type: 'SvgSelector',\n        value: `<svg><polygon points=\"${points}\" /></svg>`,\n      },\n      renderedVia: {\n        name: 'annotorious-tilted-box'\n      }\n    });\n  }\n\n  destroy = () => {\n    this.group.parentNode.removeChild(this.group);\n\n    this.element = null;\n    this.group = null;\n  }\n\n}","import api from \"!../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../node_modules/css-loader/dist/cjs.js!../node_modules/sass-loader/dist/cjs.js!./TiltedBoxTool.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","import Tool from '@recogito/annotorious/src/tools/Tool';\nimport EditableTiltedBox from './EditableTiltedBox';\nimport RubberbandTiltedBox from './RubberbandTiltedBox';\n\nimport './TiltedBoxTool.scss';\n\nexport default class TiltedBoxTool extends Tool {\n\n  constructor(g, config, env) {\n    super(g, config, env);\n    \n    this.drawingState = null;\n\n    this.rubberbandShape = null;\n  }\n\n  onScaleChanged = scale => \n    this.rubberbandShape?.scalePivot(scale);\n\n  startDrawing = (x, y, _) => {\n    this.attachListeners({\n      mouseMove: this.onMouseMove,\n      mouseUp: this.onMouseUp\n    });\n\n    this.drawingState = 'BASELINE';\n\n    this.rubberbandShape = new RubberbandTiltedBox([\n      [ x, y ],\n      [ x, y ],\n      [ x, y ],\n      [ x, y ]\n    ], this.g, this.config, this.env);\n  }\n\n  onMouseMove = (x, y) => {\n    if (this.drawingState === 'BASELINE')\n      this.rubberbandShape.setBaseEnd(x, y);\n    else if (this.drawingState === 'EXTRUDE')\n      this.rubberbandShape.extrude(x, y);\n  }\n  \n  onMouseUp = () => {\n    if (this.drawingState === 'BASELINE') {\n      if (this.rubberbandShape.isCollapsed) {\n        this.emit('cancel');\n        this.stop();\n      } else {\n        this.drawingState = 'EXTRUDE'\n      }\n    } else if (this.drawingState === 'EXTRUDE') {\n      const shape = this.rubberbandShape.element;\n      shape.annotation = this.rubberbandShape.toSelection(this.env.image.src);\n      this.emit('complete', shape);\n      this.stop();\n    }\n  }\n\n  stop = () => {\n    this.detachListeners();\n    this.drawingState = null;\n    \n    if (this.rubberbandShape) {\n      this.rubberbandShape.destroy();\n      this.rubberbandShape = null;\n    }\n  }\n\n  get isDrawing() {\n    return this.drawingState != null;\n  }\n\n  createEditableShape = annotation =>\n    new EditableTiltedBox(annotation, this.g, this.config, this.env);\n\n}\n\nTiltedBoxTool.identifier = 'annotorious-tilted-box';\n\nTiltedBoxTool.supports = annotation => false;\n","import TiltedBoxTool from './TiltedBoxTool';\n\nconst TiltedBoxPlugin = anno => {\n\n  anno.addDrawingTool(TiltedBoxTool);\n  \n}\n\nexport default TiltedBoxPlugin;"]},"metadata":{},"sourceType":"script"}