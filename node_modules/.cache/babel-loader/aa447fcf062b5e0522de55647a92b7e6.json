{"ast":null,"code":"import axios from 'axios';\nexport default {\n  ADD_FILES(state, files) {\n    Object.assign(state.case.files, files);\n\n    for (let key in files) {\n      state.case.fileOrder.push(parseInt(key));\n    }\n  },\n\n  UPDATE_FILE(state, {\n    id,\n    title,\n    stains\n  }) {\n    state.case.files[id].title = title;\n    state.case.files[id].stains = stains;\n  },\n\n  UPDATE_FILE_META(state, {\n    id,\n    meta,\n    stains\n  }) {\n    state.case.files[id].meta_data = meta;\n\n    if (stains) {\n      state.case.files[id].stains = stains;\n    }\n  },\n\n  PUT_TO_DELETE_QUEUE(state, {\n    caseId,\n    fileId,\n    title,\n    timer\n  }) {\n    state.filesDeleteQueue = { ...state.filesDeleteQueue,\n      [fileId]: {\n        caseId,\n        title,\n        timer\n      }\n    };\n  },\n\n  REMOVE_FROM_DELETE_QUEUE(state, id) {\n    if (state.filesDeleteQueue[id]) clearTimeout(state.filesDeleteQueue[id].timer);\n    const queue = { ...state.filesDeleteQueue\n    };\n    delete queue[id];\n    state.filesDeleteQueue = queue;\n  },\n\n  DELETE_FILE(state, id) {\n    if (state.case.files[id]) {\n      // Hack for clearing draggable slot caching\n      const files = { ...state.case.files\n      };\n      delete files[id];\n      state.case.files = { ...files\n      };\n    }\n\n    state.case.fileOrder = state.case.fileOrder.filter(fileId => id !== fileId);\n  },\n\n  START_UPLOADING_FILE(state, file) {\n    let uniqueIdentifier = file.options.fingerprint(file.file, file.options);\n    let fileName = file.file.name;\n    let fileSize = file.file.size;\n    let numOfChuncks = fileSize / 10000;\n\n    if (!state.case.files.hasOwnProperty(uniqueIdentifier)) {\n      state.case.files = { ...state.case.files,\n        [uniqueIdentifier]: {\n          id: uniqueIdentifier,\n          title: fileName,\n          progress: 0,\n          size: fileSize,\n          numOfChuncks: numOfChuncks,\n          type: 'uploading'\n        }\n      };\n      state.case.fileOrder.unshift(uniqueIdentifier);\n    }\n  },\n\n  PROGRESS_UPLOADING_FILE(state, {\n    percentComplete,\n    uniqueIdentifier\n  }) {\n    state.case.files[uniqueIdentifier].progress = percentComplete;\n  },\n\n  CANCEL_UPLOADING_FILE(state, file) {\n    let uniqueIdentifier = file.options.fingerprint(file.file, file.options);\n    state.case.fileOrder.splice(state.case.fileOrder.indexOf(uniqueIdentifier), 1);\n    const files = { ...state.case.files\n    };\n    delete files[uniqueIdentifier];\n    state.case.files = files;\n\n    if (file.url) {\n      axios.delete(file.url, {\n        headers: {\n          'Tus-Resumable': '1.0.0',\n          'Content-Length': 0\n        }\n      }).then(({\n        data\n      }) => {\n        console.log(data);\n      });\n    }\n  },\n\n  SUCCESS_UPLOADING_FILE(state, {\n    uniqueIdentifier,\n    id,\n    fileName,\n    caseId\n  }) {\n    const files = { ...state.case.files\n    };\n    const file = {\n      id: id,\n      title: fileName,\n      type: 'uploading',\n      case_id: caseId\n    };\n    delete files[uniqueIdentifier];\n    state.case.fileOrder.splice(state.case.fileOrder.indexOf(uniqueIdentifier), 1);\n    files[id] = file;\n    state.case.files = { ...files\n    };\n    state.case.fileOrder.unshift(id);\n  },\n\n  FINALIZE_UPLOAD(state, msg) {\n    const files = { ...state.case.files\n    };\n    let id = msg.file.id;\n\n    if (msg.file.type_data && msg.file.type_data.original_file_id) {\n      files[msg.file.type_data.original_file_id] = {};\n      delete files[msg.file.type_data.original_file_id];\n      id = msg.file.type_data.original_file_id;\n    } else {\n      files[msg.file.id] = {};\n      delete files[msg.file.id];\n    }\n\n    state.case.fileOrder.splice(state.case.fileOrder.indexOf(id), 1);\n    files[msg.file.id] = msg.file;\n    state.case.files = { ...files\n    };\n    state.case.fileOrder.unshift(msg.file.id);\n  }\n\n}; // WEBPACK FOOTER //\n// ./src/store/mutations/files.js","map":{"version":3,"names":["axios","ADD_FILES","state","files","Object","assign","case","key","fileOrder","push","parseInt","UPDATE_FILE","id","title","stains","UPDATE_FILE_META","meta","meta_data","PUT_TO_DELETE_QUEUE","caseId","fileId","timer","filesDeleteQueue","REMOVE_FROM_DELETE_QUEUE","clearTimeout","queue","DELETE_FILE","filter","START_UPLOADING_FILE","file","uniqueIdentifier","options","fingerprint","fileName","name","fileSize","size","numOfChuncks","hasOwnProperty","progress","type","unshift","PROGRESS_UPLOADING_FILE","percentComplete","CANCEL_UPLOADING_FILE","splice","indexOf","url","delete","headers","then","data","console","log","SUCCESS_UPLOADING_FILE","case_id","FINALIZE_UPLOAD","msg","type_data","original_file_id"],"sources":["C:/Users/Danil/Desktop/122/src/store/mutations/files.js"],"sourcesContent":["import axios from 'axios'\r\n\r\nexport default {\r\n  ADD_FILES (state, files) {\r\n    Object.assign(state.case.files, files)\r\n    for (let key in files) {\r\n      state.case.fileOrder.push(parseInt(key))\r\n    }\r\n  },\r\n  UPDATE_FILE (state, { id, title, stains }) {\r\n    state.case.files[id].title = title\r\n    state.case.files[id].stains = stains\r\n  },\r\n  UPDATE_FILE_META (state, { id, meta, stains }) {\r\n    state.case.files[id].meta_data = meta\r\n    if (stains) {\r\n      state.case.files[id].stains = stains\r\n    }\r\n  },\r\n  PUT_TO_DELETE_QUEUE (state, { caseId, fileId, title, timer }) {\r\n    state.filesDeleteQueue = {...state.filesDeleteQueue, [fileId]: { caseId, title, timer }}\r\n  },\r\n  REMOVE_FROM_DELETE_QUEUE (state, id) {\r\n    if (state.filesDeleteQueue[id]) clearTimeout(state.filesDeleteQueue[id].timer)\r\n    const queue = { ...state.filesDeleteQueue }\r\n    delete queue[id]\r\n    state.filesDeleteQueue = queue\r\n  },\r\n  DELETE_FILE (state, id) {\r\n    if (state.case.files[id]) {\r\n      // Hack for clearing draggable slot caching\r\n      const files = {...state.case.files}\r\n      delete files[id]\r\n      state.case.files = {...files}\r\n    }\r\n    state.case.fileOrder = state.case.fileOrder.filter(fileId => id !== fileId)\r\n  },\r\n  START_UPLOADING_FILE (state, file) {\r\n    let uniqueIdentifier = file.options.fingerprint(file.file, file.options)\r\n    let fileName = file.file.name\r\n    let fileSize = file.file.size\r\n    let numOfChuncks = fileSize / 10000\r\n    if (!state.case.files.hasOwnProperty(uniqueIdentifier)) {\r\n      state.case.files = {\r\n        ...state.case.files,\r\n        [uniqueIdentifier]: {\r\n          id: uniqueIdentifier,\r\n          title: fileName,\r\n          progress: 0,\r\n          size: fileSize,\r\n          numOfChuncks: numOfChuncks,\r\n          type: 'uploading'\r\n        }\r\n      }\r\n      state.case.fileOrder.unshift(uniqueIdentifier)\r\n    }\r\n  },\r\n  PROGRESS_UPLOADING_FILE (state, { percentComplete, uniqueIdentifier }) {\r\n    state.case.files[uniqueIdentifier].progress = percentComplete\r\n  },\r\n  CANCEL_UPLOADING_FILE (state, file) {\r\n    let uniqueIdentifier = file.options.fingerprint(file.file, file.options)\r\n    state.case.fileOrder.splice(state.case.fileOrder.indexOf(uniqueIdentifier), 1)\r\n    const files = { ...state.case.files }\r\n    delete files[uniqueIdentifier]\r\n    state.case.files = files\r\n    if (file.url) {\r\n      axios.delete(file.url,\r\n        {\r\n          headers: {\r\n            'Tus-Resumable': '1.0.0',\r\n            'Content-Length': 0\r\n          }\r\n        }).then(({data}) => {\r\n          console.log(data)\r\n        })\r\n    }\r\n  },\r\n  SUCCESS_UPLOADING_FILE (state, { uniqueIdentifier, id, fileName, caseId }) {\r\n    const files = {...state.case.files}\r\n    const file = {\r\n      id: id,\r\n      title: fileName,\r\n      type: 'uploading',\r\n      case_id: caseId\r\n    }\r\n    delete files[uniqueIdentifier]\r\n    state.case.fileOrder.splice(state.case.fileOrder.indexOf(uniqueIdentifier), 1)\r\n    files[id] = file\r\n    state.case.files = {...files}\r\n    state.case.fileOrder.unshift(id)\r\n  },\r\n  FINALIZE_UPLOAD (state, msg) {\r\n    const files = {...state.case.files}\r\n    let id = msg.file.id\r\n    if (msg.file.type_data && msg.file.type_data.original_file_id) {\r\n      files[msg.file.type_data.original_file_id] = {}\r\n      delete files[msg.file.type_data.original_file_id]\r\n      id = msg.file.type_data.original_file_id\r\n    } else {\r\n      files[msg.file.id] = {}\r\n      delete files[msg.file.id]\r\n    }\r\n    state.case.fileOrder.splice(state.case.fileOrder.indexOf(id), 1)\r\n    files[msg.file.id] = msg.file\r\n    state.case.files = {...files}\r\n    state.case.fileOrder.unshift(msg.file.id)\r\n  }\r\n}\r\n\r\n\r\n\r\n// WEBPACK FOOTER //\r\n// ./src/store/mutations/files.js"],"mappings":"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"},"metadata":{},"sourceType":"module"}