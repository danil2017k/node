{"ast":null,"code":"const max = 65536;\nconst cache = {}; // in node 6 Buffer.subarray returns a Uint8Array instead of a Buffer\n// later versions return a Buffer\n// alternative is Buffer.slice but that creates a new buffer\n// creating new buffers takes time\n// SubOk is only false on node < 8\n\nconst SubOk = Buffer.isBuffer(Buffer.from([1, 2]).subarray(0, 1));\n\nfunction generateBuffer(i) {\n  const buffer = Buffer.allocUnsafe(2);\n  buffer.writeUInt8(i >> 8, 0);\n  buffer.writeUInt8(i & 0x00FF, 0 + 1);\n  return buffer;\n}\n\nfunction generateCache() {\n  for (let i = 0; i < max; i++) {\n    cache[i] = generateBuffer(i);\n  }\n}\n\nfunction genBufVariableByteInt(num) {\n  const maxLength = 4; // max 4 bytes\n\n  let digit = 0;\n  let pos = 0;\n  const buffer = Buffer.allocUnsafe(maxLength);\n\n  do {\n    digit = num % 128 | 0;\n    num = num / 128 | 0;\n    if (num > 0) digit = digit | 0x80;\n    buffer.writeUInt8(digit, pos++);\n  } while (num > 0 && pos < maxLength);\n\n  if (num > 0) {\n    pos = 0;\n  }\n\n  return SubOk ? buffer.subarray(0, pos) : buffer.slice(0, pos);\n}\n\nfunction generate4ByteBuffer(num) {\n  const buffer = Buffer.allocUnsafe(4);\n  buffer.writeUInt32BE(num, 0);\n  return buffer;\n}\n\nmodule.exports = {\n  cache,\n  generateCache,\n  generateNumber: generateBuffer,\n  genBufVariableByteInt,\n  generate4ByteBuffer\n};","map":{"version":3,"names":["max","cache","SubOk","Buffer","isBuffer","from","subarray","generateBuffer","i","buffer","allocUnsafe","writeUInt8","generateCache","genBufVariableByteInt","num","maxLength","digit","pos","slice","generate4ByteBuffer","writeUInt32BE","module","exports","generateNumber"],"sources":["C:/Users/Danil/Desktop/project1/node_modules/mqtt-packet/numbers.js"],"sourcesContent":["const max = 65536\nconst cache = {}\n\n// in node 6 Buffer.subarray returns a Uint8Array instead of a Buffer\n// later versions return a Buffer\n// alternative is Buffer.slice but that creates a new buffer\n// creating new buffers takes time\n// SubOk is only false on node < 8\nconst SubOk = Buffer.isBuffer(Buffer.from([1, 2]).subarray(0, 1))\n\nfunction generateBuffer (i) {\n  const buffer = Buffer.allocUnsafe(2)\n  buffer.writeUInt8(i >> 8, 0)\n  buffer.writeUInt8(i & 0x00FF, 0 + 1)\n\n  return buffer\n}\n\nfunction generateCache () {\n  for (let i = 0; i < max; i++) {\n    cache[i] = generateBuffer(i)\n  }\n}\n\nfunction genBufVariableByteInt (num) {\n  const maxLength = 4 // max 4 bytes\n  let digit = 0\n  let pos = 0\n  const buffer = Buffer.allocUnsafe(maxLength)\n\n  do {\n    digit = num % 128 | 0\n    num = num / 128 | 0\n    if (num > 0) digit = digit | 0x80\n\n    buffer.writeUInt8(digit, pos++)\n  } while (num > 0 && pos < maxLength)\n\n  if (num > 0) {\n    pos = 0\n  }\n\n  return SubOk ? buffer.subarray(0, pos) : buffer.slice(0, pos)\n}\n\nfunction generate4ByteBuffer (num) {\n  const buffer = Buffer.allocUnsafe(4)\n  buffer.writeUInt32BE(num, 0)\n  return buffer\n}\n\nmodule.exports = {\n  cache,\n  generateCache,\n  generateNumber: generateBuffer,\n  genBufVariableByteInt,\n  generate4ByteBuffer\n}\n"],"mappings":"AAAA,MAAMA,GAAG,GAAG,KAAZ;AACA,MAAMC,KAAK,GAAG,EAAd,C,CAEA;AACA;AACA;AACA;AACA;;AACA,MAAMC,KAAK,GAAGC,MAAM,CAACC,QAAP,CAAgBD,MAAM,CAACE,IAAP,CAAY,CAAC,CAAD,EAAI,CAAJ,CAAZ,EAAoBC,QAApB,CAA6B,CAA7B,EAAgC,CAAhC,CAAhB,CAAd;;AAEA,SAASC,cAAT,CAAyBC,CAAzB,EAA4B;EAC1B,MAAMC,MAAM,GAAGN,MAAM,CAACO,WAAP,CAAmB,CAAnB,CAAf;EACAD,MAAM,CAACE,UAAP,CAAkBH,CAAC,IAAI,CAAvB,EAA0B,CAA1B;EACAC,MAAM,CAACE,UAAP,CAAkBH,CAAC,GAAG,MAAtB,EAA8B,IAAI,CAAlC;EAEA,OAAOC,MAAP;AACD;;AAED,SAASG,aAAT,GAA0B;EACxB,KAAK,IAAIJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGR,GAApB,EAAyBQ,CAAC,EAA1B,EAA8B;IAC5BP,KAAK,CAACO,CAAD,CAAL,GAAWD,cAAc,CAACC,CAAD,CAAzB;EACD;AACF;;AAED,SAASK,qBAAT,CAAgCC,GAAhC,EAAqC;EACnC,MAAMC,SAAS,GAAG,CAAlB,CADmC,CACf;;EACpB,IAAIC,KAAK,GAAG,CAAZ;EACA,IAAIC,GAAG,GAAG,CAAV;EACA,MAAMR,MAAM,GAAGN,MAAM,CAACO,WAAP,CAAmBK,SAAnB,CAAf;;EAEA,GAAG;IACDC,KAAK,GAAGF,GAAG,GAAG,GAAN,GAAY,CAApB;IACAA,GAAG,GAAGA,GAAG,GAAG,GAAN,GAAY,CAAlB;IACA,IAAIA,GAAG,GAAG,CAAV,EAAaE,KAAK,GAAGA,KAAK,GAAG,IAAhB;IAEbP,MAAM,CAACE,UAAP,CAAkBK,KAAlB,EAAyBC,GAAG,EAA5B;EACD,CAND,QAMSH,GAAG,GAAG,CAAN,IAAWG,GAAG,GAAGF,SAN1B;;EAQA,IAAID,GAAG,GAAG,CAAV,EAAa;IACXG,GAAG,GAAG,CAAN;EACD;;EAED,OAAOf,KAAK,GAAGO,MAAM,CAACH,QAAP,CAAgB,CAAhB,EAAmBW,GAAnB,CAAH,GAA6BR,MAAM,CAACS,KAAP,CAAa,CAAb,EAAgBD,GAAhB,CAAzC;AACD;;AAED,SAASE,mBAAT,CAA8BL,GAA9B,EAAmC;EACjC,MAAML,MAAM,GAAGN,MAAM,CAACO,WAAP,CAAmB,CAAnB,CAAf;EACAD,MAAM,CAACW,aAAP,CAAqBN,GAArB,EAA0B,CAA1B;EACA,OAAOL,MAAP;AACD;;AAEDY,MAAM,CAACC,OAAP,GAAiB;EACfrB,KADe;EAEfW,aAFe;EAGfW,cAAc,EAAEhB,cAHD;EAIfM,qBAJe;EAKfM;AALe,CAAjB"},"metadata":{},"sourceType":"script"}